(function(){var p=window.jQuery,C="abcdefgh".split(""),ue=20,J="â€¦",ee="1.8.3",fe="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",V=N(fe),de=200,pe=200,le=60,ce=30,he=100,u={};u.alpha="alpha-d2270",u.black="black-3c85d",u.board="board-b72b1",u.chessboard="chessboard-63f37",u.clearfix="clearfix-7da63",u.highlight1="highlight1-32417",u.highlight2="highlight2-9c5d2",u.notation="notation-322f9",u.numeric="numeric-fc462",u.piece="piece-417db",u.row="row-5277c",u.sparePieces="spare-pieces-7492f",u.sparePiecesBottom="spare-pieces-bottom-ae20f",u.sparePiecesTop="spare-pieces-top-4028b",u.square="square-55d63",u.white="white-1e1d7";function re(r,a,o){var f=0,d=!1,h=[],g=function(){f=0,d&&(d=!1,c())},c=function(){f=window.setTimeout(g,a),r.apply(o,h)};return function(D){h=arguments,f?d=!0:c()}}function k(){return"xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/x/g,function(r){var a=Math.random()*16|0;return a.toString(16)})}function w(r){return JSON.parse(JSON.stringify(r))}function ae(r){var a=r.split(".");return{major:parseInt(a[0],10),minor:parseInt(a[1],10),patch:parseInt(a[2],10)}}function ve(r,a){r=ae(r),a=ae(a);var o=r.major*1e5*1e5+r.minor*1e5+r.patch,f=a.major*1e5*1e5+a.minor*1e5+a.patch;return o>=f}function $(r,a){for(var o in a)if(a.hasOwnProperty(o))for(var f="{"+o+"}",d=a[o];r.indexOf(f)!==-1;)r=r.replace(f,d);return r}function E(r){return typeof r=="string"}function q(r){return typeof r=="function"}function te(r){return typeof r=="number"&&isFinite(r)&&Math.floor(r)===r}function B(r){return r==="fast"||r==="slow"?!0:te(r)?r>=0:!1}function we(r){return te(r)&&r>=1}function me(r){if(!E(r))return!1;var a=r.split("-");return a.length!==2?!1:T(a[0])&&T(a[1])}function T(r){return E(r)&&r.search(/^[a-h][1-8]$/)!==-1}function Pe(r){return E(r)&&r.search(/^[bw][KQRNBP]$/)!==-1}function U(r){if(!E(r))return!1;r=r.replace(/ .+$/,""),r=Te(r);var a=r.split("/");if(a.length!==8)return!1;for(var o=0;o<8;o++)if(a[o].length!==8||a[o].search(/[^kqrnbpKQRNBP1]/)!==-1)return!1;return!0}function Q(r){if(!p.isPlainObject(r))return!1;for(var a in r)if(r.hasOwnProperty(a)&&(!T(a)||!Pe(r[a])))return!1;return!0}function be(){return"ontouchstart"in document.documentElement}function Se(){return typeof window.$&&p.fn&&p.fn.jquery&&ve(p.fn.jquery,ee)}function ge(r){return r.toLowerCase()===r?"b"+r.toUpperCase():"w"+r.toUpperCase()}function qe(r){var a=r.split("");return a[0]==="w"?a[1].toUpperCase():a[1].toLowerCase()}function N(r){if(!U(r))return!1;r=r.replace(/ .+$/,"");for(var a=r.split("/"),o={},f=8,d=0;d<8;d++){for(var h=a[d].split(""),g=0,c=0;c<h.length;c++)if(h[c].search(/[1-8]/)!==-1){var D=parseInt(h[c],10);g=g+D}else{var m=C[g]+f;o[m]=ge(h[c]),g=g+1}f=f-1}return o}function Y(r){if(!Q(r))return!1;for(var a="",o=8,f=0;f<8;f++){for(var d=0;d<8;d++){var h=C[d]+o;r.hasOwnProperty(h)?a=a+qe(r[h]):a=a+"1"}f!==7&&(a=a+"/"),o=o-1}return a=ye(a),a}function ye(r){return r.replace(/11111111/g,"8").replace(/1111111/g,"7").replace(/111111/g,"6").replace(/11111/g,"5").replace(/1111/g,"4").replace(/111/g,"3").replace(/11/g,"2")}function Te(r){return r.replace(/8/g,"11111111").replace(/7/g,"1111111").replace(/6/g,"111111").replace(/5/g,"11111").replace(/4/g,"1111").replace(/3/g,"111").replace(/2/g,"11")}function Ee(r,a){var o=r.split(""),f=C.indexOf(o[0])+1,d=parseInt(o[1],10),h=a.split(""),g=C.indexOf(h[0])+1,c=parseInt(h[1],10),D=Math.abs(f-g),m=Math.abs(d-c);return D>=m?D:m}function Oe(r,a,o){for(var f=xe(o),d=0;d<f.length;d++){var h=f[d];if(r.hasOwnProperty(h)&&r[h]===a)return h}return!1}function xe(r){for(var a=[],o=0;o<8;o++)for(var f=0;f<8;f++){var d=C[o]+(f+1);r!==d&&a.push({square:d,distance:Ee(r,d)})}a.sort(function(g,c){return g.distance-c.distance});var h=[];for(o=0;o<a.length;o++)h.push(a[o].square);return h}function Ce(r,a){var o=w(r);for(var f in a)if(a.hasOwnProperty(f)&&o.hasOwnProperty(f)){var d=o[f];delete o[f],o[a[f]]=d}return o}function De(r){var a='<div class="{chessboard}">';return r&&(a+='<div class="{sparePieces} {sparePiecesTop}"></div>'),a+='<div class="{board}"></div>',r&&(a+='<div class="{sparePieces} {sparePiecesBottom}"></div>'),a+="</div>",$(a,u)}function Ae(r){return r==="start"?r={position:w(V)}:U(r)?r={position:N(r)}:Q(r)&&(r={position:w(r)}),p.isPlainObject(r)||(r={}),r}function Ie(r){return r.orientation!=="black"&&(r.orientation="white"),r.showNotation!==!1&&(r.showNotation=!0),r.draggable!==!0&&(r.draggable=!1),r.dropOffBoard!=="trash"&&(r.dropOffBoard="snapback"),r.sparePieces!==!0&&(r.sparePieces=!1),r.sparePieces&&(r.draggable=!0),(!r.hasOwnProperty("pieceTheme")||!E(r.pieceTheme)&&!q(r.pieceTheme))&&(r.pieceTheme="img/chesspieces/wikipedia/{piece}.png"),B(r.appearSpeed)||(r.appearSpeed=de),B(r.moveSpeed)||(r.moveSpeed=pe),B(r.snapbackSpeed)||(r.snapbackSpeed=le),B(r.snapSpeed)||(r.snapSpeed=ce),B(r.trashSpeed)||(r.trashSpeed=he),we(r.dragThrottleRate)||(r.dragThrottleRate=ue),r}function Me(){if(!Se()){var r="Chessboard Error 1005: Unable to find a valid version of jQuery. Please include jQuery "+ee+` or higher on the page

Exiting`+J;return window.alert(r),!1}return!0}function ke(r){if(r===""){var a=`Chessboard Error 1001: The first argument to Chessboard() cannot be an empty string.

Exiting`+J;return window.alert(a),!1}E(r)&&r.charAt(0)!=="#"&&(r="#"+r);var o=p(r);if(o.length!==1){var f=`Chessboard Error 1003: The first argument to Chessboard() must be the ID of a DOM node, an ID query selector, or a single DOM node.

Exiting`+J;return window.alert(f),!1}return o}function Re(r,a){if(!Me())return null;var o=ke(r);if(!o)return null;a=Ae(a),a=Ie(a);var f=null,d=null,h=null,g=null,c={},D=2,m="white",l={},A=null,M=null,y=null,O=!1,W={},b={},L={},S=16;function F(e,t,n){if(!(a.hasOwnProperty("showErrors")!==!0||a.showErrors===!1)){var s="Chessboard Error "+e+": "+t;if(a.showErrors==="console"&&typeof console=="object"&&typeof console.log=="function"){console.log(s),arguments.length>=2&&console.log(n);return}if(a.showErrors==="alert"){n&&(s+=`

`+JSON.stringify(n)),window.alert(s);return}q(a.showErrors)&&a.showErrors(e,t,n)}}function Be(){m=a.orientation,a.hasOwnProperty("position")&&(a.position==="start"?l=w(V):U(a.position)?l=N(a.position):Q(a.position)?l=w(a.position):F(7263,"Invalid value passed to config.position.",a.position))}function Ne(){var e=parseInt(o.width(),10);if(!e||e<=0)return 0;for(var t=e-1;t%8!==0&&t>0;)t=t-1;return t/8}function Le(){for(var e=0;e<C.length;e++)for(var t=1;t<=8;t++){var n=C[e]+t;b[n]=n+"-"+k()}var s="KQRNBP".split("");for(e=0;e<s.length;e++){var i="w"+s[e],P="b"+s[e];W[i]=i+"-"+k(),W[P]=P+"-"+k()}}function Fe(e){e!=="black"&&(e="white");var t="",n=w(C),s=8;e==="black"&&(n.reverse(),s=1);for(var i="white",P=0;P<8;P++){t+='<div class="{row}">';for(var v=0;v<8;v++){var x=n[v]+s;t+='<div class="{square} '+u[i]+" square-"+x+'" style="width:'+S+"px;height:"+S+'px;" id="'+b[x]+'" data-square="'+x+'">',a.showNotation&&((e==="white"&&s===1||e==="black"&&s===8)&&(t+='<div class="{notation} {alpha}">'+n[v]+"</div>"),v===0&&(t+='<div class="{notation} {numeric}">'+s+"</div>")),t+="</div>",i=i==="white"?"black":"white"}t+='<div class="{clearfix}"></div></div>',i=i==="white"?"black":"white",e==="white"?s=s-1:s=s+1}return $(t,u)}function ne(e){return q(a.pieceTheme)?a.pieceTheme(e):E(a.pieceTheme)?$(a.pieceTheme,{piece:e}):(F(8272,"Unable to build image source for config.pieceTheme."),"")}function I(e,t,n){var s='<img src="'+ne(e)+'" ';return E(n)&&n!==""&&(s+='id="'+n+'" '),s+='alt="" class="{piece}" data-piece="'+e+'" style="width:'+S+"px;height:"+S+"px;",t&&(s+="display:none;"),s+='" />',$(s,u)}function X(e){var t=["wK","wQ","wR","wB","wN","wP"];e==="black"&&(t=["bK","bQ","bR","bB","bN","bP"]);for(var n="",s=0;s<t.length;s++)n+=I(t[s],!1,W[t[s]]);return n}function _e(e,t,n,s){var i=p("#"+b[e]),P=i.offset(),v=p("#"+b[t]),x=v.offset(),z=k();p("body").append(I(n,!0,z));var _=p("#"+z);_.css({display:"",position:"absolute",top:P.top,left:P.left}),i.find("."+u.piece).remove();function or(){v.append(I(n)),_.remove(),q(s)&&s()}var ur={duration:a.moveSpeed,complete:or};_.animate(x,ur)}function $e(e,t,n){var s=p("#"+W[e]).offset(),i=p("#"+b[t]),P=i.offset(),v=k();p("body").append(I(e,!0,v));var x=p("#"+v);x.css({display:"",position:"absolute",left:s.left,top:s.top});function z(){i.find("."+u.piece).remove(),i.append(I(e)),x.remove(),q(n)&&n()}var _={duration:a.moveSpeed,complete:z};x.animate(P,_)}function Ue(e,t,n){if(e.length===0)return;var s=0;function i(){s=s+1,s===e.length&&(R(),q(a.onMoveEnd)&&a.onMoveEnd(w(t),w(n)))}for(var P=0;P<e.length;P++){var v=e[P];v.type==="clear"?p("#"+b[v.square]+" ."+u.piece).fadeOut(a.trashSpeed,i):v.type==="add"&&!a.sparePieces?p("#"+b[v.square]).append(I(v.piece,!0)).find("."+u.piece).fadeIn(a.appearSpeed,i):v.type==="add"&&a.sparePieces?$e(v.piece,v.square,i):v.type==="move"&&_e(v.source,v.destination,v.piece,i)}}function Qe(e,t){e=w(e),t=w(t);var n=[],s={};for(var i in t)t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&e[i]===t[i]&&(delete e[i],delete t[i]);for(i in t)if(t.hasOwnProperty(i)){var P=Oe(e,t[i],i);P&&(n.push({type:"move",source:P,destination:i,piece:t[i]}),delete e[P],delete t[i],s[i]=!0)}for(i in t)t.hasOwnProperty(i)&&(n.push({type:"add",square:i,piece:t[i]}),delete t[i]);for(i in e)e.hasOwnProperty(i)&&(s.hasOwnProperty(i)||(n.push({type:"clear",square:i,piece:e[i]}),delete e[i]));return n}function R(){f.find("."+u.piece).remove();for(var e in l)l.hasOwnProperty(e)&&p("#"+b[e]).append(I(l[e]))}function G(){f.html(Fe(m,S,a.showNotation)),R(),a.sparePieces&&(m==="white"?(h.html(X("black")),g.html(X("white"))):(h.html(X("white")),g.html(X("black"))))}function H(e){var t=w(l),n=w(e),s=Y(t),i=Y(n);s!==i&&(q(a.onChange)&&a.onChange(t,n),l=e)}function Z(e,t){for(var n in L)if(L.hasOwnProperty(n)){var s=L[n];if(e>=s.left&&e<s.left+S&&t>=s.top&&t<s.top+S)return n}return"offboard"}function Ye(){L={};for(var e in b)b.hasOwnProperty(e)&&(L[e]=p("#"+b[e]).offset())}function j(){f.find("."+u.square).removeClass(u.highlight1+" "+u.highlight2)}function We(){if(y==="spare"){se();return}j();function e(){R(),d.css("display","none"),q(a.onSnapbackEnd)&&a.onSnapbackEnd(A,y,w(l),m)}var t=p("#"+b[y]).offset(),n={duration:a.snapbackSpeed,complete:e};d.animate(t,n),O=!1}function se(){j();var e=w(l);delete e[y],H(e),R(),d.fadeOut(a.trashSpeed),O=!1}function Xe(e){j();var t=w(l);delete t[y],t[e]=A,H(t);var n=p("#"+b[e]).offset();function s(){R(),d.css("display","none"),q(a.onSnapEnd)&&a.onSnapEnd(y,e,A)}var i={duration:a.snapSpeed,complete:s};d.animate(n,i),O=!1}function K(e,t,n,s){q(a.onDragStart)&&a.onDragStart(e,t,w(l),m)===!1||(O=!0,A=t,y=e,e==="spare"?M="offboard":M=e,Ye(),d.attr("src",ne(t)).css({display:"",position:"absolute",left:n-S/2,top:s-S/2}),e!=="spare"&&p("#"+b[e]).addClass(u.highlight1).find("."+u.piece).css("display","none"))}function ie(e,t){d.css({left:e-S/2,top:t-S/2});var n=Z(e,t);n!==M&&(T(M)&&p("#"+b[M]).removeClass(u.highlight2),T(n)&&p("#"+b[n]).addClass(u.highlight2),q(a.onDragMove)&&a.onDragMove(n,M,y,A,w(l),m),M=n)}function oe(e){var t="drop";if(e==="offboard"&&a.dropOffBoard==="snapback"&&(t="snapback"),e==="offboard"&&a.dropOffBoard==="trash"&&(t="trash"),q(a.onDrop)){var n=w(l);y==="spare"&&T(e)&&(n[e]=A),T(y)&&e==="offboard"&&delete n[y],T(y)&&T(e)&&(delete n[y],n[e]=A);var s=w(l),i=a.onDrop(y,e,A,n,s,m);(i==="snapback"||i==="trash")&&(t=i)}t==="snapback"?We():t==="trash"?se():t==="drop"&&Xe(e)}c.clear=function(e){c.position({},e)},c.destroy=function(){o.html(""),d.remove(),o.unbind()},c.fen=function(){return c.position("fen")},c.flip=function(){return c.orientation("flip")},c.move=function(){if(arguments.length!==0){for(var e=!0,t={},n=0;n<arguments.length;n++){if(arguments[n]===!1){e=!1;continue}if(!me(arguments[n])){F(2826,"Invalid move passed to the move method.",arguments[n]);continue}var s=arguments[n].split("-");t[s[0]]=s[1]}var i=Ce(l,t);return c.position(i,e),i}},c.orientation=function(e){if(arguments.length===0)return m;if(e==="white"||e==="black")return m=e,G(),m;if(e==="flip")return m=m==="white"?"black":"white",G(),m;F(5482,"Invalid value passed to the orientation method.",e)},c.position=function(e,t){if(arguments.length===0)return w(l);if(E(e)&&e.toLowerCase()==="fen")return Y(l);if(E(e)&&e.toLowerCase()==="start"&&(e=w(V)),U(e)&&(e=N(e)),!Q(e)){F(6482,"Invalid value passed to the position method.",e);return}if(t!==!1&&(t=!0),t){var n=Qe(l,e);Ue(n,l,e),H(e)}else H(e),R()},c.resize=function(){S=Ne(),f.css("width",S*8+"px"),d.css({height:S,width:S}),a.sparePieces&&o.find("."+u.sparePieces).css("paddingLeft",S+D+"px"),G()},c.start=function(e){c.position("start",e)};function He(e){e.preventDefault()}function Ke(e){if(a.draggable){var t=p(this).attr("data-square");T(t)&&l.hasOwnProperty(t)&&K(t,l[t],e.pageX,e.pageY)}}function ze(e){if(a.draggable){var t=p(this).attr("data-square");T(t)&&l.hasOwnProperty(t)&&(e=e.originalEvent,K(t,l[t],e.changedTouches[0].pageX,e.changedTouches[0].pageY))}}function Je(e){if(a.sparePieces){var t=p(this).attr("data-piece");K("spare",t,e.pageX,e.pageY)}}function Ve(e){if(a.sparePieces){var t=p(this).attr("data-piece");e=e.originalEvent,K("spare",t,e.changedTouches[0].pageX,e.changedTouches[0].pageY)}}function Ge(e){O&&ie(e.pageX,e.pageY)}var Ze=re(Ge,a.dragThrottleRate);function je(e){O&&(e.preventDefault(),ie(e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY))}var er=re(je,a.dragThrottleRate);function rr(e){if(O){var t=Z(e.pageX,e.pageY);oe(t)}}function ar(e){if(O){var t=Z(e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY);oe(t)}}function tr(e){if(!O&&q(a.onMouseoverSquare)){var t=p(e.currentTarget).attr("data-square");if(T(t)){var n=!1;l.hasOwnProperty(t)&&(n=l[t]),a.onMouseoverSquare(t,n,w(l),m)}}}function nr(e){if(!O&&q(a.onMouseoutSquare)){var t=p(e.currentTarget).attr("data-square");if(T(t)){var n=!1;l.hasOwnProperty(t)&&(n=l[t]),a.onMouseoutSquare(t,n,w(l),m)}}}function sr(){p("body").on("mousedown mousemove","."+u.piece,He),f.on("mousedown","."+u.square,Ke),o.on("mousedown","."+u.sparePieces+" ."+u.piece,Je),f.on("mouseenter","."+u.square,tr).on("mouseleave","."+u.square,nr);var e=p(window);e.on("mousemove",Ze).on("mouseup",rr),be()&&(f.on("touchstart","."+u.square,ze),o.on("touchstart","."+u.sparePieces+" ."+u.piece,Ve),e.on("touchmove",er).on("touchend",ar))}function ir(){Le(),o.html(De(a.sparePieces)),f=o.find("."+u.board),a.sparePieces&&(h=o.find("."+u.sparePiecesTop),g=o.find("."+u.sparePiecesBottom));var e=k();p("body").append(I("wP",!0,e)),d=p("#"+e),D=parseInt(f.css("borderLeftWidth"),10),c.resize()}return Be(),ir(),sr(),c}window.Chessboard=Re,window.ChessBoard=window.Chessboard,window.Chessboard.fenToObj=N,window.Chessboard.objToFen=Y})();
