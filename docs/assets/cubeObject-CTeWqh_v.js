var oi=Object.defineProperty;var ai=(r,t,e)=>t in r?oi(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var pr=(r,t,e)=>ai(r,typeof t!="symbol"?t+"":t,e);import{u as qe,aj as Kr,w as kt,V as or,c as si,r as re,X as ve,Q as ft}from"./three.module-x1Cfo4R0.js";import{M as Ft,D as de,N as te,I as ui,J as fi,K as ci,a as li,b as hi,c as pi,d as vi,e as di,f as mi}from"./cube-algebra-Cwll5vw1.js";import{c as gi,g as ee}from"./_commonjsHelpers-DM6icglO.js";import{a as Dt}from"./delay-DTFr9Qec.js";function Gt(){return Gt=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Gt.apply(this,arguments)}var Re={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function fr(r){return typeof r=="number"}function zr(r){return!r||typeof r!="object"||typeof r.constructor!="function"?!1:r.isBigNumber===!0&&typeof r.constructor.prototype=="object"&&r.constructor.prototype.isBigNumber===!0||typeof r.constructor.isDecimal=="function"&&r.constructor.isDecimal(r)===!0}function ne(r){return r&&typeof r=="object"&&Object.getPrototypeOf(r).isComplex===!0||!1}function ie(r){return r&&typeof r=="object"&&Object.getPrototypeOf(r).isFraction===!0||!1}function oe(r){return r&&r.constructor.prototype.isUnit===!0||!1}function $r(r){return typeof r=="string"}var ar=Array.isArray;function Sr(r){return r&&r.constructor.prototype.isMatrix===!0||!1}function Le(r){return Array.isArray(r)||Sr(r)}function wi(r){return r&&r.isDenseMatrix&&r.constructor.prototype.isMatrix===!0||!1}function yi(r){return r&&r.isSparseMatrix&&r.constructor.prototype.isMatrix===!0||!1}function Ue(r){return r&&r.constructor.prototype.isRange===!0||!1}function St(r){return r&&r.constructor.prototype.isIndex===!0||!1}function _i(r){return typeof r=="boolean"}function $e(r){return r&&r.constructor.prototype.isResultSet===!0||!1}function Ze(r){return r&&r.constructor.prototype.isHelp===!0||!1}function Ni(r){return typeof r=="function"}function Mi(r){return r instanceof Date}function Ei(r){return r instanceof RegExp}function bi(r){return!!(r&&typeof r=="object"&&r.constructor===Object&&!ne(r)&&!ie(r))}function Si(r){return r===null}function Ai(r){return r===void 0}function Ii(r){return r&&r.isAccessorNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ci(r){return r&&r.isArrayNode===!0&&r.constructor.prototype.isNode===!0||!1}function xi(r){return r&&r.isAssignmentNode===!0&&r.constructor.prototype.isNode===!0||!1}function Oi(r){return r&&r.isBlockNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ti(r){return r&&r.isConditionalNode===!0&&r.constructor.prototype.isNode===!0||!1}function Pi(r){return r&&r.isConstantNode===!0&&r.constructor.prototype.isNode===!0||!1}function zi(r){return r&&r.isFunctionAssignmentNode===!0&&r.constructor.prototype.isNode===!0||!1}function Fi(r){return r&&r.isFunctionNode===!0&&r.constructor.prototype.isNode===!0||!1}function Di(r){return r&&r.isIndexNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ve(r){return r&&r.isNode===!0&&r.constructor.prototype.isNode===!0||!1}function Bi(r){return r&&r.isObjectNode===!0&&r.constructor.prototype.isNode===!0||!1}function qi(r){return r&&r.isOperatorNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ri(r){return r&&r.isParenthesisNode===!0&&r.constructor.prototype.isNode===!0||!1}function Li(r){return r&&r.isRangeNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ui(r){return r&&r.isSymbolNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ge(r){return r&&r.constructor.prototype.isChain===!0||!1}function lt(r){var t=typeof r;return t==="object"?r===null?"null":Array.isArray(r)?"Array":r instanceof Date?"Date":r instanceof RegExp?"RegExp":zr(r)?"BigNumber":ne(r)?"Complex":ie(r)?"Fraction":Sr(r)?"Matrix":oe(r)?"Unit":St(r)?"Index":Ue(r)?"Range":$e(r)?"ResultSet":Ve(r)?r.type:Ge(r)?"Chain":Ze(r)?"Help":"Object":t==="function"?"Function":t}function yr(r){var t=typeof r;if(t==="number"||t==="string"||t==="boolean"||r===null||r===void 0)return r;if(typeof r.clone=="function")return r.clone();if(Array.isArray(r))return r.map(function(e){return yr(e)});if(r instanceof Date)return new Date(r.valueOf());if(zr(r))return r;if(r instanceof RegExp)throw new TypeError("Cannot clone "+r);return $i(r,yr)}function $i(r,t){var e={};for(var i in r)ht(r,i)&&(e[i]=t(r[i]));return e}function Zi(r,t){for(var e in t)ht(t,e)&&(r[e]=t[e]);return r}function gt(r,t){var e,i,n;if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(i=0,n=r.length;i<n;i++)if(!gt(r[i],t[i]))return!1;return!0}else{if(typeof r=="function")return r===t;if(r instanceof Object){if(Array.isArray(t)||!(t instanceof Object))return!1;for(e in r)if(!(e in t)||!gt(r[e],t[e]))return!1;for(e in t)if(!(e in r))return!1;return!0}else return r===t}}function ht(r,t){return r&&Object.hasOwnProperty.call(r,t)}function Vi(r,t){for(var e={},i=0;i<t.length;i++){var n=t[i],o=r[n];o!==void 0&&(e[n]=o)}return e}var Gi=["Matrix","Array"],Hi=["number","BigNumber","Fraction"],At=function(t){if(t)throw new Error(`The global config is readonly. 
Please create a mathjs instance if you want to change the default configuration. 
Example:

  import { create, all } from 'mathjs';
  const mathjs = create(all);
  mathjs.config({ number: 'BigNumber' });
`);return Object.freeze(Re)};Gt(At,Re,{MATRIX_OPTIONS:Gi,NUMBER_OPTIONS:Hi});var He={exports:{}};(function(r,t){(function(e,i){r.exports=i()})(gi,function(){function e(){return!0}function i(){return!1}function n(){}function o(){var c=[{name:"number",test:function(_){return typeof _=="number"}},{name:"string",test:function(_){return typeof _=="string"}},{name:"boolean",test:function(_){return typeof _=="boolean"}},{name:"Function",test:function(_){return typeof _=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(_){return _ instanceof Date}},{name:"RegExp",test:function(_){return _ instanceof RegExp}},{name:"Object",test:function(_){return typeof _=="object"&&_!==null&&_.constructor===Object}},{name:"null",test:function(_){return _===null}},{name:"undefined",test:function(_){return _===void 0}}],h={name:"any",test:e},d=[],g=[],s={types:c,conversions:g,ignore:d};function a(_){var C=Ir(s.types,function(I){return I.name===_});if(C)return C;if(_==="any")return h;var O=Ir(s.types,function(I){return I.name.toLowerCase()===_.toLowerCase()});throw new TypeError('Unknown type "'+_+'"'+(O?'. Did you mean "'+O.name+'"?':""))}function f(_){return _===h?999:s.types.indexOf(_)}function l(_){var C=Ir(s.types,function(O){return O.test(_)});if(C)return C.name;throw new TypeError("Value has unknown type. Value: "+_)}function v(_,C){if(!_.signatures)throw new TypeError("Function is no typed-function");var O;if(typeof C=="string"){O=C.split(",");for(var I=0;I<O.length;I++)O[I]=O[I].trim()}else if(Array.isArray(C))O=C;else throw new TypeError("String array or a comma separated string expected");var q=O.join(","),H=_.signatures[q];if(H)return H;throw new TypeError("Signature not found (signature: "+(_.name||"unnamed")+"("+O.join(", ")+"))")}function u(_,C){var O=l(_);if(C===O)return _;for(var I=0;I<s.conversions.length;I++){var q=s.conversions[I];if(q.from===O&&q.to===C)return q.convert(_)}throw new Error("Cannot convert from "+O+" to "+C)}function p(_){return _.map(function(C){var O=C.types.map(b);return(C.restParam?"...":"")+O.join("|")}).join(",")}function m(_,C){var O=_.indexOf("...")===0,I=O?_.length>3?_.slice(3):"any":_,q=I.split("|").map(hr).filter(ir).filter(lr),H=G(C,q),j=q.map(function(R){var Q=a(R);return{name:R,typeIndex:f(Q),test:Q.test,conversion:null,conversionIndex:-1}}),U=H.map(function(R){var Q=a(R.from);return{name:R.from,typeIndex:f(Q),test:Q.test,conversion:R,conversionIndex:C.indexOf(R)}});return{types:j.concat(U),restParam:O}}function N(_,C,O){var I=[];return _.trim()!==""&&(I=_.split(",").map(hr).map(function(q,H,j){var U=m(q,O);if(U.restParam&&H!==j.length-1)throw new SyntaxError('Unexpected rest parameter "'+q+'": only allowed for the last parameter');return U})),I.some(ur)?null:{params:I,fn:C}}function w(_){var C=Ar(_);return C?C.restParam:!1}function S(_){return _.types.some(function(C){return C.conversion!=null})}function M(_){if(!_||_.types.length===0)return e;if(_.types.length===1)return a(_.types[0].name).test;if(_.types.length===2){var C=a(_.types[0].name).test,O=a(_.types[1].name).test;return function(H){return C(H)||O(H)}}else{var I=_.types.map(function(q){return a(q.name).test});return function(H){for(var j=0;j<I.length;j++)if(I[j](H))return!0;return!1}}}function E(_){var C,O,I;if(w(_)){C=er(_).map(M);var q=C.length,H=M(Ar(_)),j=function(U){for(var R=q;R<U.length;R++)if(!H(U[R]))return!1;return!0};return function(R){for(var Q=0;Q<C.length;Q++)if(!C[Q](R[Q]))return!1;return j(R)&&R.length>=q+1}}else return _.length===0?function(R){return R.length===0}:_.length===1?(O=M(_[0]),function(R){return O(R[0])&&R.length===1}):_.length===2?(O=M(_[0]),I=M(_[1]),function(R){return O(R[0])&&I(R[1])&&R.length===2}):(C=_.map(M),function(R){for(var Q=0;Q<C.length;Q++)if(!C[Q](R[Q]))return!1;return R.length===C.length})}function A(_,C){return C<_.params.length?_.params[C]:w(_.params)?Ar(_.params):null}function y(_,C,O){var I=A(_,C),q=I?O?I.types.filter(x):I.types:[];return q.map(b)}function b(_){return _.name}function x(_){return _.conversion===null||_.conversion===void 0}function T(_,C){var O=Gr(Br(_,function(I){return y(I,C,!1)}));return O.indexOf("any")!==-1?["any"]:O}function F(_,C,O){var I,q,H=_||"unnamed",j=O,U;for(U=0;U<C.length;U++){var R=j.filter(function(qr){var Pt=M(A(qr,U));return(U<qr.params.length||w(qr.params))&&Pt(C[U])});if(R.length===0){if(q=T(j,U),q.length>0){var Q=l(C[U]);return I=new TypeError("Unexpected type of argument in function "+H+" (expected: "+q.join(" or ")+", actual: "+Q+", index: "+U+")"),I.data={category:"wrongType",fn:H,index:U,actual:Q,expected:q},I}}else j=R}var Tr=j.map(function(qr){return w(qr.params)?1/0:qr.params.length});if(C.length<Math.min.apply(null,Tr))return q=T(j,U),I=new TypeError("Too few arguments in function "+H+" (expected: "+q.join(" or ")+", index: "+C.length+")"),I.data={category:"tooFewArgs",fn:H,index:C.length,expected:q},I;var Pr=Math.max.apply(null,Tr);return C.length>Pr?(I=new TypeError("Too many arguments in function "+H+" (expected: "+Pr+", actual: "+C.length+")"),I.data={category:"tooManyArgs",fn:H,index:C.length,expectedLength:Pr},I):(I=new TypeError('Arguments of type "'+C.join(", ")+'" do not match any of the defined signatures of function '+H+"."),I.data={category:"mismatch",actual:C.map(l)},I)}function D(_){for(var C=999,O=0;O<_.types.length;O++)x(_.types[O])&&(C=Math.min(C,_.types[O].typeIndex));return C}function L(_){for(var C=999,O=0;O<_.types.length;O++)x(_.types[O])||(C=Math.min(C,_.types[O].conversionIndex));return C}function B(_,C){var O;return O=_.restParam-C.restParam,O!==0||(O=S(_)-S(C),O!==0)||(O=D(_)-D(C),O!==0)?O:L(_)-L(C)}function z(_,C){var O=Math.min(_.params.length,C.params.length),I,q;if(q=_.params.some(S)-C.params.some(S),q!==0)return q;for(I=0;I<O;I++)if(q=S(_.params[I])-S(C.params[I]),q!==0)return q;for(I=0;I<O;I++)if(q=B(_.params[I],C.params[I]),q!==0)return q;return _.params.length-C.params.length}function G(_,C){var O={};return _.forEach(function(I){C.indexOf(I.from)===-1&&C.indexOf(I.to)!==-1&&!O[I.from]&&(O[I.from]=I)}),Object.keys(O).map(function(I){return O[I]})}function Z(_,C){var O=C;if(_.some(S)){var I=w(_),q=_.map(V);O=function(){for(var R=[],Q=I?arguments.length-1:arguments.length,Tr=0;Tr<Q;Tr++)R[Tr]=q[Tr](arguments[Tr]);return I&&(R[Q]=arguments[Q].map(q[Q])),C.apply(this,R)}}var H=O;if(w(_)){var j=_.length-1;H=function(){return O.apply(this,mr(arguments,0,j).concat([mr(arguments,j)]))}}return H}function V(_){var C,O,I,q,H=[],j=[];switch(_.types.forEach(function(U){U.conversion&&(H.push(a(U.conversion.from).test),j.push(U.conversion.convert))}),j.length){case 0:return function(R){return R};case 1:return C=H[0],I=j[0],function(R){return C(R)?I(R):R};case 2:return C=H[0],O=H[1],I=j[0],q=j[1],function(R){return C(R)?I(R):O(R)?q(R):R};default:return function(R){for(var Q=0;Q<j.length;Q++)if(H[Q](R))return j[Q](R);return R}}}function Y(_){var C={};return _.forEach(function(O){O.params.some(S)||k(O.params,!0).forEach(function(I){C[p(I)]=O.fn})}),C}function k(_,C){function O(I,q,H){if(q<I.length){var j=I[q],U=C?j.types.filter(x):j.types,R;if(j.restParam){var Q=U.filter(x);R=Q.length<U.length?[Q,U]:[U]}else R=U.map(function(Pr){return[Pr]});return Br(R,function(Pr){return O(I,q+1,H.concat([Pr]))})}else{var Tr=H.map(function(Pr,qr){return{types:Pr,restParam:qr===I.length-1&&w(I)}});return[Tr]}}return O(_,0,[])}function X(_,C){for(var O=Math.max(_.params.length,C.params.length),I=0;I<O;I++){var q=y(_,I,!0),H=y(C,I,!0);if(!wr(q,H))return!1}var j=_.params.length,U=C.params.length,R=w(_.params),Q=w(C.params);return R?Q?j===U:U>=j:Q?j>=U:j===U}function K(_,C){if(Object.keys(C).length===0)throw new SyntaxError("No signatures provided");var O=[];Object.keys(C).map(function(nr){return N(nr,C[nr],s.conversions)}).filter(br).forEach(function(nr){var Mr=Ir(O,function(Rr){return X(Rr,nr)});if(Mr)throw new TypeError('Conflicting signatures "'+p(Mr.params)+'" and "'+p(nr.params)+'".');O.push(nr)});var I=Br(O,function(nr){var Mr=nr?k(nr.params,!1):[];return Mr.map(function(Rr){return{params:Rr,fn:nr.fn}})}).filter(br);I.sort(z);var q=I[0]&&I[0].params.length<=2&&!w(I[0].params),H=I[1]&&I[1].params.length<=2&&!w(I[1].params),j=I[2]&&I[2].params.length<=2&&!w(I[2].params),U=I[3]&&I[3].params.length<=2&&!w(I[3].params),R=I[4]&&I[4].params.length<=2&&!w(I[4].params),Q=I[5]&&I[5].params.length<=2&&!w(I[5].params),Tr=q&&H&&j&&U&&R&&Q,Pr=I.map(function(nr){return E(nr.params)}),qr=q?M(I[0].params[0]):i,Pt=H?M(I[1].params[0]):i,Fn=j?M(I[2].params[0]):i,Dn=U?M(I[3].params[0]):i,Bn=R?M(I[4].params[0]):i,qn=Q?M(I[5].params[0]):i,Rn=q?M(I[0].params[1]):i,Ln=H?M(I[1].params[1]):i,Un=j?M(I[2].params[1]):i,$n=U?M(I[3].params[1]):i,Zn=R?M(I[4].params[1]):i,Vn=Q?M(I[5].params[1]):i,Qr=I.map(function(nr){return Z(nr.params,nr.fn)}),Gn=q?Qr[0]:n,Hn=H?Qr[1]:n,Wn=j?Qr[2]:n,jn=U?Qr[3]:n,Jn=R?Qr[4]:n,Yn=Q?Qr[5]:n,Xn=q?I[0].params.length:-1,Qn=H?I[1].params.length:-1,Kn=j?I[2].params.length:-1,kn=U?I[3].params.length:-1,ri=R?I[4].params.length:-1,ti=Q?I[5].params.length:-1,ei=Tr?6:0,ni=I.length,ii=function(){for(var Mr=ei;Mr<ni;Mr++)if(Pr[Mr](arguments))return Qr[Mr].apply(this,arguments);return s.onMismatch(_,arguments,I)},zt=function nr(Mr,Rr){return arguments.length===Xn&&qr(Mr)&&Rn(Rr)?Gn.apply(nr,arguments):arguments.length===Qn&&Pt(Mr)&&Ln(Rr)?Hn.apply(nr,arguments):arguments.length===Kn&&Fn(Mr)&&Un(Rr)?Wn.apply(nr,arguments):arguments.length===kn&&Dn(Mr)&&$n(Rr)?jn.apply(nr,arguments):arguments.length===ri&&Bn(Mr)&&Zn(Rr)?Jn.apply(nr,arguments):arguments.length===ti&&qn(Mr)&&Vn(Rr)?Yn.apply(nr,arguments):ii.apply(nr,arguments)};try{Object.defineProperty(zt,"name",{value:_})}catch{}return zt.signatures=Y(I),zt}function cr(_,C,O){throw F(_,C,O)}function lr(_){return s.ignore.indexOf(_)===-1}function hr(_){return _.trim()}function ir(_){return!!_}function br(_){return _!==null}function ur(_){return _.types.length===0}function er(_){return _.slice(0,_.length-1)}function Ar(_){return _[_.length-1]}function mr(_,C,O){return Array.prototype.slice.call(_,C,O)}function rr(_,C){return _.indexOf(C)!==-1}function wr(_,C){for(var O=0;O<_.length;O++)if(rr(C,_[O]))return!0;return!1}function Ir(_,C){for(var O=0;O<_.length;O++)if(C(_[O]))return _[O]}function Gr(_){for(var C={},O=0;O<_.length;O++)C[_[O]]=!0;return Object.keys(C)}function Br(_,C){return Array.prototype.concat.apply([],_.map(C))}function rt(_){for(var C="",O=0;O<_.length;O++){var I=_[O];if((typeof I.signatures=="object"||typeof I.signature=="string")&&I.name!==""){if(C==="")C=I.name;else if(C!==I.name){var q=new Error("Function names do not match (expected: "+C+", actual: "+I.name+")");throw q.data={actual:I.name,expected:C},q}}}return C}function Xr(_){var C,O={};function I(U,R){if(O.hasOwnProperty(U)&&R!==O[U])throw C=new Error('Signature "'+U+'" is defined twice'),C.data={signature:U},C}for(var q=0;q<_.length;q++){var H=_[q];if(typeof H.signatures=="object")for(var j in H.signatures)H.signatures.hasOwnProperty(j)&&(I(j,H.signatures[j]),O[j]=H.signatures[j]);else if(typeof H.signature=="string")I(H.signature,H),O[H.signature]=H;else throw C=new TypeError("Function is no typed-function (index: "+q+")"),C.data={index:q},C}return O}return s=K("typed",{"string, Object":K,Object:function(_){var C=[];for(var O in _)_.hasOwnProperty(O)&&C.push(_[O]);var I=rt(C);return K(I,_)},"...Function":function(_){return K(rt(_),Xr(_))},"string, ...Function":function(_,C){return K(_,Xr(C))}}),s.create=o,s.types=c,s.conversions=g,s.ignore=d,s.onMismatch=cr,s.throwMismatchError=cr,s.createError=F,s.convert=u,s.find=v,s.addType=function(_,C){if(!_||typeof _.name!="string"||typeof _.test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");if(C!==!1){for(var O=0;O<s.types.length;O++)if(s.types[O].name==="Object"){s.types.splice(O,0,_);return}}s.types.push(_)},s.addConversion=function(_){if(!_||typeof _.from!="string"||typeof _.to!="string"||typeof _.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");s.conversions.push(_)},s}return o()})})(He);var Wi=He.exports;const me=ee(Wi);function _r(r){return typeof r=="boolean"?!0:isFinite(r)?r===Math.round(r):!1}function Bt(r,t,e){var i={2:"0b",8:"0o",16:"0x"},n=i[t],o="";if(e){if(e<1)throw new Error("size must be in greater than 0");if(!_r(e))throw new Error("size must be an integer");if(r>2**(e-1)-1||r<-(2**(e-1)))throw new Error("Value must be in range [-2^".concat(e-1,", 2^").concat(e-1,"-1]"));if(!_r(r))throw new Error("Value must be an integer");r<0&&(r=r+2**e),o="i".concat(e)}var c="";return r<0&&(r=-r,c="-"),"".concat(c).concat(n).concat(r.toString(t)).concat(o)}function Ht(r,t){if(typeof t=="function")return t(r);if(r===1/0)return"Infinity";if(r===-1/0)return"-Infinity";if(isNaN(r))return"NaN";var e="auto",i,n;if(t&&(t.notation&&(e=t.notation),fr(t)?i=t:fr(t.precision)&&(i=t.precision),t.wordSize&&(n=t.wordSize,typeof n!="number")))throw new Error('Option "wordSize" must be a number');switch(e){case"fixed":return Ji(r,i);case"exponential":return We(r,i);case"engineering":return ji(r,i);case"bin":return Bt(r,2,n);case"oct":return Bt(r,8,n);case"hex":return Bt(r,16,n);case"auto":return Yi(r,i,t&&t).replace(/((\.\d*?)(0+))($|e)/,function(){var o=arguments[2],c=arguments[4];return o!=="."?o+c:c});default:throw new Error('Unknown notation "'+e+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function It(r){var t=String(r).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+r);var e=t[1],i=t[2],n=parseFloat(t[4]||"0"),o=i.indexOf(".");n+=o!==-1?o-1:i.length-1;var c=i.replace(".","").replace(/^0*/,function(h){return n-=h.length,""}).replace(/0*$/,"").split("").map(function(h){return parseInt(h)});return c.length===0&&(c.push(0),n++),{sign:e,coefficients:c,exponent:n}}function ji(r,t){if(isNaN(r)||!isFinite(r))return String(r);var e=It(r),i=Ct(e,t),n=i.exponent,o=i.coefficients,c=n%3===0?n:n<0?n-3-n%3:n-n%3;if(fr(t))for(;t>o.length||n-c+1>o.length;)o.push(0);else for(var h=Math.abs(n-c)-(o.length-1),d=0;d<h;d++)o.push(0);for(var g=Math.abs(n-c),s=1;g>0;)s++,g--;var a=o.slice(s).join(""),f=fr(t)&&a.length||a.match(/[1-9]/)?"."+a:"",l=o.slice(0,s).join("")+f+"e"+(n>=0?"+":"")+c.toString();return i.sign+l}function Ji(r,t){if(isNaN(r)||!isFinite(r))return String(r);var e=It(r),i=typeof t=="number"?Ct(e,e.exponent+1+t):e,n=i.coefficients,o=i.exponent+1,c=o+(t||0);return n.length<c&&(n=n.concat(it(c-n.length))),o<0&&(n=it(-o+1).concat(n),o=1),o<n.length&&n.splice(o,0,o===0?"0.":"."),i.sign+n.join("")}function We(r,t){if(isNaN(r)||!isFinite(r))return String(r);var e=It(r),i=t?Ct(e,t):e,n=i.coefficients,o=i.exponent;n.length<t&&(n=n.concat(it(t-n.length)));var c=n.shift();return i.sign+c+(n.length>0?"."+n.join(""):"")+"e"+(o>=0?"+":"")+o}function Yi(r,t,e){if(isNaN(r)||!isFinite(r))return String(r);var i=e&&e.lowerExp!==void 0?e.lowerExp:-3,n=e&&e.upperExp!==void 0?e.upperExp:5,o=It(r),c=t?Ct(o,t):o;if(c.exponent<i||c.exponent>=n)return We(r,t);var h=c.coefficients,d=c.exponent;h.length<t&&(h=h.concat(it(t-h.length))),h=h.concat(it(d-h.length+1+(h.length<t?t-h.length:0))),h=it(-d).concat(h);var g=d>0?d:0;return g<h.length-1&&h.splice(g+1,0,"."),c.sign+h.join("")}function Ct(r,t){for(var e={sign:r.sign,coefficients:r.coefficients,exponent:r.exponent},i=e.coefficients;t<=0;)i.unshift(0),e.exponent++,t++;if(i.length>t){var n=i.splice(t,i.length-t);if(n[0]>=5){var o=t-1;for(i[o]++;i[o]===10;)i.pop(),o===0&&(i.unshift(0),e.exponent++,o++),o--,i[o]++}}return e}function it(r){for(var t=[],e=0;e<r;e++)t.push(0);return t}function Xi(r){return r.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}var Qi=Number.EPSILON||2220446049250313e-31;function wt(r,t,e){if(e==null)return r===t;if(r===t)return!0;if(isNaN(r)||isNaN(t))return!1;if(isFinite(r)&&isFinite(t)){var i=Math.abs(r-t);return i<Qi?!0:i<=Math.max(Math.abs(r),Math.abs(t))*e}return!1}function qt(r,t,e){var i=r.constructor,n=new i(2),o="";if(e){if(e<1)throw new Error("size must be in greater than 0");if(!_r(e))throw new Error("size must be an integer");if(r.greaterThan(n.pow(e-1).sub(1))||r.lessThan(n.pow(e-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(e-1,", 2^").concat(e-1,"-1]"));if(!r.isInteger())throw new Error("Value must be an integer");r.lessThan(0)&&(r=r.add(n.pow(e))),o="i".concat(e)}switch(t){case 2:return"".concat(r.toBinary()).concat(o);case 8:return"".concat(r.toOctal()).concat(o);case 16:return"".concat(r.toHexadecimal()).concat(o);default:throw new Error("Base ".concat(t," not supported "))}}function Ki(r,t){if(typeof t=="function")return t(r);if(!r.isFinite())return r.isNaN()?"NaN":r.gt(0)?"Infinity":"-Infinity";var e="auto",i,n;if(t!==void 0&&(t.notation&&(e=t.notation),typeof t=="number"?i=t:t.precision&&(i=t.precision),t.wordSize&&(n=t.wordSize,typeof n!="number")))throw new Error('Option "wordSize" must be a number');switch(e){case"fixed":return ro(r,i);case"exponential":return ge(r,i);case"engineering":return ki(r,i);case"bin":return qt(r,2,n);case"oct":return qt(r,8,n);case"hex":return qt(r,16,n);case"auto":{var o=t&&t.lowerExp!==void 0?t.lowerExp:-3,c=t&&t.upperExp!==void 0?t.upperExp:5;if(r.isZero())return"0";var h,d=r.toSignificantDigits(i),g=d.e;return g>=o&&g<c?h=d.toFixed():h=ge(r,i),h.replace(/((\.\d*?)(0+))($|e)/,function(){var s=arguments[2],a=arguments[4];return s!=="."?s+a:a})}default:throw new Error('Unknown notation "'+e+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function ki(r,t){var e=r.e,i=e%3===0?e:e<0?e-3-e%3:e-e%3,n=r.mul(Math.pow(10,-i)),o=n.toPrecision(t);return o.indexOf("e")!==-1&&(o=n.toString()),o+"e"+(e>=0?"+":"")+i.toString()}function ge(r,t){return t!==void 0?r.toExponential(t-1):r.toExponential()}function ro(r,t){return r.toFixed(t)}function xr(r,t){if(typeof r=="number")return Ht(r,t);if(zr(r))return Ki(r,t);if(to(r))return!t||t.fraction!=="decimal"?r.s*r.n+"/"+r.d:r.toString();if(Array.isArray(r))return je(r,t);if($r(r))return'"'+r+'"';if(typeof r=="function")return r.syntax?String(r.syntax):"function";if(r&&typeof r=="object"){if(typeof r.format=="function")return r.format(t);if(r&&r.toString(t)!=={}.toString())return r.toString(t);var e=Object.keys(r).map(i=>'"'+i+'": '+xr(r[i],t));return"{"+e.join(", ")+"}"}return String(r)}function je(r,t){if(Array.isArray(r)){for(var e="[",i=r.length,n=0;n<i;n++)n!==0&&(e+=", "),e+=je(r[n],t);return e+="]",e}else return xr(r,t)}function to(r){return r&&typeof r=="object"&&typeof r.s=="number"&&typeof r.n=="number"&&typeof r.d=="number"||!1}function sr(r,t,e){if(!(this instanceof sr))throw new SyntaxError("Constructor must be called with the new operator");this.actual=r,this.expected=t,this.relation=e,this.message="Dimension mismatch ("+(Array.isArray(r)?"["+r.join(", ")+"]":r)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=new Error().stack}sr.prototype=new RangeError;sr.prototype.constructor=RangeError;sr.prototype.name="DimensionError";sr.prototype.isDimensionError=!0;function ut(r,t,e){if(!(this instanceof ut))throw new SyntaxError("Constructor must be called with the new operator");this.index=r,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=e),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}ut.prototype=new RangeError;ut.prototype.constructor=RangeError;ut.prototype.name="IndexError";ut.prototype.isIndexError=!0;function kr(r){for(var t=[];Array.isArray(r);)t.push(r.length),r=r[0];return t}function Je(r,t,e){var i,n=r.length;if(n!==t[e])throw new sr(n,t[e]);if(e<t.length-1){var o=e+1;for(i=0;i<n;i++){var c=r[i];if(!Array.isArray(c))throw new sr(t.length-1,t.length,"<");Je(r[i],t,o)}}else for(i=0;i<n;i++)if(Array.isArray(r[i]))throw new sr(t.length+1,t.length,">")}function we(r,t){var e=t.length===0;if(e){if(Array.isArray(r))throw new sr(r.length,0)}else Je(r,t,0)}function vr(r,t){if(!fr(r)||!_r(r))throw new TypeError("Index must be an integer (value: "+r+")");if(r<0||typeof t=="number"&&r>=t)throw new ut(r,t)}function ye(r,t,e){if(!Array.isArray(r)||!Array.isArray(t))throw new TypeError("Array expected");if(t.length===0)throw new Error("Resizing to scalar is not supported");t.forEach(function(n){if(!fr(n)||!_r(n)||n<0)throw new TypeError("Invalid size, must contain positive integers (size: "+xr(t)+")")});var i=e!==void 0?e:0;return Wt(r,t,0,i),r}function Wt(r,t,e,i){var n,o,c=r.length,h=t[e],d=Math.min(c,h);if(r.length=h,e<t.length-1){var g=e+1;for(n=0;n<d;n++)o=r[n],Array.isArray(o)||(o=[o],r[n]=o),Wt(o,t,g,i);for(n=d;n<h;n++)o=[],r[n]=o,Wt(o,t,g,i)}else{for(n=0;n<d;n++)for(;Array.isArray(r[n]);)r[n]=r[n][0];for(n=d;n<h;n++)r[n]=i}}function eo(r,t){var e=io(r),i=e.length;if(!Array.isArray(r)||!Array.isArray(t))throw new TypeError("Array expected");if(t.length===0)throw new sr(0,i,"!=");t=ae(t,i);var n=Ye(t);if(i!==n)throw new sr(n,i,"!=");try{return no(e,t)}catch(o){throw o instanceof sr?new sr(n,i,"!="):o}}function ae(r,t){var e=Ye(r),i=r.slice(),n=-1,o=r.indexOf(n),c=r.indexOf(n,o+1)>=0;if(c)throw new Error("More than one wildcard in sizes");var h=o>=0,d=t%e===0;if(h)if(d)i[o]=-t/e;else throw new Error("Could not replace wildcard, since "+t+" is no multiple of "+-e);return i}function Ye(r){return r.reduce((t,e)=>t*e,1)}function no(r,t){for(var e=r,i,n=t.length-1;n>0;n--){var o=t[n];i=[];for(var c=e.length/o,h=0;h<c;h++)i.push(e.slice(h*o,(h+1)*o));e=i}return e}function Xe(r,t,e,i){var n=i||kr(r);if(e)for(var o=0;o<e;o++)r=[r],n.unshift(1);for(r=Qe(r,t,0);n.length<t;)n.push(1);return r}function Qe(r,t,e){var i,n;if(Array.isArray(r)){var o=e+1;for(i=0,n=r.length;i<n;i++)r[i]=Qe(r[i],t,o)}else for(var c=e;c<t;c++)r=[r];return r}function io(r){if(!Array.isArray(r))return r;var t=[];return r.forEach(function e(i){Array.isArray(i)?i.forEach(e):t.push(i)}),t}function yt(r,t){for(var e,i=0,n=0;n<r.length;n++){var o=r[n],c=Array.isArray(o);if(n===0&&c&&(i=o.length),c&&o.length!==i)return;var h=c?yt(o,t):t(o);if(e===void 0)e=h;else if(e!==h)return"mixed"}return e}function gr(r,t,e,i){function n(o){var c=Vi(o,t.map(so));return oo(r,t,o),e(c)}return n.isFactory=!0,n.fn=r,n.dependencies=t.slice().sort(),i&&(n.meta=i),n}function oo(r,t,e){var i=t.filter(o=>!ao(o)).every(o=>e[o]!==void 0);if(!i){var n=t.filter(o=>e[o]===void 0);throw new Error('Cannot create function "'.concat(r,'", ')+"some dependencies are missing: ".concat(n.map(o=>'"'.concat(o,'"')).join(", "),"."))}}function ao(r){return r&&r[0]==="?"}function so(r){return r&&r[0]==="?"?r.slice(1):r}function uo(r,t){if(ke(r)&&Ke(r,t))return r[t];throw typeof r[t]=="function"&&lo(r,t)?new Error('Cannot access method "'+t+'" as a property'):new Error('No access to property "'+t+'"')}function fo(r,t,e){if(ke(r)&&Ke(r,t))return r[t]=e,e;throw new Error('No access to property "'+t+'"')}function co(r,t){return t in r}function Ke(r,t){return!r||typeof r!="object"?!1:ht(ho,t)?!0:!(t in Object.prototype||t in Function.prototype)}function lo(r,t){return r==null||typeof r[t]!="function"||ht(r,t)&&Object.getPrototypeOf&&t in Object.getPrototypeOf(r)?!1:ht(po,t)?!0:!(t in Object.prototype||t in Function.prototype)}function ke(r){return typeof r=="object"&&r&&r.constructor===Object}var ho={length:!0,name:!0},po={toString:!0,valueOf:!0,toLocaleString:!0};class vo{constructor(t){this.wrappedObject=t}keys(){return Object.keys(this.wrappedObject)}get(t){return uo(this.wrappedObject,t)}set(t,e){return fo(this.wrappedObject,t,e),this}has(t){return co(this.wrappedObject,t)}}function mo(r){return r?r instanceof Map||r instanceof vo||typeof r.set=="function"&&typeof r.get=="function"&&typeof r.keys=="function"&&typeof r.has=="function":!1}var rn=function(){return rn=me.create,me},go=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],wo=gr("typed",go,function(t){var{BigNumber:e,Complex:i,DenseMatrix:n,Fraction:o}=t,c=rn();return c.types=[{name:"number",test:fr},{name:"Complex",test:ne},{name:"BigNumber",test:zr},{name:"Fraction",test:ie},{name:"Unit",test:oe},{name:"string",test:$r},{name:"Chain",test:Ge},{name:"Array",test:ar},{name:"Matrix",test:Sr},{name:"DenseMatrix",test:wi},{name:"SparseMatrix",test:yi},{name:"Range",test:Ue},{name:"Index",test:St},{name:"boolean",test:_i},{name:"ResultSet",test:$e},{name:"Help",test:Ze},{name:"function",test:Ni},{name:"Date",test:Mi},{name:"RegExp",test:Ei},{name:"null",test:Si},{name:"undefined",test:Ai},{name:"AccessorNode",test:Ii},{name:"ArrayNode",test:Ci},{name:"AssignmentNode",test:xi},{name:"BlockNode",test:Oi},{name:"ConditionalNode",test:Ti},{name:"ConstantNode",test:Pi},{name:"FunctionNode",test:Fi},{name:"FunctionAssignmentNode",test:zi},{name:"IndexNode",test:Di},{name:"Node",test:Ve},{name:"ObjectNode",test:Bi},{name:"OperatorNode",test:qi},{name:"ParenthesisNode",test:Ri},{name:"RangeNode",test:Li},{name:"SymbolNode",test:Ui},{name:"Map",test:mo},{name:"Object",test:bi}],c.conversions=[{from:"number",to:"BigNumber",convert:function(d){if(e||Rt(d),Xi(d)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+d+"). Use function bignumber(x) to convert to BigNumber.");return new e(d)}},{from:"number",to:"Complex",convert:function(d){return i||dt(d),new i(d,0)}},{from:"number",to:"string",convert:function(d){return d+""}},{from:"BigNumber",to:"Complex",convert:function(d){return i||dt(d),new i(d.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(d){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(d){return i||dt(d),new i(d.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(d){o||Lt(d);var g=new o(d);if(g.valueOf()!==d)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+d+"). Use function fraction(x) to convert to Fraction.");return g}},{from:"string",to:"number",convert:function(d){var g=Number(d);if(isNaN(g))throw new Error('Cannot convert "'+d+'" to a number');return g}},{from:"string",to:"BigNumber",convert:function(d){e||Rt(d);try{return new e(d)}catch{throw new Error('Cannot convert "'+d+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(d){o||Lt(d);try{return new o(d)}catch{throw new Error('Cannot convert "'+d+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(d){i||dt(d);try{return new i(d)}catch{throw new Error('Cannot convert "'+d+'" to Complex')}}},{from:"boolean",to:"number",convert:function(d){return+d}},{from:"boolean",to:"BigNumber",convert:function(d){return e||Rt(d),new e(+d)}},{from:"boolean",to:"Fraction",convert:function(d){return o||Lt(d),new o(+d)}},{from:"boolean",to:"string",convert:function(d){return String(d)}},{from:"Array",to:"Matrix",convert:function(d){return n||yo(),new n(d)}},{from:"Matrix",to:"Array",convert:function(d){return d.valueOf()}}],c});function Rt(r){throw new Error("Cannot convert value ".concat(r," into a BigNumber: no class 'BigNumber' provided"))}function dt(r){throw new Error("Cannot convert value ".concat(r," into a Complex number: no class 'Complex' provided"))}function yo(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function Lt(r){throw new Error("Cannot convert value ".concat(r," into a Fraction, no class 'Fraction' provided."))}/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var nt=9e15,Yr=1e9,jt="0123456789abcdef",_t="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Nt="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Jt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-nt,maxE:nt,crypto:!1},tn,Zr,J=!0,xt="[DecimalError] ",Jr=xt+"Invalid argument: ",en=xt+"Precision limit exceeded",nn=xt+"crypto unavailable",on="[object Decimal]",Er=Math.floor,dr=Math.pow,_o=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,No=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Mo=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,an=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Dr=1e7,W=7,Eo=9007199254740991,bo=_t.length-1,Yt=Nt.length-1,P={toStringTag:on};P.absoluteValue=P.abs=function(){var r=new this.constructor(this);return r.s<0&&(r.s=1),$(r)};P.ceil=function(){return $(new this.constructor(this),this.e+1,2)};P.clampedTo=P.clamp=function(r,t){var e,i=this,n=i.constructor;if(r=new n(r),t=new n(t),!r.s||!t.s)return new n(NaN);if(r.gt(t))throw Error(Jr+t);return e=i.cmp(r),e<0?r:i.cmp(t)>0?t:new n(i)};P.comparedTo=P.cmp=function(r){var t,e,i,n,o=this,c=o.d,h=(r=new o.constructor(r)).d,d=o.s,g=r.s;if(!c||!h)return!d||!g?NaN:d!==g?d:c===h?0:!c^d<0?1:-1;if(!c[0]||!h[0])return c[0]?d:h[0]?-g:0;if(d!==g)return d;if(o.e!==r.e)return o.e>r.e^d<0?1:-1;for(i=c.length,n=h.length,t=0,e=i<n?i:n;t<e;++t)if(c[t]!==h[t])return c[t]>h[t]^d<0?1:-1;return i===n?0:i>n^d<0?1:-1};P.cosine=P.cos=function(){var r,t,e=this,i=e.constructor;return e.d?e.d[0]?(r=i.precision,t=i.rounding,i.precision=r+Math.max(e.e,e.sd())+W,i.rounding=1,e=So(i,ln(i,e)),i.precision=r,i.rounding=t,$(Zr==2||Zr==3?e.neg():e,r,t,!0)):new i(1):new i(NaN)};P.cubeRoot=P.cbrt=function(){var r,t,e,i,n,o,c,h,d,g,s=this,a=s.constructor;if(!s.isFinite()||s.isZero())return new a(s);for(J=!1,o=s.s*dr(s.s*s,1/3),!o||Math.abs(o)==1/0?(e=Nr(s.d),r=s.e,(o=(r-e.length+1)%3)&&(e+=o==1||o==-2?"0":"00"),o=dr(e,1/3),r=Er((r+1)/3)-(r%3==(r<0?-1:2)),o==1/0?e="5e"+r:(e=o.toExponential(),e=e.slice(0,e.indexOf("e")+1)+r),i=new a(e),i.s=s.s):i=new a(o.toString()),c=(r=a.precision)+3;;)if(h=i,d=h.times(h).times(h),g=d.plus(s),i=tr(g.plus(s).times(h),g.plus(d),c+2,1),Nr(h.d).slice(0,c)===(e=Nr(i.d)).slice(0,c))if(e=e.slice(c-3,c+1),e=="9999"||!n&&e=="4999"){if(!n&&($(h,r+1,0),h.times(h).times(h).eq(s))){i=h;break}c+=4,n=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&($(i,r+1,1),t=!i.times(i).times(i).eq(s));break}return J=!0,$(i,r,a.rounding,t)};P.decimalPlaces=P.dp=function(){var r,t=this.d,e=NaN;if(t){if(r=t.length-1,e=(r-Er(this.e/W))*W,r=t[r],r)for(;r%10==0;r/=10)e--;e<0&&(e=0)}return e};P.dividedBy=P.div=function(r){return tr(this,new this.constructor(r))};P.dividedToIntegerBy=P.divToInt=function(r){var t=this,e=t.constructor;return $(tr(t,new e(r),0,1,1),e.precision,e.rounding)};P.equals=P.eq=function(r){return this.cmp(r)===0};P.floor=function(){return $(new this.constructor(this),this.e+1,3)};P.greaterThan=P.gt=function(r){return this.cmp(r)>0};P.greaterThanOrEqualTo=P.gte=function(r){var t=this.cmp(r);return t==1||t===0};P.hyperbolicCosine=P.cosh=function(){var r,t,e,i,n,o=this,c=o.constructor,h=new c(1);if(!o.isFinite())return new c(o.s?1/0:NaN);if(o.isZero())return h;e=c.precision,i=c.rounding,c.precision=e+Math.max(o.e,o.sd())+4,c.rounding=1,n=o.d.length,n<32?(r=Math.ceil(n/3),t=(1/Tt(4,r)).toString()):(r=16,t="2.3283064365386962890625e-10"),o=at(c,1,o.times(t),new c(1),!0);for(var d,g=r,s=new c(8);g--;)d=o.times(o),o=h.minus(d.times(s.minus(d.times(s))));return $(o,c.precision=e,c.rounding=i,!0)};P.hyperbolicSine=P.sinh=function(){var r,t,e,i,n=this,o=n.constructor;if(!n.isFinite()||n.isZero())return new o(n);if(t=o.precision,e=o.rounding,o.precision=t+Math.max(n.e,n.sd())+4,o.rounding=1,i=n.d.length,i<3)n=at(o,2,n,n,!0);else{r=1.4*Math.sqrt(i),r=r>16?16:r|0,n=n.times(1/Tt(5,r)),n=at(o,2,n,n,!0);for(var c,h=new o(5),d=new o(16),g=new o(20);r--;)c=n.times(n),n=n.times(h.plus(c.times(d.times(c).plus(g))))}return o.precision=t,o.rounding=e,$(n,t,e,!0)};P.hyperbolicTangent=P.tanh=function(){var r,t,e=this,i=e.constructor;return e.isFinite()?e.isZero()?new i(e):(r=i.precision,t=i.rounding,i.precision=r+7,i.rounding=1,tr(e.sinh(),e.cosh(),i.precision=r,i.rounding=t)):new i(e.s)};P.inverseCosine=P.acos=function(){var r,t=this,e=t.constructor,i=t.abs().cmp(1),n=e.precision,o=e.rounding;return i!==-1?i===0?t.isNeg()?Fr(e,n,o):new e(0):new e(NaN):t.isZero()?Fr(e,n+4,o).times(.5):(e.precision=n+6,e.rounding=1,t=t.asin(),r=Fr(e,n+4,o).times(.5),e.precision=n,e.rounding=o,r.minus(t))};P.inverseHyperbolicCosine=P.acosh=function(){var r,t,e=this,i=e.constructor;return e.lte(1)?new i(e.eq(1)?0:NaN):e.isFinite()?(r=i.precision,t=i.rounding,i.precision=r+Math.max(Math.abs(e.e),e.sd())+4,i.rounding=1,J=!1,e=e.times(e).minus(1).sqrt().plus(e),J=!0,i.precision=r,i.rounding=t,e.ln()):new i(e)};P.inverseHyperbolicSine=P.asinh=function(){var r,t,e=this,i=e.constructor;return!e.isFinite()||e.isZero()?new i(e):(r=i.precision,t=i.rounding,i.precision=r+2*Math.max(Math.abs(e.e),e.sd())+6,i.rounding=1,J=!1,e=e.times(e).plus(1).sqrt().plus(e),J=!0,i.precision=r,i.rounding=t,e.ln())};P.inverseHyperbolicTangent=P.atanh=function(){var r,t,e,i,n=this,o=n.constructor;return n.isFinite()?n.e>=0?new o(n.abs().eq(1)?n.s/0:n.isZero()?n:NaN):(r=o.precision,t=o.rounding,i=n.sd(),Math.max(i,r)<2*-n.e-1?$(new o(n),r,t,!0):(o.precision=e=i-n.e,n=tr(n.plus(1),new o(1).minus(n),e+r,1),o.precision=r+4,o.rounding=1,n=n.ln(),o.precision=r,o.rounding=t,n.times(.5))):new o(NaN)};P.inverseSine=P.asin=function(){var r,t,e,i,n=this,o=n.constructor;return n.isZero()?new o(n):(t=n.abs().cmp(1),e=o.precision,i=o.rounding,t!==-1?t===0?(r=Fr(o,e+4,i).times(.5),r.s=n.s,r):new o(NaN):(o.precision=e+6,o.rounding=1,n=n.div(new o(1).minus(n.times(n)).sqrt().plus(1)).atan(),o.precision=e,o.rounding=i,n.times(2)))};P.inverseTangent=P.atan=function(){var r,t,e,i,n,o,c,h,d,g=this,s=g.constructor,a=s.precision,f=s.rounding;if(g.isFinite()){if(g.isZero())return new s(g);if(g.abs().eq(1)&&a+4<=Yt)return c=Fr(s,a+4,f).times(.25),c.s=g.s,c}else{if(!g.s)return new s(NaN);if(a+4<=Yt)return c=Fr(s,a+4,f).times(.5),c.s=g.s,c}for(s.precision=h=a+10,s.rounding=1,e=Math.min(28,h/W+2|0),r=e;r;--r)g=g.div(g.times(g).plus(1).sqrt().plus(1));for(J=!1,t=Math.ceil(h/W),i=1,d=g.times(g),c=new s(g),n=g;r!==-1;)if(n=n.times(d),o=c.minus(n.div(i+=2)),n=n.times(d),c=o.plus(n.div(i+=2)),c.d[t]!==void 0)for(r=t;c.d[r]===o.d[r]&&r--;);return e&&(c=c.times(2<<e-1)),J=!0,$(c,s.precision=a,s.rounding=f,!0)};P.isFinite=function(){return!!this.d};P.isInteger=P.isInt=function(){return!!this.d&&Er(this.e/W)>this.d.length-2};P.isNaN=function(){return!this.s};P.isNegative=P.isNeg=function(){return this.s<0};P.isPositive=P.isPos=function(){return this.s>0};P.isZero=function(){return!!this.d&&this.d[0]===0};P.lessThan=P.lt=function(r){return this.cmp(r)<0};P.lessThanOrEqualTo=P.lte=function(r){return this.cmp(r)<1};P.logarithm=P.log=function(r){var t,e,i,n,o,c,h,d,g=this,s=g.constructor,a=s.precision,f=s.rounding,l=5;if(r==null)r=new s(10),t=!0;else{if(r=new s(r),e=r.d,r.s<0||!e||!e[0]||r.eq(1))return new s(NaN);t=r.eq(10)}if(e=g.d,g.s<0||!e||!e[0]||g.eq(1))return new s(e&&!e[0]?-1/0:g.s!=1?NaN:e?0:1/0);if(t)if(e.length>1)o=!0;else{for(n=e[0];n%10===0;)n/=10;o=n!==1}if(J=!1,h=a+l,c=jr(g,h),i=t?Mt(s,h+10):jr(r,h),d=tr(c,i,h,1),pt(d.d,n=a,f))do if(h+=10,c=jr(g,h),i=t?Mt(s,h+10):jr(r,h),d=tr(c,i,h,1),!o){+Nr(d.d).slice(n+1,n+15)+1==1e14&&(d=$(d,a+1,0));break}while(pt(d.d,n+=10,f));return J=!0,$(d,a,f)};P.minus=P.sub=function(r){var t,e,i,n,o,c,h,d,g,s,a,f,l=this,v=l.constructor;if(r=new v(r),!l.d||!r.d)return!l.s||!r.s?r=new v(NaN):l.d?r.s=-r.s:r=new v(r.d||l.s!==r.s?l:NaN),r;if(l.s!=r.s)return r.s=-r.s,l.plus(r);if(g=l.d,f=r.d,h=v.precision,d=v.rounding,!g[0]||!f[0]){if(f[0])r.s=-r.s;else if(g[0])r=new v(l);else return new v(d===3?-0:0);return J?$(r,h,d):r}if(e=Er(r.e/W),s=Er(l.e/W),g=g.slice(),o=s-e,o){for(a=o<0,a?(t=g,o=-o,c=f.length):(t=f,e=s,c=g.length),i=Math.max(Math.ceil(h/W),c)+2,o>i&&(o=i,t.length=1),t.reverse(),i=o;i--;)t.push(0);t.reverse()}else{for(i=g.length,c=f.length,a=i<c,a&&(c=i),i=0;i<c;i++)if(g[i]!=f[i]){a=g[i]<f[i];break}o=0}for(a&&(t=g,g=f,f=t,r.s=-r.s),c=g.length,i=f.length-c;i>0;--i)g[c++]=0;for(i=f.length;i>o;){if(g[--i]<f[i]){for(n=i;n&&g[--n]===0;)g[n]=Dr-1;--g[n],g[i]+=Dr}g[i]-=f[i]}for(;g[--c]===0;)g.pop();for(;g[0]===0;g.shift())--e;return g[0]?(r.d=g,r.e=Ot(g,e),J?$(r,h,d):r):new v(d===3?-0:0)};P.modulo=P.mod=function(r){var t,e=this,i=e.constructor;return r=new i(r),!e.d||!r.s||r.d&&!r.d[0]?new i(NaN):!r.d||e.d&&!e.d[0]?$(new i(e),i.precision,i.rounding):(J=!1,i.modulo==9?(t=tr(e,r.abs(),0,3,1),t.s*=r.s):t=tr(e,r,0,i.modulo,1),t=t.times(r),J=!0,e.minus(t))};P.naturalExponential=P.exp=function(){return Xt(this)};P.naturalLogarithm=P.ln=function(){return jr(this)};P.negated=P.neg=function(){var r=new this.constructor(this);return r.s=-r.s,$(r)};P.plus=P.add=function(r){var t,e,i,n,o,c,h,d,g,s,a=this,f=a.constructor;if(r=new f(r),!a.d||!r.d)return!a.s||!r.s?r=new f(NaN):a.d||(r=new f(r.d||a.s===r.s?a:NaN)),r;if(a.s!=r.s)return r.s=-r.s,a.minus(r);if(g=a.d,s=r.d,h=f.precision,d=f.rounding,!g[0]||!s[0])return s[0]||(r=new f(a)),J?$(r,h,d):r;if(o=Er(a.e/W),i=Er(r.e/W),g=g.slice(),n=o-i,n){for(n<0?(e=g,n=-n,c=s.length):(e=s,i=o,c=g.length),o=Math.ceil(h/W),c=o>c?o+1:c+1,n>c&&(n=c,e.length=1),e.reverse();n--;)e.push(0);e.reverse()}for(c=g.length,n=s.length,c-n<0&&(n=c,e=s,s=g,g=e),t=0;n;)t=(g[--n]=g[n]+s[n]+t)/Dr|0,g[n]%=Dr;for(t&&(g.unshift(t),++i),c=g.length;g[--c]==0;)g.pop();return r.d=g,r.e=Ot(g,i),J?$(r,h,d):r};P.precision=P.sd=function(r){var t,e=this;if(r!==void 0&&r!==!!r&&r!==1&&r!==0)throw Error(Jr+r);return e.d?(t=sn(e.d),r&&e.e+1>t&&(t=e.e+1)):t=NaN,t};P.round=function(){var r=this,t=r.constructor;return $(new t(r),r.e+1,t.rounding)};P.sine=P.sin=function(){var r,t,e=this,i=e.constructor;return e.isFinite()?e.isZero()?new i(e):(r=i.precision,t=i.rounding,i.precision=r+Math.max(e.e,e.sd())+W,i.rounding=1,e=Io(i,ln(i,e)),i.precision=r,i.rounding=t,$(Zr>2?e.neg():e,r,t,!0)):new i(NaN)};P.squareRoot=P.sqrt=function(){var r,t,e,i,n,o,c=this,h=c.d,d=c.e,g=c.s,s=c.constructor;if(g!==1||!h||!h[0])return new s(!g||g<0&&(!h||h[0])?NaN:h?c:1/0);for(J=!1,g=Math.sqrt(+c),g==0||g==1/0?(t=Nr(h),(t.length+d)%2==0&&(t+="0"),g=Math.sqrt(t),d=Er((d+1)/2)-(d<0||d%2),g==1/0?t="5e"+d:(t=g.toExponential(),t=t.slice(0,t.indexOf("e")+1)+d),i=new s(t)):i=new s(g.toString()),e=(d=s.precision)+3;;)if(o=i,i=o.plus(tr(c,o,e+2,1)).times(.5),Nr(o.d).slice(0,e)===(t=Nr(i.d)).slice(0,e))if(t=t.slice(e-3,e+1),t=="9999"||!n&&t=="4999"){if(!n&&($(o,d+1,0),o.times(o).eq(c))){i=o;break}e+=4,n=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&($(i,d+1,1),r=!i.times(i).eq(c));break}return J=!0,$(i,d,s.rounding,r)};P.tangent=P.tan=function(){var r,t,e=this,i=e.constructor;return e.isFinite()?e.isZero()?new i(e):(r=i.precision,t=i.rounding,i.precision=r+10,i.rounding=1,e=e.sin(),e.s=1,e=tr(e,new i(1).minus(e.times(e)).sqrt(),r+10,0),i.precision=r,i.rounding=t,$(Zr==2||Zr==4?e.neg():e,r,t,!0)):new i(NaN)};P.times=P.mul=function(r){var t,e,i,n,o,c,h,d,g,s=this,a=s.constructor,f=s.d,l=(r=new a(r)).d;if(r.s*=s.s,!f||!f[0]||!l||!l[0])return new a(!r.s||f&&!f[0]&&!l||l&&!l[0]&&!f?NaN:!f||!l?r.s/0:r.s*0);for(e=Er(s.e/W)+Er(r.e/W),d=f.length,g=l.length,d<g&&(o=f,f=l,l=o,c=d,d=g,g=c),o=[],c=d+g,i=c;i--;)o.push(0);for(i=g;--i>=0;){for(t=0,n=d+i;n>i;)h=o[n]+l[i]*f[n-i-1]+t,o[n--]=h%Dr|0,t=h/Dr|0;o[n]=(o[n]+t)%Dr|0}for(;!o[--c];)o.pop();return t?++e:o.shift(),r.d=o,r.e=Ot(o,e),J?$(r,a.precision,a.rounding):r};P.toBinary=function(r,t){return se(this,2,r,t)};P.toDecimalPlaces=P.toDP=function(r,t){var e=this,i=e.constructor;return e=new i(e),r===void 0?e:(Or(r,0,Yr),t===void 0?t=i.rounding:Or(t,0,8),$(e,r+e.e+1,t))};P.toExponential=function(r,t){var e,i=this,n=i.constructor;return r===void 0?e=Lr(i,!0):(Or(r,0,Yr),t===void 0?t=n.rounding:Or(t,0,8),i=$(new n(i),r+1,t),e=Lr(i,!0,r+1)),i.isNeg()&&!i.isZero()?"-"+e:e};P.toFixed=function(r,t){var e,i,n=this,o=n.constructor;return r===void 0?e=Lr(n):(Or(r,0,Yr),t===void 0?t=o.rounding:Or(t,0,8),i=$(new o(n),r+n.e+1,t),e=Lr(i,!1,r+i.e+1)),n.isNeg()&&!n.isZero()?"-"+e:e};P.toFraction=function(r){var t,e,i,n,o,c,h,d,g,s,a,f,l=this,v=l.d,u=l.constructor;if(!v)return new u(l);if(g=e=new u(1),i=d=new u(0),t=new u(i),o=t.e=sn(v)-l.e-1,c=o%W,t.d[0]=dr(10,c<0?W+c:c),r==null)r=o>0?t:g;else{if(h=new u(r),!h.isInt()||h.lt(g))throw Error(Jr+h);r=h.gt(t)?o>0?t:g:h}for(J=!1,h=new u(Nr(v)),s=u.precision,u.precision=o=v.length*W*2;a=tr(h,t,0,1,1),n=e.plus(a.times(i)),n.cmp(r)!=1;)e=i,i=n,n=g,g=d.plus(a.times(n)),d=n,n=t,t=h.minus(a.times(n)),h=n;return n=tr(r.minus(e),i,0,1,1),d=d.plus(n.times(g)),e=e.plus(n.times(i)),d.s=g.s=l.s,f=tr(g,i,o,1).minus(l).abs().cmp(tr(d,e,o,1).minus(l).abs())<1?[g,i]:[d,e],u.precision=s,J=!0,f};P.toHexadecimal=P.toHex=function(r,t){return se(this,16,r,t)};P.toNearest=function(r,t){var e=this,i=e.constructor;if(e=new i(e),r==null){if(!e.d)return e;r=new i(1),t=i.rounding}else{if(r=new i(r),t===void 0?t=i.rounding:Or(t,0,8),!e.d)return r.s?e:r;if(!r.d)return r.s&&(r.s=e.s),r}return r.d[0]?(J=!1,e=tr(e,r,0,t,1).times(r),J=!0,$(e)):(r.s=e.s,e=r),e};P.toNumber=function(){return+this};P.toOctal=function(r,t){return se(this,8,r,t)};P.toPower=P.pow=function(r){var t,e,i,n,o,c,h=this,d=h.constructor,g=+(r=new d(r));if(!h.d||!r.d||!h.d[0]||!r.d[0])return new d(dr(+h,g));if(h=new d(h),h.eq(1))return h;if(i=d.precision,o=d.rounding,r.eq(1))return $(h,i,o);if(t=Er(r.e/W),t>=r.d.length-1&&(e=g<0?-g:g)<=Eo)return n=un(d,h,e,i),r.s<0?new d(1).div(n):$(n,i,o);if(c=h.s,c<0){if(t<r.d.length-1)return new d(NaN);if(r.d[t]&1||(c=1),h.e==0&&h.d[0]==1&&h.d.length==1)return h.s=c,h}return e=dr(+h,g),t=e==0||!isFinite(e)?Er(g*(Math.log("0."+Nr(h.d))/Math.LN10+h.e+1)):new d(e+"").e,t>d.maxE+1||t<d.minE-1?new d(t>0?c/0:0):(J=!1,d.rounding=h.s=1,e=Math.min(12,(t+"").length),n=Xt(r.times(jr(h,i+e)),i),n.d&&(n=$(n,i+5,1),pt(n.d,i,o)&&(t=i+10,n=$(Xt(r.times(jr(h,t+e)),t),t+5,1),+Nr(n.d).slice(i+1,i+15)+1==1e14&&(n=$(n,i+1,0)))),n.s=c,J=!0,d.rounding=o,$(n,i,o))};P.toPrecision=function(r,t){var e,i=this,n=i.constructor;return r===void 0?e=Lr(i,i.e<=n.toExpNeg||i.e>=n.toExpPos):(Or(r,1,Yr),t===void 0?t=n.rounding:Or(t,0,8),i=$(new n(i),r,t),e=Lr(i,r<=i.e||i.e<=n.toExpNeg,r)),i.isNeg()&&!i.isZero()?"-"+e:e};P.toSignificantDigits=P.toSD=function(r,t){var e=this,i=e.constructor;return r===void 0?(r=i.precision,t=i.rounding):(Or(r,1,Yr),t===void 0?t=i.rounding:Or(t,0,8)),$(new i(e),r,t)};P.toString=function(){var r=this,t=r.constructor,e=Lr(r,r.e<=t.toExpNeg||r.e>=t.toExpPos);return r.isNeg()&&!r.isZero()?"-"+e:e};P.truncated=P.trunc=function(){return $(new this.constructor(this),this.e+1,1)};P.valueOf=P.toJSON=function(){var r=this,t=r.constructor,e=Lr(r,r.e<=t.toExpNeg||r.e>=t.toExpPos);return r.isNeg()?"-"+e:e};function Nr(r){var t,e,i,n=r.length-1,o="",c=r[0];if(n>0){for(o+=c,t=1;t<n;t++)i=r[t]+"",e=W-i.length,e&&(o+=Wr(e)),o+=i;c=r[t],i=c+"",e=W-i.length,e&&(o+=Wr(e))}else if(c===0)return"0";for(;c%10===0;)c/=10;return o+c}function Or(r,t,e){if(r!==~~r||r<t||r>e)throw Error(Jr+r)}function pt(r,t,e,i){var n,o,c,h;for(o=r[0];o>=10;o/=10)--t;return--t<0?(t+=W,n=0):(n=Math.ceil((t+1)/W),t%=W),o=dr(10,W-t),h=r[n]%o|0,i==null?t<3?(t==0?h=h/100|0:t==1&&(h=h/10|0),c=e<4&&h==99999||e>3&&h==49999||h==5e4||h==0):c=(e<4&&h+1==o||e>3&&h+1==o/2)&&(r[n+1]/o/100|0)==dr(10,t-2)-1||(h==o/2||h==0)&&(r[n+1]/o/100|0)==0:t<4?(t==0?h=h/1e3|0:t==1?h=h/100|0:t==2&&(h=h/10|0),c=(i||e<4)&&h==9999||!i&&e>3&&h==4999):c=((i||e<4)&&h+1==o||!i&&e>3&&h+1==o/2)&&(r[n+1]/o/1e3|0)==dr(10,t-3)-1,c}function mt(r,t,e){for(var i,n=[0],o,c=0,h=r.length;c<h;){for(o=n.length;o--;)n[o]*=t;for(n[0]+=jt.indexOf(r.charAt(c++)),i=0;i<n.length;i++)n[i]>e-1&&(n[i+1]===void 0&&(n[i+1]=0),n[i+1]+=n[i]/e|0,n[i]%=e)}return n.reverse()}function So(r,t){var e,i,n;if(t.isZero())return t;i=t.d.length,i<32?(e=Math.ceil(i/3),n=(1/Tt(4,e)).toString()):(e=16,n="2.3283064365386962890625e-10"),r.precision+=e,t=at(r,1,t.times(n),new r(1));for(var o=e;o--;){var c=t.times(t);t=c.times(c).minus(c).times(8).plus(1)}return r.precision-=e,t}var tr=function(){function r(i,n,o){var c,h=0,d=i.length;for(i=i.slice();d--;)c=i[d]*n+h,i[d]=c%o|0,h=c/o|0;return h&&i.unshift(h),i}function t(i,n,o,c){var h,d;if(o!=c)d=o>c?1:-1;else for(h=d=0;h<o;h++)if(i[h]!=n[h]){d=i[h]>n[h]?1:-1;break}return d}function e(i,n,o,c){for(var h=0;o--;)i[o]-=h,h=i[o]<n[o]?1:0,i[o]=h*c+i[o]-n[o];for(;!i[0]&&i.length>1;)i.shift()}return function(i,n,o,c,h,d){var g,s,a,f,l,v,u,p,m,N,w,S,M,E,A,y,b,x,T,F,D=i.constructor,L=i.s==n.s?1:-1,B=i.d,z=n.d;if(!B||!B[0]||!z||!z[0])return new D(!i.s||!n.s||(B?z&&B[0]==z[0]:!z)?NaN:B&&B[0]==0||!z?L*0:L/0);for(d?(l=1,s=i.e-n.e):(d=Dr,l=W,s=Er(i.e/l)-Er(n.e/l)),T=z.length,b=B.length,m=new D(L),N=m.d=[],a=0;z[a]==(B[a]||0);a++);if(z[a]>(B[a]||0)&&s--,o==null?(E=o=D.precision,c=D.rounding):h?E=o+(i.e-n.e)+1:E=o,E<0)N.push(1),v=!0;else{if(E=E/l+2|0,a=0,T==1){for(f=0,z=z[0],E++;(a<b||f)&&E--;a++)A=f*d+(B[a]||0),N[a]=A/z|0,f=A%z|0;v=f||a<b}else{for(f=d/(z[0]+1)|0,f>1&&(z=r(z,f,d),B=r(B,f,d),T=z.length,b=B.length),y=T,w=B.slice(0,T),S=w.length;S<T;)w[S++]=0;F=z.slice(),F.unshift(0),x=z[0],z[1]>=d/2&&++x;do f=0,g=t(z,w,T,S),g<0?(M=w[0],T!=S&&(M=M*d+(w[1]||0)),f=M/x|0,f>1?(f>=d&&(f=d-1),u=r(z,f,d),p=u.length,S=w.length,g=t(u,w,p,S),g==1&&(f--,e(u,T<p?F:z,p,d))):(f==0&&(g=f=1),u=z.slice()),p=u.length,p<S&&u.unshift(0),e(w,u,S,d),g==-1&&(S=w.length,g=t(z,w,T,S),g<1&&(f++,e(w,T<S?F:z,S,d))),S=w.length):g===0&&(f++,w=[0]),N[a++]=f,g&&w[0]?w[S++]=B[y]||0:(w=[B[y]],S=1);while((y++<b||w[0]!==void 0)&&E--);v=w[0]!==void 0}N[0]||N.shift()}if(l==1)m.e=s,tn=v;else{for(a=1,f=N[0];f>=10;f/=10)a++;m.e=a+s*l-1,$(m,h?o+m.e+1:o,c,v)}return m}}();function $(r,t,e,i){var n,o,c,h,d,g,s,a,f,l=r.constructor;r:if(t!=null){if(a=r.d,!a)return r;for(n=1,h=a[0];h>=10;h/=10)n++;if(o=t-n,o<0)o+=W,c=t,s=a[f=0],d=s/dr(10,n-c-1)%10|0;else if(f=Math.ceil((o+1)/W),h=a.length,f>=h)if(i){for(;h++<=f;)a.push(0);s=d=0,n=1,o%=W,c=o-W+1}else break r;else{for(s=h=a[f],n=1;h>=10;h/=10)n++;o%=W,c=o-W+n,d=c<0?0:s/dr(10,n-c-1)%10|0}if(i=i||t<0||a[f+1]!==void 0||(c<0?s:s%dr(10,n-c-1)),g=e<4?(d||i)&&(e==0||e==(r.s<0?3:2)):d>5||d==5&&(e==4||i||e==6&&(o>0?c>0?s/dr(10,n-c):0:a[f-1])%10&1||e==(r.s<0?8:7)),t<1||!a[0])return a.length=0,g?(t-=r.e+1,a[0]=dr(10,(W-t%W)%W),r.e=-t||0):a[0]=r.e=0,r;if(o==0?(a.length=f,h=1,f--):(a.length=f+1,h=dr(10,W-o),a[f]=c>0?(s/dr(10,n-c)%dr(10,c)|0)*h:0),g)for(;;)if(f==0){for(o=1,c=a[0];c>=10;c/=10)o++;for(c=a[0]+=h,h=1;c>=10;c/=10)h++;o!=h&&(r.e++,a[0]==Dr&&(a[0]=1));break}else{if(a[f]+=h,a[f]!=Dr)break;a[f--]=0,h=1}for(o=a.length;a[--o]===0;)a.pop()}return J&&(r.e>l.maxE?(r.d=null,r.e=NaN):r.e<l.minE&&(r.e=0,r.d=[0])),r}function Lr(r,t,e){if(!r.isFinite())return cn(r);var i,n=r.e,o=Nr(r.d),c=o.length;return t?(e&&(i=e-c)>0?o=o.charAt(0)+"."+o.slice(1)+Wr(i):c>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(r.e<0?"e":"e+")+r.e):n<0?(o="0."+Wr(-n-1)+o,e&&(i=e-c)>0&&(o+=Wr(i))):n>=c?(o+=Wr(n+1-c),e&&(i=e-n-1)>0&&(o=o+"."+Wr(i))):((i=n+1)<c&&(o=o.slice(0,i)+"."+o.slice(i)),e&&(i=e-c)>0&&(n+1===c&&(o+="."),o+=Wr(i))),o}function Ot(r,t){var e=r[0];for(t*=W;e>=10;e/=10)t++;return t}function Mt(r,t,e){if(t>bo)throw J=!0,e&&(r.precision=e),Error(en);return $(new r(_t),t,1,!0)}function Fr(r,t,e){if(t>Yt)throw Error(en);return $(new r(Nt),t,e,!0)}function sn(r){var t=r.length-1,e=t*W+1;if(t=r[t],t){for(;t%10==0;t/=10)e--;for(t=r[0];t>=10;t/=10)e++}return e}function Wr(r){for(var t="";r--;)t+="0";return t}function un(r,t,e,i){var n,o=new r(1),c=Math.ceil(i/W+4);for(J=!1;;){if(e%2&&(o=o.times(t),Ne(o.d,c)&&(n=!0)),e=Er(e/2),e===0){e=o.d.length-1,n&&o.d[e]===0&&++o.d[e];break}t=t.times(t),Ne(t.d,c)}return J=!0,o}function _e(r){return r.d[r.d.length-1]&1}function fn(r,t,e){for(var i,n=new r(t[0]),o=0;++o<t.length;)if(i=new r(t[o]),i.s)n[e](i)&&(n=i);else{n=i;break}return n}function Xt(r,t){var e,i,n,o,c,h,d,g=0,s=0,a=0,f=r.constructor,l=f.rounding,v=f.precision;if(!r.d||!r.d[0]||r.e>17)return new f(r.d?r.d[0]?r.s<0?0:1/0:1:r.s?r.s<0?0:r:NaN);for(t==null?(J=!1,d=v):d=t,h=new f(.03125);r.e>-2;)r=r.times(h),a+=5;for(i=Math.log(dr(2,a))/Math.LN10*2+5|0,d+=i,e=o=c=new f(1),f.precision=d;;){if(o=$(o.times(r),d,1),e=e.times(++s),h=c.plus(tr(o,e,d,1)),Nr(h.d).slice(0,d)===Nr(c.d).slice(0,d)){for(n=a;n--;)c=$(c.times(c),d,1);if(t==null)if(g<3&&pt(c.d,d-i,l,g))f.precision=d+=10,e=o=h=new f(1),s=0,g++;else return $(c,f.precision=v,l,J=!0);else return f.precision=v,c}c=h}}function jr(r,t){var e,i,n,o,c,h,d,g,s,a,f,l=1,v=10,u=r,p=u.d,m=u.constructor,N=m.rounding,w=m.precision;if(u.s<0||!p||!p[0]||!u.e&&p[0]==1&&p.length==1)return new m(p&&!p[0]?-1/0:u.s!=1?NaN:p?0:u);if(t==null?(J=!1,s=w):s=t,m.precision=s+=v,e=Nr(p),i=e.charAt(0),Math.abs(o=u.e)<15e14){for(;i<7&&i!=1||i==1&&e.charAt(1)>3;)u=u.times(r),e=Nr(u.d),i=e.charAt(0),l++;o=u.e,i>1?(u=new m("0."+e),o++):u=new m(i+"."+e.slice(1))}else return g=Mt(m,s+2,w).times(o+""),u=jr(new m(i+"."+e.slice(1)),s-v).plus(g),m.precision=w,t==null?$(u,w,N,J=!0):u;for(a=u,d=c=u=tr(u.minus(1),u.plus(1),s,1),f=$(u.times(u),s,1),n=3;;){if(c=$(c.times(f),s,1),g=d.plus(tr(c,new m(n),s,1)),Nr(g.d).slice(0,s)===Nr(d.d).slice(0,s))if(d=d.times(2),o!==0&&(d=d.plus(Mt(m,s+2,w).times(o+""))),d=tr(d,new m(l),s,1),t==null)if(pt(d.d,s-v,N,h))m.precision=s+=v,g=c=u=tr(a.minus(1),a.plus(1),s,1),f=$(u.times(u),s,1),n=h=1;else return $(d,m.precision=w,N,J=!0);else return m.precision=w,d;d=g,n+=2}}function cn(r){return String(r.s*r.s/0)}function Qt(r,t){var e,i,n;for((e=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(e<0&&(e=i),e+=+t.slice(i+1),t=t.substring(0,i)):e<0&&(e=t.length),i=0;t.charCodeAt(i)===48;i++);for(n=t.length;t.charCodeAt(n-1)===48;--n);if(t=t.slice(i,n),t){if(n-=i,r.e=e=e-i-1,r.d=[],i=(e+1)%W,e<0&&(i+=W),i<n){for(i&&r.d.push(+t.slice(0,i)),n-=W;i<n;)r.d.push(+t.slice(i,i+=W));t=t.slice(i),i=W-t.length}else i-=n;for(;i--;)t+="0";r.d.push(+t),J&&(r.e>r.constructor.maxE?(r.d=null,r.e=NaN):r.e<r.constructor.minE&&(r.e=0,r.d=[0]))}else r.e=0,r.d=[0];return r}function Ao(r,t){var e,i,n,o,c,h,d,g,s;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),an.test(t))return Qt(r,t)}else if(t==="Infinity"||t==="NaN")return+t||(r.s=NaN),r.e=NaN,r.d=null,r;if(No.test(t))e=16,t=t.toLowerCase();else if(_o.test(t))e=2;else if(Mo.test(t))e=8;else throw Error(Jr+t);for(o=t.search(/p/i),o>0?(d=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),c=o>=0,i=r.constructor,c&&(t=t.replace(".",""),h=t.length,o=h-o,n=un(i,new i(e),o,o*2)),g=mt(t,e,Dr),s=g.length-1,o=s;g[o]===0;--o)g.pop();return o<0?new i(r.s*0):(r.e=Ot(g,s),r.d=g,J=!1,c&&(r=tr(r,n,h*4)),d&&(r=r.times(Math.abs(d)<54?dr(2,d):st.pow(2,d))),J=!0,r)}function Io(r,t){var e,i=t.d.length;if(i<3)return t.isZero()?t:at(r,2,t,t);e=1.4*Math.sqrt(i),e=e>16?16:e|0,t=t.times(1/Tt(5,e)),t=at(r,2,t,t);for(var n,o=new r(5),c=new r(16),h=new r(20);e--;)n=t.times(t),t=t.times(o.plus(n.times(c.times(n).minus(h))));return t}function at(r,t,e,i,n){var o,c,h,d,g=r.precision,s=Math.ceil(g/W);for(J=!1,d=e.times(e),h=new r(i);;){if(c=tr(h.times(d),new r(t++*t++),g,1),h=n?i.plus(c):i.minus(c),i=tr(c.times(d),new r(t++*t++),g,1),c=h.plus(i),c.d[s]!==void 0){for(o=s;c.d[o]===h.d[o]&&o--;);if(o==-1)break}o=h,h=i,i=c,c=o}return J=!0,c.d.length=s+1,c}function Tt(r,t){for(var e=r;--t;)e*=r;return e}function ln(r,t){var e,i=t.s<0,n=Fr(r,r.precision,1),o=n.times(.5);if(t=t.abs(),t.lte(o))return Zr=i?4:1,t;if(e=t.divToInt(n),e.isZero())Zr=i?3:2;else{if(t=t.minus(e.times(n)),t.lte(o))return Zr=_e(e)?i?2:3:i?4:1,t;Zr=_e(e)?i?1:4:i?3:2}return t.minus(n).abs()}function se(r,t,e,i){var n,o,c,h,d,g,s,a,f,l=r.constructor,v=e!==void 0;if(v?(Or(e,1,Yr),i===void 0?i=l.rounding:Or(i,0,8)):(e=l.precision,i=l.rounding),!r.isFinite())s=cn(r);else{for(s=Lr(r),c=s.indexOf("."),v?(n=2,t==16?e=e*4-3:t==8&&(e=e*3-2)):n=t,c>=0&&(s=s.replace(".",""),f=new l(1),f.e=s.length-c,f.d=mt(Lr(f),10,n),f.e=f.d.length),a=mt(s,10,n),o=d=a.length;a[--d]==0;)a.pop();if(!a[0])s=v?"0p+0":"0";else{if(c<0?o--:(r=new l(r),r.d=a,r.e=o,r=tr(r,f,e,i,0,n),a=r.d,o=r.e,g=tn),c=a[e],h=n/2,g=g||a[e+1]!==void 0,g=i<4?(c!==void 0||g)&&(i===0||i===(r.s<0?3:2)):c>h||c===h&&(i===4||g||i===6&&a[e-1]&1||i===(r.s<0?8:7)),a.length=e,g)for(;++a[--e]>n-1;)a[e]=0,e||(++o,a.unshift(1));for(d=a.length;!a[d-1];--d);for(c=0,s="";c<d;c++)s+=jt.charAt(a[c]);if(v){if(d>1)if(t==16||t==8){for(c=t==16?4:3,--d;d%c;d++)s+="0";for(a=mt(s,n,t),d=a.length;!a[d-1];--d);for(c=1,s="1.";c<d;c++)s+=jt.charAt(a[c])}else s=s.charAt(0)+"."+s.slice(1);s=s+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)s="0"+s;s="0."+s}else if(++o>d)for(o-=d;o--;)s+="0";else o<d&&(s=s.slice(0,o)+"."+s.slice(o))}s=(t==16?"0x":t==2?"0b":t==8?"0o":"")+s}return r.s<0?"-"+s:s}function Ne(r,t){if(r.length>t)return r.length=t,!0}function Co(r){return new this(r).abs()}function xo(r){return new this(r).acos()}function Oo(r){return new this(r).acosh()}function To(r,t){return new this(r).plus(t)}function Po(r){return new this(r).asin()}function zo(r){return new this(r).asinh()}function Fo(r){return new this(r).atan()}function Do(r){return new this(r).atanh()}function Bo(r,t){r=new this(r),t=new this(t);var e,i=this.precision,n=this.rounding,o=i+4;return!r.s||!t.s?e=new this(NaN):!r.d&&!t.d?(e=Fr(this,o,1).times(t.s>0?.25:.75),e.s=r.s):!t.d||r.isZero()?(e=t.s<0?Fr(this,i,n):new this(0),e.s=r.s):!r.d||t.isZero()?(e=Fr(this,o,1).times(.5),e.s=r.s):t.s<0?(this.precision=o,this.rounding=1,e=this.atan(tr(r,t,o,1)),t=Fr(this,o,1),this.precision=i,this.rounding=n,e=r.s<0?e.minus(t):e.plus(t)):e=this.atan(tr(r,t,o,1)),e}function qo(r){return new this(r).cbrt()}function Ro(r){return $(r=new this(r),r.e+1,2)}function Lo(r,t,e){return new this(r).clamp(t,e)}function Uo(r){if(!r||typeof r!="object")throw Error(xt+"Object expected");var t,e,i,n=r.defaults===!0,o=["precision",1,Yr,"rounding",0,8,"toExpNeg",-nt,0,"toExpPos",0,nt,"maxE",0,nt,"minE",-nt,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(e=o[t],n&&(this[e]=Jt[e]),(i=r[e])!==void 0)if(Er(i)===i&&i>=o[t+1]&&i<=o[t+2])this[e]=i;else throw Error(Jr+e+": "+i);if(e="crypto",n&&(this[e]=Jt[e]),(i=r[e])!==void 0)if(i===!0||i===!1||i===0||i===1)if(i)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[e]=!0;else throw Error(nn);else this[e]=!1;else throw Error(Jr+e+": "+i);return this}function $o(r){return new this(r).cos()}function Zo(r){return new this(r).cosh()}function hn(r){var t,e,i;function n(o){var c,h,d,g=this;if(!(g instanceof n))return new n(o);if(g.constructor=n,Me(o)){g.s=o.s,J?!o.d||o.e>n.maxE?(g.e=NaN,g.d=null):o.e<n.minE?(g.e=0,g.d=[0]):(g.e=o.e,g.d=o.d.slice()):(g.e=o.e,g.d=o.d?o.d.slice():o.d);return}if(d=typeof o,d==="number"){if(o===0){g.s=1/o<0?-1:1,g.e=0,g.d=[0];return}if(o<0?(o=-o,g.s=-1):g.s=1,o===~~o&&o<1e7){for(c=0,h=o;h>=10;h/=10)c++;J?c>n.maxE?(g.e=NaN,g.d=null):c<n.minE?(g.e=0,g.d=[0]):(g.e=c,g.d=[o]):(g.e=c,g.d=[o]);return}else if(o*0!==0){o||(g.s=NaN),g.e=NaN,g.d=null;return}return Qt(g,o.toString())}else if(d!=="string")throw Error(Jr+o);return(h=o.charCodeAt(0))===45?(o=o.slice(1),g.s=-1):(h===43&&(o=o.slice(1)),g.s=1),an.test(o)?Qt(g,o):Ao(g,o)}if(n.prototype=P,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.EUCLID=9,n.config=n.set=Uo,n.clone=hn,n.isDecimal=Me,n.abs=Co,n.acos=xo,n.acosh=Oo,n.add=To,n.asin=Po,n.asinh=zo,n.atan=Fo,n.atanh=Do,n.atan2=Bo,n.cbrt=qo,n.ceil=Ro,n.clamp=Lo,n.cos=$o,n.cosh=Zo,n.div=Vo,n.exp=Go,n.floor=Ho,n.hypot=Wo,n.ln=jo,n.log=Jo,n.log10=Xo,n.log2=Yo,n.max=Qo,n.min=Ko,n.mod=ko,n.mul=ra,n.pow=ta,n.random=ea,n.round=na,n.sign=ia,n.sin=oa,n.sinh=aa,n.sqrt=sa,n.sub=ua,n.sum=fa,n.tan=ca,n.tanh=la,n.trunc=ha,r===void 0&&(r={}),r&&r.defaults!==!0)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<i.length;)r.hasOwnProperty(e=i[t++])||(r[e]=this[e]);return n.config(r),n}function Vo(r,t){return new this(r).div(t)}function Go(r){return new this(r).exp()}function Ho(r){return $(r=new this(r),r.e+1,3)}function Wo(){var r,t,e=new this(0);for(J=!1,r=0;r<arguments.length;)if(t=new this(arguments[r++]),t.d)e.d&&(e=e.plus(t.times(t)));else{if(t.s)return J=!0,new this(1/0);e=t}return J=!0,e.sqrt()}function Me(r){return r instanceof st||r&&r.toStringTag===on||!1}function jo(r){return new this(r).ln()}function Jo(r,t){return new this(r).log(t)}function Yo(r){return new this(r).log(2)}function Xo(r){return new this(r).log(10)}function Qo(){return fn(this,arguments,"lt")}function Ko(){return fn(this,arguments,"gt")}function ko(r,t){return new this(r).mod(t)}function ra(r,t){return new this(r).mul(t)}function ta(r,t){return new this(r).pow(t)}function ea(r){var t,e,i,n,o=0,c=new this(1),h=[];if(r===void 0?r=this.precision:Or(r,1,Yr),i=Math.ceil(r/W),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(i));o<i;)n=t[o],n>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:h[o++]=n%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(i*=4);o<i;)n=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((t[o+3]&127)<<24),n>=214e7?crypto.randomBytes(4).copy(t,o):(h.push(n%1e7),o+=4);o=i/4}else throw Error(nn);else for(;o<i;)h[o++]=Math.random()*1e7|0;for(i=h[--o],r%=W,i&&r&&(n=dr(10,W-r),h[o]=(i/n|0)*n);h[o]===0;o--)h.pop();if(o<0)e=0,h=[0];else{for(e=-1;h[0]===0;e-=W)h.shift();for(i=1,n=h[0];n>=10;n/=10)i++;i<W&&(e-=W-i)}return c.e=e,c.d=h,c}function na(r){return $(r=new this(r),r.e+1,this.rounding)}function ia(r){return r=new this(r),r.d?r.d[0]?r.s:0*r.s:r.s||NaN}function oa(r){return new this(r).sin()}function aa(r){return new this(r).sinh()}function sa(r){return new this(r).sqrt()}function ua(r,t){return new this(r).sub(t)}function fa(){var r=0,t=arguments,e=new this(t[r]);for(J=!1;e.s&&++r<t.length;)e=e.plus(t[r]);return J=!0,$(e,this.precision,this.rounding)}function ca(r){return new this(r).tan()}function la(r){return new this(r).tanh()}function ha(r){return $(r=new this(r),r.e+1,1)}P[Symbol.for("nodejs.util.inspect.custom")]=P.toString;P[Symbol.toStringTag]="Decimal";var st=P.constructor=hn(Jt);_t=new st(_t);Nt=new st(Nt);var pa="BigNumber",va=["?on","config"],da=gr(pa,va,r=>{var{on:t,config:e}=r,i=st.clone({precision:e.precision,modulo:st.EUCLID});return i.prototype=Object.create(i.prototype),i.prototype.type="BigNumber",i.prototype.isBigNumber=!0,i.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},i.fromJSON=function(n){return new i(n.value)},t&&t("config",function(n,o){n.precision!==o.precision&&i.config({precision:n.precision})}),i},{isClass:!0}),pn={exports:{}};/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(r,t){(function(e){var i=Math.cosh||function(a){return Math.abs(a)<1e-9?1-a:(Math.exp(a)+Math.exp(-a))*.5},n=Math.sinh||function(a){return Math.abs(a)<1e-9?a:(Math.exp(a)-Math.exp(-a))*.5},o=function(a){var f=Math.PI/4;if(-f>a||a>f)return Math.cos(a)-1;var l=a*a;return l*(l*(l*(l*(l*(l*(l*(l/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},c=function(a,f){var l=Math.abs(a),v=Math.abs(f);return l<3e3&&v<3e3?Math.sqrt(l*l+v*v):(l<v?(l=v,v=a/f):v=f/a,l*Math.sqrt(1+v*v))},h=function(){throw SyntaxError("Invalid Param")};function d(a,f){var l=Math.abs(a),v=Math.abs(f);return a===0?Math.log(v):f===0?Math.log(l):l<3e3&&v<3e3?Math.log(a*a+f*f)*.5:(a=a/2,f=f/2,.5*Math.log(a*a+f*f)+Math.LN2)}var g=function(a,f){var l={re:0,im:0};if(a==null)l.re=l.im=0;else if(f!==void 0)l.re=a,l.im=f;else switch(typeof a){case"object":if("im"in a&&"re"in a)l.re=a.re,l.im=a.im;else if("abs"in a&&"arg"in a){if(!Number.isFinite(a.abs)&&Number.isFinite(a.arg))return s.INFINITY;l.re=a.abs*Math.cos(a.arg),l.im=a.abs*Math.sin(a.arg)}else if("r"in a&&"phi"in a){if(!Number.isFinite(a.r)&&Number.isFinite(a.phi))return s.INFINITY;l.re=a.r*Math.cos(a.phi),l.im=a.r*Math.sin(a.phi)}else a.length===2?(l.re=a[0],l.im=a[1]):h();break;case"string":l.im=l.re=0;var v=a.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),u=1,p=0;v===null&&h();for(var m=0;m<v.length;m++){var N=v[m];N===" "||N==="	"||N===`
`||(N==="+"?u++:N==="-"?p++:N==="i"||N==="I"?(u+p===0&&h(),v[m+1]!==" "&&!isNaN(v[m+1])?(l.im+=parseFloat((p%2?"-":"")+v[m+1]),m++):l.im+=parseFloat((p%2?"-":"")+"1"),u=p=0):((u+p===0||isNaN(N))&&h(),v[m+1]==="i"||v[m+1]==="I"?(l.im+=parseFloat((p%2?"-":"")+N),m++):l.re+=parseFloat((p%2?"-":"")+N),u=p=0))}u+p>0&&h();break;case"number":l.im=0,l.re=a;break;default:h()}return isNaN(l.re)||isNaN(l.im),l};function s(a,f){if(!(this instanceof s))return new s(a,f);var l=g(a,f);this.re=l.re,this.im=l.im}s.prototype={re:0,im:0,sign:function(){var a=this.abs();return new s(this.re/a,this.im/a)},add:function(a,f){var l=new s(a,f);return this.isInfinite()&&l.isInfinite()?s.NAN:this.isInfinite()||l.isInfinite()?s.INFINITY:new s(this.re+l.re,this.im+l.im)},sub:function(a,f){var l=new s(a,f);return this.isInfinite()&&l.isInfinite()?s.NAN:this.isInfinite()||l.isInfinite()?s.INFINITY:new s(this.re-l.re,this.im-l.im)},mul:function(a,f){var l=new s(a,f);return this.isInfinite()&&l.isZero()||this.isZero()&&l.isInfinite()?s.NAN:this.isInfinite()||l.isInfinite()?s.INFINITY:l.im===0&&this.im===0?new s(this.re*l.re,0):new s(this.re*l.re-this.im*l.im,this.re*l.im+this.im*l.re)},div:function(a,f){var l=new s(a,f);if(this.isZero()&&l.isZero()||this.isInfinite()&&l.isInfinite())return s.NAN;if(this.isInfinite()||l.isZero())return s.INFINITY;if(this.isZero()||l.isInfinite())return s.ZERO;a=this.re,f=this.im;var v=l.re,u=l.im,p,m;return u===0?new s(a/v,f/v):Math.abs(v)<Math.abs(u)?(m=v/u,p=v*m+u,new s((a*m+f)/p,(f*m-a)/p)):(m=u/v,p=u*m+v,new s((a+f*m)/p,(f-a*m)/p))},pow:function(a,f){var l=new s(a,f);if(a=this.re,f=this.im,l.isZero())return s.ONE;if(l.im===0){if(f===0&&a>0)return new s(Math.pow(a,l.re),0);if(a===0)switch((l.re%4+4)%4){case 0:return new s(Math.pow(f,l.re),0);case 1:return new s(0,Math.pow(f,l.re));case 2:return new s(-Math.pow(f,l.re),0);case 3:return new s(0,-Math.pow(f,l.re))}}if(a===0&&f===0&&l.re>0&&l.im>=0)return s.ZERO;var v=Math.atan2(f,a),u=d(a,f);return a=Math.exp(l.re*u-l.im*v),f=l.im*u+l.re*v,new s(a*Math.cos(f),a*Math.sin(f))},sqrt:function(){var a=this.re,f=this.im,l=this.abs(),v,u;if(a>=0){if(f===0)return new s(Math.sqrt(a),0);v=.5*Math.sqrt(2*(l+a))}else v=Math.abs(f)/Math.sqrt(2*(l-a));return a<=0?u=.5*Math.sqrt(2*(l-a)):u=Math.abs(f)/Math.sqrt(2*(l+a)),new s(v,f<0?-u:u)},exp:function(){var a=Math.exp(this.re);return this.im,new s(a*Math.cos(this.im),a*Math.sin(this.im))},expm1:function(){var a=this.re,f=this.im;return new s(Math.expm1(a)*Math.cos(f)+o(f),Math.exp(a)*Math.sin(f))},log:function(){var a=this.re,f=this.im;return new s(d(a,f),Math.atan2(f,a))},abs:function(){return c(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var a=this.re,f=this.im;return new s(Math.sin(a)*i(f),Math.cos(a)*n(f))},cos:function(){var a=this.re,f=this.im;return new s(Math.cos(a)*i(f),-Math.sin(a)*n(f))},tan:function(){var a=2*this.re,f=2*this.im,l=Math.cos(a)+i(f);return new s(Math.sin(a)/l,n(f)/l)},cot:function(){var a=2*this.re,f=2*this.im,l=Math.cos(a)-i(f);return new s(-Math.sin(a)/l,n(f)/l)},sec:function(){var a=this.re,f=this.im,l=.5*i(2*f)+.5*Math.cos(2*a);return new s(Math.cos(a)*i(f)/l,Math.sin(a)*n(f)/l)},csc:function(){var a=this.re,f=this.im,l=.5*i(2*f)-.5*Math.cos(2*a);return new s(Math.sin(a)*i(f)/l,-Math.cos(a)*n(f)/l)},asin:function(){var a=this.re,f=this.im,l=new s(f*f-a*a+1,-2*a*f).sqrt(),v=new s(l.re-f,l.im+a).log();return new s(v.im,-v.re)},acos:function(){var a=this.re,f=this.im,l=new s(f*f-a*a+1,-2*a*f).sqrt(),v=new s(l.re-f,l.im+a).log();return new s(Math.PI/2-v.im,v.re)},atan:function(){var a=this.re,f=this.im;if(a===0){if(f===1)return new s(0,1/0);if(f===-1)return new s(0,-1/0)}var l=a*a+(1-f)*(1-f),v=new s((1-f*f-a*a)/l,-2*a/l).log();return new s(-.5*v.im,.5*v.re)},acot:function(){var a=this.re,f=this.im;if(f===0)return new s(Math.atan2(1,a),0);var l=a*a+f*f;return l!==0?new s(a/l,-f/l).atan():new s(a!==0?a/0:0,f!==0?-f/0:0).atan()},asec:function(){var a=this.re,f=this.im;if(a===0&&f===0)return new s(0,1/0);var l=a*a+f*f;return l!==0?new s(a/l,-f/l).acos():new s(a!==0?a/0:0,f!==0?-f/0:0).acos()},acsc:function(){var a=this.re,f=this.im;if(a===0&&f===0)return new s(Math.PI/2,1/0);var l=a*a+f*f;return l!==0?new s(a/l,-f/l).asin():new s(a!==0?a/0:0,f!==0?-f/0:0).asin()},sinh:function(){var a=this.re,f=this.im;return new s(n(a)*Math.cos(f),i(a)*Math.sin(f))},cosh:function(){var a=this.re,f=this.im;return new s(i(a)*Math.cos(f),n(a)*Math.sin(f))},tanh:function(){var a=2*this.re,f=2*this.im,l=i(a)+Math.cos(f);return new s(n(a)/l,Math.sin(f)/l)},coth:function(){var a=2*this.re,f=2*this.im,l=i(a)-Math.cos(f);return new s(n(a)/l,-Math.sin(f)/l)},csch:function(){var a=this.re,f=this.im,l=Math.cos(2*f)-i(2*a);return new s(-2*n(a)*Math.cos(f)/l,2*i(a)*Math.sin(f)/l)},sech:function(){var a=this.re,f=this.im,l=Math.cos(2*f)+i(2*a);return new s(2*i(a)*Math.cos(f)/l,-2*n(a)*Math.sin(f)/l)},asinh:function(){var a=this.im;this.im=-this.re,this.re=a;var f=this.asin();return this.re=-this.im,this.im=a,a=f.re,f.re=-f.im,f.im=a,f},acosh:function(){var a=this.acos();if(a.im<=0){var f=a.re;a.re=-a.im,a.im=f}else{var f=a.im;a.im=-a.re,a.re=f}return a},atanh:function(){var a=this.re,f=this.im,l=a>1&&f===0,v=1-a,u=1+a,p=v*v+f*f,m=p!==0?new s((u*v-f*f)/p,(f*v+u*f)/p):new s(a!==-1?a/0:0,f!==0?f/0:0),N=m.re;return m.re=d(m.re,m.im)/2,m.im=Math.atan2(m.im,N)/2,l&&(m.im=-m.im),m},acoth:function(){var a=this.re,f=this.im;if(a===0&&f===0)return new s(0,Math.PI/2);var l=a*a+f*f;return l!==0?new s(a/l,-f/l).atanh():new s(a!==0?a/0:0,f!==0?-f/0:0).atanh()},acsch:function(){var a=this.re,f=this.im;if(f===0)return new s(a!==0?Math.log(a+Math.sqrt(a*a+1)):1/0,0);var l=a*a+f*f;return l!==0?new s(a/l,-f/l).asinh():new s(a!==0?a/0:0,f!==0?-f/0:0).asinh()},asech:function(){var a=this.re,f=this.im;if(this.isZero())return s.INFINITY;var l=a*a+f*f;return l!==0?new s(a/l,-f/l).acosh():new s(a!==0?a/0:0,f!==0?-f/0:0).acosh()},inverse:function(){if(this.isZero())return s.INFINITY;if(this.isInfinite())return s.ZERO;var a=this.re,f=this.im,l=a*a+f*f;return new s(a/l,-f/l)},conjugate:function(){return new s(this.re,-this.im)},neg:function(){return new s(-this.re,-this.im)},ceil:function(a){return a=Math.pow(10,a||0),new s(Math.ceil(this.re*a)/a,Math.ceil(this.im*a)/a)},floor:function(a){return a=Math.pow(10,a||0),new s(Math.floor(this.re*a)/a,Math.floor(this.im*a)/a)},round:function(a){return a=Math.pow(10,a||0),new s(Math.round(this.re*a)/a,Math.round(this.im*a)/a)},equals:function(a,f){var l=new s(a,f);return Math.abs(l.re-this.re)<=s.EPSILON&&Math.abs(l.im-this.im)<=s.EPSILON},clone:function(){return new s(this.re,this.im)},toString:function(){var a=this.re,f=this.im,l="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(a)<s.EPSILON&&(a=0),Math.abs(f)<s.EPSILON&&(f=0),f===0?l+a:(a!==0?(l+=a,l+=" ",f<0?(f=-f,l+="-"):l+="+",l+=" "):f<0&&(f=-f,l+="-"),f!==1&&(l+=f),l+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},s.ZERO=new s(0,0),s.ONE=new s(1,0),s.I=new s(0,1),s.PI=new s(Math.PI,0),s.E=new s(Math.E,0),s.INFINITY=new s(1/0,1/0),s.NAN=new s(NaN,NaN),s.EPSILON=1e-15,Object.defineProperty(s,"__esModule",{value:!0}),s.default=s,s.Complex=s,r.exports=s})()})(pn);var ma=pn.exports;const Cr=ee(ma);var ga="Complex",wa=[],ya=gr(ga,wa,()=>(Cr.prototype.type="Complex",Cr.prototype.isComplex=!0,Cr.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Cr.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Cr.prototype.format=function(r){var t="",e=this.im,i=this.re,n=Ht(this.re,r),o=Ht(this.im,r),c=fr(r)?r:r?r.precision:null;if(c!==null){var h=Math.pow(10,-c);Math.abs(i/e)<h&&(i=0),Math.abs(e/i)<h&&(e=0)}return e===0?t=n:i===0?e===1?t="i":e===-1?t="-i":t=o+"i":e<0?e===-1?t=n+" - i":t=n+" - "+o.substring(1)+"i":e===1?t=n+" + i":t=n+" + "+o+"i",t},Cr.fromPolar=function(r){switch(arguments.length){case 1:{var t=arguments[0];if(typeof t=="object")return Cr(t);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var e=arguments[0],i=arguments[1];if(fr(e)){if(oe(i)&&i.hasBase("ANGLE")&&(i=i.toNumber("rad")),fr(i))return new Cr({r:e,phi:i});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Cr.prototype.valueOf=Cr.prototype.toString,Cr.fromJSON=function(r){return new Cr(r)},Cr.compare=function(r,t){return r.re>t.re?1:r.re<t.re?-1:r.im>t.im?1:r.im<t.im?-1:0},Cr),{isClass:!0}),vn={exports:{}};/**
 * @license Fraction.js v4.2.0 05/03/2022
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(r,t){(function(e){var i=2e3,n={s:1,n:0,d:1};function o(v,u){if(isNaN(v=parseInt(v,10)))throw l.InvalidParameter;return v*u}function c(v,u){if(u===0)throw l.DivisionByZero;var p=Object.create(l.prototype);p.s=v<0?-1:1,v=v<0?-v:v;var m=f(v,u);return p.n=v/m,p.d=u/m,p}function h(v){for(var u={},p=v,m=2,N=4;N<=p;){for(;p%m===0;)p/=m,u[m]=(u[m]||0)+1;N+=1+2*m++}return p!==v?p>1&&(u[p]=(u[p]||0)+1):u[v]=(u[v]||0)+1,u}var d=function(v,u){var p=0,m=1,N=1,w=0,S=0,M=0,E=1,A=1,y=0,b=1,x=1,T=1,F=1e7,D;if(v!=null)if(u!==void 0){if(p=v,m=u,N=p*m,p%1!==0||m%1!==0)throw l.NonIntegerParameter}else switch(typeof v){case"object":{if("d"in v&&"n"in v)p=v.n,m=v.d,"s"in v&&(p*=v.s);else if(0 in v)p=v[0],1 in v&&(m=v[1]);else throw l.InvalidParameter;N=p*m;break}case"number":{if(v<0&&(N=v,v=-v),v%1===0)p=v;else if(v>0){for(v>=1&&(A=Math.pow(10,Math.floor(1+Math.log(v)/Math.LN10)),v/=A);b<=F&&T<=F;)if(D=(y+x)/(b+T),v===D){b+T<=F?(p=y+x,m=b+T):T>b?(p=x,m=T):(p=y,m=b);break}else v>D?(y+=x,b+=T):(x+=y,T+=b),b>F?(p=x,m=T):(p=y,m=b);p*=A}else(isNaN(v)||isNaN(u))&&(m=p=NaN);break}case"string":{if(b=v.match(/\d+|./g),b===null)throw l.InvalidParameter;if(b[y]==="-"?(N=-1,y++):b[y]==="+"&&y++,b.length===y+1?S=o(b[y++],N):b[y+1]==="."||b[y]==="."?(b[y]!=="."&&(w=o(b[y++],N)),y++,(y+1===b.length||b[y+1]==="("&&b[y+3]===")"||b[y+1]==="'"&&b[y+3]==="'")&&(S=o(b[y],N),E=Math.pow(10,b[y].length),y++),(b[y]==="("&&b[y+2]===")"||b[y]==="'"&&b[y+2]==="'")&&(M=o(b[y+1],N),A=Math.pow(10,b[y+1].length)-1,y+=3)):b[y+1]==="/"||b[y+1]===":"?(S=o(b[y],N),E=o(b[y+2],1),y+=3):b[y+3]==="/"&&b[y+1]===" "&&(w=o(b[y],N),S=o(b[y+2],N),E=o(b[y+4],1),y+=5),b.length<=y){m=E*A,N=p=M+m*w+A*S;break}}default:throw l.InvalidParameter}if(m===0)throw l.DivisionByZero;n.s=N<0?-1:1,n.n=Math.abs(p),n.d=Math.abs(m)};function g(v,u,p){for(var m=1;u>0;v=v*v%p,u>>=1)u&1&&(m=m*v%p);return m}function s(v,u){for(;u%2===0;u/=2);for(;u%5===0;u/=5);if(u===1)return 0;for(var p=10%u,m=1;p!==1;m++)if(p=p*10%u,m>i)return 0;return m}function a(v,u,p){for(var m=1,N=g(10,p,u),w=0;w<300;w++){if(m===N)return w;m=m*10%u,N=N*10%u}return 0}function f(v,u){if(!v)return u;if(!u)return v;for(;;){if(v%=u,!v)return u;if(u%=v,!u)return v}}function l(v,u){if(d(v,u),this instanceof l)v=f(n.d,n.n),this.s=n.s,this.n=n.n/v,this.d=n.d/v;else return c(n.s*n.n,n.d)}l.DivisionByZero=new Error("Division by Zero"),l.InvalidParameter=new Error("Invalid argument"),l.NonIntegerParameter=new Error("Parameters must be integer"),l.prototype={s:1,n:0,d:1,abs:function(){return c(this.n,this.d)},neg:function(){return c(-this.s*this.n,this.d)},add:function(v,u){return d(v,u),c(this.s*this.n*n.d+n.s*this.d*n.n,this.d*n.d)},sub:function(v,u){return d(v,u),c(this.s*this.n*n.d-n.s*this.d*n.n,this.d*n.d)},mul:function(v,u){return d(v,u),c(this.s*n.s*this.n*n.n,this.d*n.d)},div:function(v,u){return d(v,u),c(this.s*n.s*this.n*n.d,this.d*n.n)},clone:function(){return c(this.s*this.n,this.d)},mod:function(v,u){if(isNaN(this.n)||isNaN(this.d))return new l(NaN);if(v===void 0)return c(this.s*this.n%this.d,1);if(d(v,u),n.n===0&&this.d===0)throw l.DivisionByZero;return c(this.s*(n.d*this.n)%(n.n*this.d),n.d*this.d)},gcd:function(v,u){return d(v,u),c(f(n.n,this.n)*f(n.d,this.d),n.d*this.d)},lcm:function(v,u){return d(v,u),n.n===0&&this.n===0?c(0,1):c(n.n*this.n,f(n.n,this.n)*f(n.d,this.d))},ceil:function(v){return v=Math.pow(10,v||0),isNaN(this.n)||isNaN(this.d)?new l(NaN):c(Math.ceil(v*this.s*this.n/this.d),v)},floor:function(v){return v=Math.pow(10,v||0),isNaN(this.n)||isNaN(this.d)?new l(NaN):c(Math.floor(v*this.s*this.n/this.d),v)},round:function(v){return v=Math.pow(10,v||0),isNaN(this.n)||isNaN(this.d)?new l(NaN):c(Math.round(v*this.s*this.n/this.d),v)},inverse:function(){return c(this.s*this.d,this.n)},pow:function(v,u){if(d(v,u),n.d===1)return n.s<0?c(Math.pow(this.s*this.d,n.n),Math.pow(this.n,n.n)):c(Math.pow(this.s*this.n,n.n),Math.pow(this.d,n.n));if(this.s<0)return null;var p=h(this.n),m=h(this.d),N=1,w=1;for(var S in p)if(S!=="1"){if(S==="0"){N=0;break}if(p[S]*=n.n,p[S]%n.d===0)p[S]/=n.d;else return null;N*=Math.pow(S,p[S])}for(var S in m)if(S!=="1"){if(m[S]*=n.n,m[S]%n.d===0)m[S]/=n.d;else return null;w*=Math.pow(S,m[S])}return n.s<0?c(w,N):c(N,w)},equals:function(v,u){return d(v,u),this.s*this.n*n.d===n.s*n.n*this.d},compare:function(v,u){d(v,u);var p=this.s*this.n*n.d-n.s*n.n*this.d;return(0<p)-(p<0)},simplify:function(v){if(isNaN(this.n)||isNaN(this.d))return this;v=v||.001;for(var u=this.abs(),p=u.toContinued(),m=1;m<p.length;m++){for(var N=c(p[m-1],1),w=m-2;w>=0;w--)N=N.inverse().add(p[w]);if(N.sub(u).abs().valueOf()<v)return N.mul(this.s)}return this},divisible:function(v,u){return d(v,u),!(!(n.n*this.d)||this.n*n.d%(n.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(v){var u,p="",m=this.n,N=this.d;return this.s<0&&(p+="-"),N===1?p+=m:(v&&(u=Math.floor(m/N))>0&&(p+=u,p+=" ",m%=N),p+=m,p+="/",p+=N),p},toLatex:function(v){var u,p="",m=this.n,N=this.d;return this.s<0&&(p+="-"),N===1?p+=m:(v&&(u=Math.floor(m/N))>0&&(p+=u,m%=N),p+="\\frac{",p+=m,p+="}{",p+=N,p+="}"),p},toContinued:function(){var v,u=this.n,p=this.d,m=[];if(isNaN(u)||isNaN(p))return m;do m.push(Math.floor(u/p)),v=u%p,u=p,p=v;while(u!==1);return m},toString:function(v){var u=this.n,p=this.d;if(isNaN(u)||isNaN(p))return"NaN";v=v||15;var m=s(u,p),N=a(u,p,m),w=this.s<0?"-":"";if(w+=u/p|0,u%=p,u*=10,u&&(w+="."),m){for(var S=N;S--;)w+=u/p|0,u%=p,u*=10;w+="(";for(var S=m;S--;)w+=u/p|0,u%=p,u*=10;w+=")"}else for(var S=v;u&&S--;)w+=u/p|0,u%=p,u*=10;return w}},Object.defineProperty(l,"__esModule",{value:!0}),l.default=l,l.Fraction=l,r.exports=l})()})(vn);var _a=vn.exports;const tt=ee(_a);var Na="Fraction",Ma=[],Ea=gr(Na,Ma,()=>(tt.prototype.type="Fraction",tt.prototype.isFraction=!0,tt.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},tt.fromJSON=function(r){return new tt(r)},tt),{isClass:!0}),ba="Matrix",Sa=[],Aa=gr(ba,Sa,()=>{function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator")}return r.prototype.type="Matrix",r.prototype.isMatrix=!0,r.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},r.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},r.prototype.create=function(t,e){throw new Error("Cannot invoke create on a Matrix interface")},r.prototype.subset=function(t,e,i){throw new Error("Cannot invoke subset on a Matrix interface")},r.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},r.prototype.set=function(t,e,i){throw new Error("Cannot invoke set on a Matrix interface")},r.prototype.resize=function(t,e){throw new Error("Cannot invoke resize on a Matrix interface")},r.prototype.reshape=function(t,e){throw new Error("Cannot invoke reshape on a Matrix interface")},r.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},r.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},r.prototype.map=function(t,e){throw new Error("Cannot invoke map on a Matrix interface")},r.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},r.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},r.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},r.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},r.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},r.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},r},{isClass:!0}),Ia="DenseMatrix",Ca=["Matrix"],xa=gr(Ia,Ca,r=>{var{Matrix:t}=r;function e(s,a){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");if(a&&!$r(a))throw new Error("Invalid datatype: "+a);if(Sr(s))s.type==="DenseMatrix"?(this._data=yr(s._data),this._size=yr(s._size),this._datatype=a||s._datatype):(this._data=s.toArray(),this._size=s.size(),this._datatype=a||s._datatype);else if(s&&ar(s.data)&&ar(s.size))this._data=s.data,this._size=s.size,we(this._data,this._size),this._datatype=a||s.datatype;else if(ar(s))this._data=g(s),this._size=kr(this._data),we(this._data,this._size),this._datatype=a;else{if(s)throw new TypeError("Unsupported type of data ("+lt(s)+")");this._data=[],this._size=[0],this._datatype=a}}e.prototype=new t,e.prototype.createDenseMatrix=function(s,a){return new e(s,a)},e.prototype.type="DenseMatrix",e.prototype.isDenseMatrix=!0,e.prototype.getDataType=function(){return yt(this._data,lt)},e.prototype.storage=function(){return"dense"},e.prototype.datatype=function(){return this._datatype},e.prototype.create=function(s,a){return new e(s,a)},e.prototype.subset=function(s,a,f){switch(arguments.length){case 1:return i(this,s);case 2:case 3:return o(this,s,a,f);default:throw new SyntaxError("Wrong number of arguments")}},e.prototype.get=function(s){if(!ar(s))throw new TypeError("Array expected");if(s.length!==this._size.length)throw new sr(s.length,this._size.length);for(var a=0;a<s.length;a++)vr(s[a],this._size[a]);for(var f=this._data,l=0,v=s.length;l<v;l++){var u=s[l];vr(u,f.length),f=f[u]}return f},e.prototype.set=function(s,a,f){if(!ar(s))throw new TypeError("Array expected");if(s.length<this._size.length)throw new sr(s.length,this._size.length,"<");var l,v,u,p=s.map(function(N){return N+1});d(this,p,f);var m=this._data;for(l=0,v=s.length-1;l<v;l++)u=s[l],vr(u,m.length),m=m[u];return u=s[s.length-1],vr(u,m.length),m[u]=a,this};function i(s,a){if(!St(a))throw new TypeError("Invalid index");var f=a.isScalar();if(f)return s.get(a.min());var l=a.size();if(l.length!==s._size.length)throw new sr(l.length,s._size.length);for(var v=a.min(),u=a.max(),p=0,m=s._size.length;p<m;p++)vr(v[p],s._size[p]),vr(u[p],s._size[p]);return new e(n(s._data,a,l.length,0),s._datatype)}function n(s,a,f,l){var v=l===f-1,u=a.dimension(l);return v?u.map(function(p){return vr(p,s.length),s[p]}).valueOf():u.map(function(p){vr(p,s.length);var m=s[p];return n(m,a,f,l+1)}).valueOf()}function o(s,a,f,l){if(!a||a.isIndex!==!0)throw new TypeError("Invalid index");var v=a.size(),u=a.isScalar(),p;if(Sr(f)?(p=f.size(),f=f.valueOf()):p=kr(f),u){if(p.length!==0)throw new TypeError("Scalar expected");s.set(a.min(),f,l)}else{if(v.length<s._size.length)throw new sr(v.length,s._size.length,"<");if(p.length<v.length){for(var m=0,N=0;v[m]===1&&p[m]===1;)m++;for(;v[m]===1;)N++,m++;f=Xe(f,v.length,N,p)}if(!gt(v,p))throw new sr(v,p,">");var w=a.max().map(function(E){return E+1});d(s,w,l);var S=v.length,M=0;c(s._data,a,f,S,M)}return s}function c(s,a,f,l,v){var u=v===l-1,p=a.dimension(v);u?p.forEach(function(m,N){vr(m),s[m]=f[N[0]]}):p.forEach(function(m,N){vr(m),c(s[m],a,f[N[0]],l,v+1)})}e.prototype.resize=function(s,a,f){if(!Le(s))throw new TypeError("Array or Matrix expected");var l=s.valueOf().map(u=>Array.isArray(u)&&u.length===1?u[0]:u),v=f?this.clone():this;return h(v,l,a)};function h(s,a,f){if(a.length===0){for(var l=s._data;ar(l);)l=l[0];return l}return s._size=a.slice(0),s._data=ye(s._data,s._size,f),s}e.prototype.reshape=function(s,a){var f=a?this.clone():this;f._data=eo(f._data,s);var l=f._size.reduce((v,u)=>v*u);return f._size=ae(s,l),f};function d(s,a,f){for(var l=s._size.slice(0),v=!1;l.length<a.length;)l.push(0),v=!0;for(var u=0,p=a.length;u<p;u++)a[u]>l[u]&&(l[u]=a[u],v=!0);v&&h(s,l,f)}e.prototype.clone=function(){var s=new e({data:yr(this._data),size:yr(this._size),datatype:this._datatype});return s},e.prototype.size=function(){return this._size.slice(0)},e.prototype.map=function(s){var a=this,f=function u(p,m){return ar(p)?p.map(function(N,w){return u(N,m.concat(w))}):s(p,m,a)},l=f(this._data,[]),v=this._datatype!==void 0?yt(l,lt):void 0;return new e(l,v)},e.prototype.forEach=function(s){var a=this,f=function l(v,u){ar(v)?v.forEach(function(p,m){l(p,u.concat(m))}):s(v,u,a)};f(this._data,[])},e.prototype[Symbol.iterator]=function*(){var s=function*a(f,l){if(ar(f))for(var v=0;v<f.length;v++)yield*a(f[v],l.concat(v));else yield{value:f,index:l}};yield*s(this._data,[])},e.prototype.rows=function(){var s=[],a=this.size();if(a.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");var f=this._data;for(var l of f)s.push(new e([l],this._datatype));return s},e.prototype.columns=function(){var s=this,a=[],f=this.size();if(f.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var l=this._data,v=function(m){var N=l.map(w=>[w[m]]);a.push(new e(N,s._datatype))},u=0;u<f[1];u++)v(u);return a},e.prototype.toArray=function(){return yr(this._data)},e.prototype.valueOf=function(){return this._data},e.prototype.format=function(s){return xr(this._data,s)},e.prototype.toString=function(){return xr(this._data)},e.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},e.prototype.diagonal=function(s){if(s){if(zr(s)&&(s=s.toNumber()),!fr(s)||!_r(s))throw new TypeError("The parameter k must be an integer number")}else s=0;for(var a=s>0?s:0,f=s<0?-s:0,l=this._size[0],v=this._size[1],u=Math.min(l-f,v-a),p=[],m=0;m<u;m++)p[m]=this._data[m+f][m+a];return new e({data:p,size:[u],datatype:this._datatype})},e.diagonal=function(s,a,f,l){if(!ar(s))throw new TypeError("Array expected, size parameter");if(s.length!==2)throw new Error("Only two dimensions matrix are supported");if(s=s.map(function(A){if(zr(A)&&(A=A.toNumber()),!fr(A)||!_r(A)||A<1)throw new Error("Size values must be positive integers");return A}),f){if(zr(f)&&(f=f.toNumber()),!fr(f)||!_r(f))throw new TypeError("The parameter k must be an integer number")}else f=0;var v=f>0?f:0,u=f<0?-f:0,p=s[0],m=s[1],N=Math.min(p-u,m-v),w;if(ar(a)){if(a.length!==N)throw new Error("Invalid value array length");w=function(y){return a[y]}}else if(Sr(a)){var S=a.size();if(S.length!==1||S[0]!==N)throw new Error("Invalid matrix length");w=function(y){return a.get([y])}}else w=function(){return a};l||(l=zr(w(0))?w(0).mul(0):0);var M=[];if(s.length>0){M=ye(M,s,l);for(var E=0;E<N;E++)M[E+u][E+v]=w(E)}return new e({data:M,size:[p,m]})},e.fromJSON=function(s){return new e(s)},e.prototype.swapRows=function(s,a){if(!fr(s)||!_r(s)||!fr(a)||!_r(a))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return vr(s,this._size[0]),vr(a,this._size[0]),e._swapRows(s,a,this._data),this},e._swapRows=function(s,a,f){var l=f[s];f[s]=f[a],f[a]=l};function g(s){for(var a=0,f=s.length;a<f;a++){var l=s[a];ar(l)?s[a]=g(l):l&&l.isMatrix===!0&&(s[a]=g(l.valueOf()))}return s}return e},{isClass:!0});function dn(r,t,e){return r&&typeof r.map=="function"?r.map(function(i){return dn(i,t)}):t(r)}var mn="number, number";function gn(r,t){return r+t}gn.signature=mn;function wn(r,t){return r*t}wn.signature=mn;function Oa(r,t,e){if(e==null)return r.eq(t);if(r.eq(t))return!0;if(r.isNaN()||t.isNaN())return!1;if(r.isFinite()&&t.isFinite()){var i=r.minus(t).abs();if(i.isZero())return!0;var n=r.constructor.max(r.abs(),t.abs());return i.lte(n.times(e))}return!1}function Ta(r,t,e){return wt(r.re,t.re,e)&&wt(r.im,t.im,e)}var Et="equalScalar",Pa=["typed","config"],za=gr(Et,Pa,r=>{var{typed:t,config:e}=r;return t(Et,{"boolean, boolean":function(n,o){return n===o},"number, number":function(n,o){return wt(n,o,e.epsilon)},"BigNumber, BigNumber":function(n,o){return n.eq(o)||Oa(n,o,e.epsilon)},"Fraction, Fraction":function(n,o){return n.equals(o)},"Complex, Complex":function(n,o){return Ta(n,o,e.epsilon)},"Unit, Unit":function(n,o){if(!n.equalBase(o))throw new Error("Cannot compare units with different base");return this(n.value,o.value)}})});gr(Et,["typed","config"],r=>{var{typed:t,config:e}=r;return t(Et,{"number, number":function(n,o){return wt(n,o,e.epsilon)}})});var Fa="SparseMatrix",Da=["typed","equalScalar","Matrix"],Ba=gr(Fa,Da,r=>{var{typed:t,equalScalar:e,Matrix:i}=r;function n(u,p){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(p&&!$r(p))throw new Error("Invalid datatype: "+p);if(Sr(u))o(this,u,p);else if(u&&ar(u.index)&&ar(u.ptr)&&ar(u.size))this._values=u.values,this._index=u.index,this._ptr=u.ptr,this._size=u.size,this._datatype=p||u.datatype;else if(ar(u))c(this,u,p);else{if(u)throw new TypeError("Unsupported type of data ("+lt(u)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=p}}function o(u,p,m){p.type==="SparseMatrix"?(u._values=p._values?yr(p._values):void 0,u._index=yr(p._index),u._ptr=yr(p._ptr),u._size=yr(p._size),u._datatype=m||p._datatype):c(u,p.valueOf(),m||p._datatype)}function c(u,p,m){u._values=[],u._index=[],u._ptr=[],u._datatype=m;var N=p.length,w=0,S=e,M=0;if($r(m)&&(S=t.find(e,[m,m])||e,M=t.convert(0,m)),N>0){var E=0;do{u._ptr.push(u._index.length);for(var A=0;A<N;A++){var y=p[A];if(ar(y)){if(E===0&&w<y.length&&(w=y.length),E<y.length){var b=y[E];S(b,M)||(u._values.push(b),u._index.push(A))}}else E===0&&w<1&&(w=1),S(y,M)||(u._values.push(y),u._index.push(A))}E++}while(E<w)}u._ptr.push(u._index.length),u._size=[N,w]}n.prototype=new i,n.prototype.createSparseMatrix=function(u,p){return new n(u,p)},n.prototype.type="SparseMatrix",n.prototype.isSparseMatrix=!0,n.prototype.getDataType=function(){return yt(this._values,lt)},n.prototype.storage=function(){return"sparse"},n.prototype.datatype=function(){return this._datatype},n.prototype.create=function(u,p){return new n(u,p)},n.prototype.density=function(){var u=this._size[0],p=this._size[1];return u!==0&&p!==0?this._index.length/(u*p):0},n.prototype.subset=function(u,p,m){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return h(this,u);case 2:case 3:return d(this,u,p,m);default:throw new SyntaxError("Wrong number of arguments")}};function h(u,p){if(!St(p))throw new TypeError("Invalid index");var m=p.isScalar();if(m)return u.get(p.min());var N=p.size();if(N.length!==u._size.length)throw new sr(N.length,u._size.length);var w,S,M,E,A=p.min(),y=p.max();for(w=0,S=u._size.length;w<S;w++)vr(A[w],u._size[w]),vr(y[w],u._size[w]);var b=u._values,x=u._index,T=u._ptr,F=p.dimension(0),D=p.dimension(1),L=[],B=[];F.forEach(function(V,Y){B[V]=Y[0],L[V]=!0});var z=b?[]:void 0,G=[],Z=[];return D.forEach(function(V){for(Z.push(G.length),M=T[V],E=T[V+1];M<E;M++)w=x[M],L[w]===!0&&(G.push(B[w]),z&&z.push(b[M]))}),Z.push(G.length),new n({values:z,index:G,ptr:Z,size:N,datatype:u._datatype})}function d(u,p,m,N){if(!p||p.isIndex!==!0)throw new TypeError("Invalid index");var w=p.size(),S=p.isScalar(),M;if(Sr(m)?(M=m.size(),m=m.toArray()):M=kr(m),S){if(M.length!==0)throw new TypeError("Scalar expected");u.set(p.min(),m,N)}else{if(w.length!==1&&w.length!==2)throw new sr(w.length,u._size.length,"<");if(M.length<w.length){for(var E=0,A=0;w[E]===1&&M[E]===1;)E++;for(;w[E]===1;)A++,E++;m=Xe(m,w.length,A,M)}if(!gt(w,M))throw new sr(w,M,">");for(var y=p.min()[0],b=p.min()[1],x=M[0],T=M[1],F=0;F<x;F++)for(var D=0;D<T;D++){var L=m[F][D];u.set([F+y,D+b],L,N)}}return u}n.prototype.get=function(u){if(!ar(u))throw new TypeError("Array expected");if(u.length!==this._size.length)throw new sr(u.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var p=u[0],m=u[1];vr(p,this._size[0]),vr(m,this._size[1]);var N=g(p,this._ptr[m],this._ptr[m+1],this._index);return N<this._ptr[m+1]&&this._index[N]===p?this._values[N]:0},n.prototype.set=function(u,p,m){if(!ar(u))throw new TypeError("Array expected");if(u.length!==this._size.length)throw new sr(u.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var N=u[0],w=u[1],S=this._size[0],M=this._size[1],E=e,A=0;$r(this._datatype)&&(E=t.find(e,[this._datatype,this._datatype])||e,A=t.convert(0,this._datatype)),(N>S-1||w>M-1)&&(f(this,Math.max(N+1,S),Math.max(w+1,M),m),S=this._size[0],M=this._size[1]),vr(N,S),vr(w,M);var y=g(N,this._ptr[w],this._ptr[w+1],this._index);return y<this._ptr[w+1]&&this._index[y]===N?E(p,A)?s(y,w,this._values,this._index,this._ptr):this._values[y]=p:a(y,N,w,p,this._values,this._index,this._ptr),this};function g(u,p,m,N){if(m-p===0)return m;for(var w=p;w<m;w++)if(N[w]===u)return w;return p}function s(u,p,m,N,w){m.splice(u,1),N.splice(u,1);for(var S=p+1;S<w.length;S++)w[S]--}function a(u,p,m,N,w,S,M){w.splice(u,0,N),S.splice(u,0,p);for(var E=m+1;E<M.length;E++)M[E]++}n.prototype.resize=function(u,p,m){if(!Le(u))throw new TypeError("Array or Matrix expected");var N=u.valueOf().map(S=>Array.isArray(S)&&S.length===1?S[0]:S);if(N.length!==2)throw new Error("Only two dimensions matrix are supported");N.forEach(function(S){if(!fr(S)||!_r(S)||S<0)throw new TypeError("Invalid size, must contain positive integers (size: "+xr(N)+")")});var w=m?this.clone():this;return f(w,N[0],N[1],p)};function f(u,p,m,N){var w=N||0,S=e,M=0;$r(u._datatype)&&(S=t.find(e,[u._datatype,u._datatype])||e,M=t.convert(0,u._datatype),w=t.convert(w,u._datatype));var E=!S(w,M),A=u._size[0],y=u._size[1],b,x,T;if(m>y){for(x=y;x<m;x++)if(u._ptr[x]=u._values.length,E)for(b=0;b<A;b++)u._values.push(w),u._index.push(b);u._ptr[m]=u._values.length}else m<y&&(u._ptr.splice(m+1,y-m),u._values.splice(u._ptr[m],u._values.length),u._index.splice(u._ptr[m],u._index.length));if(y=m,p>A){if(E){var F=0;for(x=0;x<y;x++){u._ptr[x]=u._ptr[x]+F,T=u._ptr[x+1]+F;var D=0;for(b=A;b<p;b++,D++)u._values.splice(T+D,0,w),u._index.splice(T+D,0,b),F++}u._ptr[y]=u._values.length}}else if(p<A){var L=0;for(x=0;x<y;x++){u._ptr[x]=u._ptr[x]-L;var B=u._ptr[x],z=u._ptr[x+1]-L;for(T=B;T<z;T++)b=u._index[T],b>p-1&&(u._values.splice(T,1),u._index.splice(T,1),L++)}u._ptr[x]=u._values.length}return u._size[0]=p,u._size[1]=m,u}n.prototype.reshape=function(u,p){if(!ar(u))throw new TypeError("Array expected");if(u.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");u.forEach(function(V){if(!fr(V)||!_r(V)||V<=-2||V===0)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+xr(u)+")")});var m=this._size[0]*this._size[1];u=ae(u,m);var N=u[0]*u[1];if(m!==N)throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var w=p?this.clone():this;if(this._size[0]===u[0]&&this._size[1]===u[1])return w;for(var S=[],M=0;M<w._ptr.length;M++)for(var E=0;E<w._ptr[M+1]-w._ptr[M];E++)S.push(M);for(var A=w._values.slice(),y=w._index.slice(),b=0;b<w._index.length;b++){var x=y[b],T=S[b],F=x*w._size[1]+T;S[b]=F%u[1],y[b]=Math.floor(F/u[1])}w._values.length=0,w._index.length=0,w._ptr.length=u[1]+1,w._size=u.slice();for(var D=0;D<w._ptr.length;D++)w._ptr[D]=0;for(var L=0;L<A.length;L++){var B=y[L],z=S[L],G=A[L],Z=g(B,w._ptr[z],w._ptr[z+1],w._index);a(Z,B,z,G,w._values,w._index,w._ptr)}return w},n.prototype.clone=function(){var u=new n({values:this._values?yr(this._values):void 0,index:yr(this._index),ptr:yr(this._ptr),size:yr(this._size),datatype:this._datatype});return u},n.prototype.size=function(){return this._size.slice(0)},n.prototype.map=function(u,p){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var m=this,N=this._size[0],w=this._size[1],S=function(E,A,y){return u(E,[A,y],m)};return l(this,0,N-1,0,w-1,S,p)};function l(u,p,m,N,w,S,M){var E=[],A=[],y=[],b=e,x=0;$r(u._datatype)&&(b=t.find(e,[u._datatype,u._datatype])||e,x=t.convert(0,u._datatype));for(var T=function(K,cr,lr){K=S(K,cr,lr),b(K,x)||(E.push(K),A.push(cr))},F=N;F<=w;F++){y.push(E.length);var D=u._ptr[F],L=u._ptr[F+1];if(M)for(var B=D;B<L;B++){var z=u._index[B];z>=p&&z<=m&&T(u._values[B],z-p,F-N)}else{for(var G={},Z=D;Z<L;Z++){var V=u._index[Z];G[V]=u._values[Z]}for(var Y=p;Y<=m;Y++){var k=Y in G?G[Y]:0;T(k,Y-p,F-N)}}}return y.push(E.length),new n({values:E,index:A,ptr:y,size:[m-p+1,w-N+1]})}n.prototype.forEach=function(u,p){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var m=this,N=this._size[0],w=this._size[1],S=0;S<w;S++){var M=this._ptr[S],E=this._ptr[S+1];if(p)for(var A=M;A<E;A++){var y=this._index[A];u(this._values[A],[y,S],m)}else{for(var b={},x=M;x<E;x++){var T=this._index[x];b[T]=this._values[x]}for(var F=0;F<N;F++){var D=F in b?b[F]:0;u(D,[F,S],m)}}}},n.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var u=this._size[1],p=0;p<u;p++)for(var m=this._ptr[p],N=this._ptr[p+1],w=m;w<N;w++){var S=this._index[w];yield{value:this._values[w],index:[S,p]}}},n.prototype.toArray=function(){return v(this._values,this._index,this._ptr,this._size,!0)},n.prototype.valueOf=function(){return v(this._values,this._index,this._ptr,this._size,!1)};function v(u,p,m,N,w){var S=N[0],M=N[1],E=[],A,y;for(A=0;A<S;A++)for(E[A]=[],y=0;y<M;y++)E[A][y]=0;for(y=0;y<M;y++)for(var b=m[y],x=m[y+1],T=b;T<x;T++)A=p[T],E[A][y]=u?w?yr(u[T]):u[T]:1;return E}return n.prototype.format=function(u){for(var p=this._size[0],m=this._size[1],N=this.density(),w="Sparse Matrix ["+xr(p,u)+" x "+xr(m,u)+"] density: "+xr(N,u)+`
`,S=0;S<m;S++)for(var M=this._ptr[S],E=this._ptr[S+1],A=M;A<E;A++){var y=this._index[A];w+=`
    (`+xr(y,u)+", "+xr(S,u)+") ==> "+(this._values?xr(this._values[A],u):"X")}return w},n.prototype.toString=function(){return xr(this.toArray())},n.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},n.prototype.diagonal=function(u){if(u){if(zr(u)&&(u=u.toNumber()),!fr(u)||!_r(u))throw new TypeError("The parameter k must be an integer number")}else u=0;var p=u>0?u:0,m=u<0?-u:0,N=this._size[0],w=this._size[1],S=Math.min(N-m,w-p),M=[],E=[],A=[];A[0]=0;for(var y=p;y<w&&M.length<S;y++)for(var b=this._ptr[y],x=this._ptr[y+1],T=b;T<x;T++){var F=this._index[T];if(F===y-p+m){M.push(this._values[T]),E[M.length-1]=F-m;break}}return A.push(M.length),new n({values:M,index:E,ptr:A,size:[S,1]})},n.fromJSON=function(u){return new n(u)},n.diagonal=function(u,p,m,N,w){if(!ar(u))throw new TypeError("Array expected, size parameter");if(u.length!==2)throw new Error("Only two dimensions matrix are supported");if(u=u.map(function(V){if(zr(V)&&(V=V.toNumber()),!fr(V)||!_r(V)||V<1)throw new Error("Size values must be positive integers");return V}),m){if(zr(m)&&(m=m.toNumber()),!fr(m)||!_r(m))throw new TypeError("The parameter k must be an integer number")}else m=0;var S=e,M=0;$r(w)&&(S=t.find(e,[w,w])||e,M=t.convert(0,w));var E=m>0?m:0,A=m<0?-m:0,y=u[0],b=u[1],x=Math.min(y-A,b-E),T;if(ar(p)){if(p.length!==x)throw new Error("Invalid value array length");T=function(Y){return p[Y]}}else if(Sr(p)){var F=p.size();if(F.length!==1||F[0]!==x)throw new Error("Invalid matrix length");T=function(Y){return p.get([Y])}}else T=function(){return p};for(var D=[],L=[],B=[],z=0;z<b;z++){B.push(D.length);var G=z-E;if(G>=0&&G<x){var Z=T(G);S(Z,M)||(L.push(G+A),D.push(Z))}}return B.push(D.length),new n({values:D,index:L,ptr:B,size:[y,b]})},n.prototype.swapRows=function(u,p){if(!fr(u)||!_r(u)||!fr(p)||!_r(p))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return vr(u,this._size[0]),vr(p,this._size[0]),n._swapRows(u,p,this._size[1],this._values,this._index,this._ptr),this},n._forEachRow=function(u,p,m,N,w){for(var S=N[u],M=N[u+1],E=S;E<M;E++)w(m[E],p[E])},n._swapRows=function(u,p,m,N,w,S){for(var M=0;M<m;M++){var E=S[M],A=S[M+1],y=g(u,E,A,w),b=g(p,E,A,w);if(y<A&&b<A&&w[y]===u&&w[b]===p){if(N){var x=N[y];N[y]=N[b],N[b]=x}continue}if(y<A&&w[y]===u&&(b>=A||w[b]!==p)){var T=N?N[y]:void 0;w.splice(b,0,p),N&&N.splice(b,0,T),w.splice(b<=y?y+1:y,1),N&&N.splice(b<=y?y+1:y,1);continue}if(b<A&&w[b]===p&&(y>=A||w[y]!==u)){var F=N?N[b]:void 0;w.splice(y,0,u),N&&N.splice(y,0,F),w.splice(y<=b?b+1:b,1),N&&N.splice(y<=b?b+1:b,1)}}},n},{isClass:!0}),Ee="matrix",qa=["typed","Matrix","DenseMatrix","SparseMatrix"],Ra=gr(Ee,qa,r=>{var{typed:t,Matrix:e,DenseMatrix:i,SparseMatrix:n}=r;return t(Ee,{"":function(){return o([])},string:function(h){return o([],h)},"string, string":function(h,d){return o([],h,d)},Array:function(h){return o(h)},Matrix:function(h){return o(h,h.storage())},"Array | Matrix, string":o,"Array | Matrix, string, string":o});function o(c,h,d){if(h==="dense"||h==="default"||h===void 0)return new i(c,d);if(h==="sparse")return new n(c,d);throw new TypeError("Unknown matrix type "+JSON.stringify(h)+".")}}),be="addScalar",La=["typed"],Ua=gr(be,La,r=>{var{typed:t}=r;return t(be,{"number, number":gn,"Complex, Complex":function(i,n){return i.add(n)},"BigNumber, BigNumber":function(i,n){return i.plus(n)},"Fraction, Fraction":function(i,n){return i.add(n)},"Unit, Unit":function(i,n){if(i.value===null||i.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(n.value===null||n.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!i.equalBase(n))throw new Error("Units do not match");var o=i.clone();return o.value=this(o.value,n.value),o.fixPrefix=!1,o}})}),$a="algorithm11",Za=["typed","equalScalar"],Va=gr($a,Za,r=>{var{typed:t,equalScalar:e}=r;return function(n,o,c,h){var d=n._values,g=n._index,s=n._ptr,a=n._size,f=n._datatype;if(!d)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var l=a[0],v=a[1],u,p=e,m=0,N=c;typeof f=="string"&&(u=f,p=t.find(e,[u,u]),m=t.convert(0,u),o=t.convert(o,u),N=t.find(c,[u,u]));for(var w=[],S=[],M=[],E=0;E<v;E++){M[E]=S.length;for(var A=s[E],y=s[E+1],b=A;b<y;b++){var x=g[b],T=h?N(o,d[b]):N(d[b],o);p(T,m)||(S.push(x),w.push(T))}}return M[v]=S.length,n.createSparseMatrix({values:w,index:S,ptr:M,size:[l,v],datatype:u})}}),Ga="algorithm14",Ha=["typed"],Wa=gr(Ga,Ha,r=>{var{typed:t}=r;return function(n,o,c,h){var d=n._data,g=n._size,s=n._datatype,a,f=c;typeof s=="string"&&(a=s,o=t.convert(o,a),f=t.find(c,[a,a]));var l=g.length>0?e(f,0,g,g[0],d,o,h):[];return n.createDenseMatrix({data:l,size:yr(g),datatype:a})};function e(i,n,o,c,h,d,g){var s=[];if(n===o.length-1)for(var a=0;a<c;a++)s[a]=g?i(d,h[a]):i(h[a],d);else for(var f=0;f<c;f++)s[f]=e(i,n+1,o,o[n+1],h[f],d,g);return s}}),ja="multiplyScalar",Ja=["typed"],Ya=gr(ja,Ja,r=>{var{typed:t}=r;return t("multiplyScalar",{"number, number":wn,"Complex, Complex":function(i,n){return i.mul(n)},"BigNumber, BigNumber":function(i,n){return i.times(n)},"Fraction, Fraction":function(i,n){return i.mul(n)},"number | Fraction | BigNumber | Complex, Unit":function(i,n){var o=n.clone();return o.value=o.value===null?o._normalize(i):this(o.value,i),o},"Unit, number | Fraction | BigNumber | Complex":function(i,n){var o=i.clone();return o.value=o.value===null?o._normalize(n):this(o.value,n),o},"Unit, Unit":function(i,n){return i.multiply(n)}})}),Se="multiply",Xa=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],Qa=gr(Se,Xa,r=>{var{typed:t,matrix:e,addScalar:i,multiplyScalar:n,equalScalar:o,dot:c}=r,h=Va({typed:t,equalScalar:o}),d=Wa({typed:t});function g(M,E){switch(M.length){case 1:switch(E.length){case 1:if(M[0]!==E[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(M[0]!==E[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+M[0]+") must match Matrix rows ("+E[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+E.length+" dimensions)")}break;case 2:switch(E.length){case 1:if(M[1]!==E[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+M[1]+") must match Vector length ("+E[0]+")");break;case 2:if(M[1]!==E[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+M[1]+") must match Matrix B rows ("+E[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+E.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+M.length+" dimensions)")}}function s(M,E,A){if(A===0)throw new Error("Cannot multiply two empty vectors");return c(M,E)}function a(M,E){if(E.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return f(M,E)}function f(M,E){var A=M._data,y=M._size,b=M._datatype,x=E._data,T=E._size,F=E._datatype,D=y[0],L=T[1],B,z=i,G=n;b&&F&&b===F&&typeof b=="string"&&(B=b,z=t.find(i,[B,B]),G=t.find(n,[B,B]));for(var Z=[],V=0;V<L;V++){for(var Y=G(A[0],x[0][V]),k=1;k<D;k++)Y=z(Y,G(A[k],x[k][V]));Z[V]=Y}return M.createDenseMatrix({data:Z,size:[L],datatype:B})}var l=t("_multiplyMatrixVector",{"DenseMatrix, any":u,"SparseMatrix, any":N}),v=t("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":p,"DenseMatrix, SparseMatrix":m,"SparseMatrix, DenseMatrix":w,"SparseMatrix, SparseMatrix":S});function u(M,E){var A=M._data,y=M._size,b=M._datatype,x=E._data,T=E._datatype,F=y[0],D=y[1],L,B=i,z=n;b&&T&&b===T&&typeof b=="string"&&(L=b,B=t.find(i,[L,L]),z=t.find(n,[L,L]));for(var G=[],Z=0;Z<F;Z++){for(var V=A[Z],Y=z(V[0],x[0]),k=1;k<D;k++)Y=B(Y,z(V[k],x[k]));G[Z]=Y}return M.createDenseMatrix({data:G,size:[F],datatype:L})}function p(M,E){var A=M._data,y=M._size,b=M._datatype,x=E._data,T=E._size,F=E._datatype,D=y[0],L=y[1],B=T[1],z,G=i,Z=n;b&&F&&b===F&&typeof b=="string"&&(z=b,G=t.find(i,[z,z]),Z=t.find(n,[z,z]));for(var V=[],Y=0;Y<D;Y++){var k=A[Y];V[Y]=[];for(var X=0;X<B;X++){for(var K=Z(k[0],x[0][X]),cr=1;cr<L;cr++)K=G(K,Z(k[cr],x[cr][X]));V[Y][X]=K}}return M.createDenseMatrix({data:V,size:[D,B],datatype:z})}function m(M,E){var A=M._data,y=M._size,b=M._datatype,x=E._values,T=E._index,F=E._ptr,D=E._size,L=E._datatype;if(!x)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var B=y[0],z=D[1],G,Z=i,V=n,Y=o,k=0;b&&L&&b===L&&typeof b=="string"&&(G=b,Z=t.find(i,[G,G]),V=t.find(n,[G,G]),Y=t.find(o,[G,G]),k=t.convert(0,G));for(var X=[],K=[],cr=[],lr=E.createSparseMatrix({values:X,index:K,ptr:cr,size:[B,z],datatype:G}),hr=0;hr<z;hr++){cr[hr]=K.length;var ir=F[hr],br=F[hr+1];if(br>ir)for(var ur=0,er=0;er<B;er++){for(var Ar=er+1,mr=void 0,rr=ir;rr<br;rr++){var wr=T[rr];ur!==Ar?(mr=V(A[er][wr],x[rr]),ur=Ar):mr=Z(mr,V(A[er][wr],x[rr]))}ur===Ar&&!Y(mr,k)&&(K.push(er),X.push(mr))}}return cr[z]=K.length,lr}function N(M,E){var A=M._values,y=M._index,b=M._ptr,x=M._datatype;if(!A)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var T=E._data,F=E._datatype,D=M._size[0],L=E._size[0],B=[],z=[],G=[],Z,V=i,Y=n,k=o,X=0;x&&F&&x===F&&typeof x=="string"&&(Z=x,V=t.find(i,[Z,Z]),Y=t.find(n,[Z,Z]),k=t.find(o,[Z,Z]),X=t.convert(0,Z));var K=[],cr=[];G[0]=0;for(var lr=0;lr<L;lr++){var hr=T[lr];if(!k(hr,X))for(var ir=b[lr],br=b[lr+1],ur=ir;ur<br;ur++){var er=y[ur];cr[er]?K[er]=V(K[er],Y(hr,A[ur])):(cr[er]=!0,z.push(er),K[er]=Y(hr,A[ur]))}}for(var Ar=z.length,mr=0;mr<Ar;mr++){var rr=z[mr];B[mr]=K[rr]}return G[1]=z.length,M.createSparseMatrix({values:B,index:z,ptr:G,size:[D,1],datatype:Z})}function w(M,E){var A=M._values,y=M._index,b=M._ptr,x=M._datatype;if(!A)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var T=E._data,F=E._datatype,D=M._size[0],L=E._size[0],B=E._size[1],z,G=i,Z=n,V=o,Y=0;x&&F&&x===F&&typeof x=="string"&&(z=x,G=t.find(i,[z,z]),Z=t.find(n,[z,z]),V=t.find(o,[z,z]),Y=t.convert(0,z));for(var k=[],X=[],K=[],cr=M.createSparseMatrix({values:k,index:X,ptr:K,size:[D,B],datatype:z}),lr=[],hr=[],ir=0;ir<B;ir++){K[ir]=X.length;for(var br=ir+1,ur=0;ur<L;ur++){var er=T[ur][ir];if(!V(er,Y))for(var Ar=b[ur],mr=b[ur+1],rr=Ar;rr<mr;rr++){var wr=y[rr];hr[wr]!==br?(hr[wr]=br,X.push(wr),lr[wr]=Z(er,A[rr])):lr[wr]=G(lr[wr],Z(er,A[rr]))}}for(var Ir=K[ir],Gr=X.length,Br=Ir;Br<Gr;Br++){var rt=X[Br];k[Br]=lr[rt]}}return K[B]=X.length,cr}function S(M,E){var A=M._values,y=M._index,b=M._ptr,x=M._datatype,T=E._values,F=E._index,D=E._ptr,L=E._datatype,B=M._size[0],z=E._size[1],G=A&&T,Z,V=i,Y=n;x&&L&&x===L&&typeof x=="string"&&(Z=x,V=t.find(i,[Z,Z]),Y=t.find(n,[Z,Z]));for(var k=G?[]:void 0,X=[],K=[],cr=M.createSparseMatrix({values:k,index:X,ptr:K,size:[B,z],datatype:Z}),lr=G?[]:void 0,hr=[],ir,br,ur,er,Ar,mr,rr,wr,Ir=0;Ir<z;Ir++){K[Ir]=X.length;var Gr=Ir+1;for(Ar=D[Ir],mr=D[Ir+1],er=Ar;er<mr;er++)if(wr=F[er],G)for(br=b[wr],ur=b[wr+1],ir=br;ir<ur;ir++)rr=y[ir],hr[rr]!==Gr?(hr[rr]=Gr,X.push(rr),lr[rr]=Y(T[er],A[ir])):lr[rr]=V(lr[rr],Y(T[er],A[ir]));else for(br=b[wr],ur=b[wr+1],ir=br;ir<ur;ir++)rr=y[ir],hr[rr]!==Gr&&(hr[rr]=Gr,X.push(rr));if(G)for(var Br=K[Ir],rt=X.length,Xr=Br;Xr<rt;Xr++){var _=X[Xr];k[Xr]=lr[_]}}return K[z]=X.length,cr}return t(Se,Zi({"Array, Array":function(E,A){g(kr(E),kr(A));var y=this(e(E),e(A));return Sr(y)?y.valueOf():y},"Matrix, Matrix":function(E,A){var y=E.size(),b=A.size();return g(y,b),y.length===1?b.length===1?s(E,A,y[0]):a(E,A):b.length===1?l(E,A):v(E,A)},"Matrix, Array":function(E,A){return this(E,e(A))},"Array, Matrix":function(E,A){return this(e(E,A.storage()),A)},"SparseMatrix, any":function(E,A){return h(E,A,n,!1)},"DenseMatrix, any":function(E,A){return d(E,A,n,!1)},"any, SparseMatrix":function(E,A){return h(A,E,n,!0)},"any, DenseMatrix":function(E,A){return d(A,E,n,!0)},"Array, any":function(E,A){return d(e(E),A,n,!1).valueOf()},"any, Array":function(E,A){return d(e(A),E,n,!0).valueOf()},"any, any":n,"any, any, ...any":function(E,A,y){for(var b=this(E,A),x=0;x<y.length;x++)b=this(b,y[x]);return b}},n.signatures))}),Ae="conj",Ka=["typed"],ka=gr(Ae,Ka,r=>{var{typed:t}=r;return t(Ae,{number:function(i){return i},BigNumber:function(i){return i},Complex:function(i){return i.conjugate()},"Array | Matrix":function(i){return dn(i,this)}})});function rs(){throw new Error('No "matrix" implementation available')}var Ie="size",ts=["typed","config","?matrix"],es=gr(Ie,ts,r=>{var{typed:t,config:e,matrix:i}=r;return t(Ie,{Matrix:function(o){return o.create(o.size())},Array:kr,string:function(o){return e.matrix==="Array"?[o.length]:i([o.length])},"number | Complex | BigNumber | Unit | boolean | null":function(o){return e.matrix==="Array"?[]:i?i([]):rs()}})}),Ce="dot",ns=["typed","addScalar","multiplyScalar","conj","size"],is=gr(Ce,ns,r=>{var{typed:t,addScalar:e,multiplyScalar:i,conj:n,size:o}=r;return t(Ce,{"Array | DenseMatrix, Array | DenseMatrix":h,"SparseMatrix, SparseMatrix":d});function c(s,a){var f=g(s),l=g(a),v,u;if(f.length===1)v=f[0];else if(f.length===2&&f[1]===1)v=f[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+f.join(", ")+")");if(l.length===1)u=l[0];else if(l.length===2&&l[1]===1)u=l[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+l.join(", ")+")");if(v!==u)throw new RangeError("Vectors must have equal length ("+v+" != "+u+")");if(v===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return v}function h(s,a){var f=c(s,a),l=Sr(s)?s._data:s,v=Sr(s)?s._datatype:void 0,u=Sr(a)?a._data:a,p=Sr(a)?a._datatype:void 0,m=g(s).length===2,N=g(a).length===2,w=e,S=i;if(v&&p&&v===p&&typeof v=="string"){var M=v;w=t.find(e,[M,M]),S=t.find(i,[M,M])}if(!m&&!N){for(var E=S(n(l[0]),u[0]),A=1;A<f;A++)E=w(E,S(n(l[A]),u[A]));return E}if(!m&&N){for(var y=S(n(l[0]),u[0][0]),b=1;b<f;b++)y=w(y,S(n(l[b]),u[b][0]));return y}if(m&&!N){for(var x=S(n(l[0][0]),u[0]),T=1;T<f;T++)x=w(x,S(n(l[T][0]),u[T]));return x}if(m&&N){for(var F=S(n(l[0][0]),u[0][0]),D=1;D<f;D++)F=w(F,S(n(l[D][0]),u[D][0]));return F}}function d(s,a){c(s,a);for(var f=s._index,l=s._values,v=a._index,u=a._values,p=0,m=e,N=i,w=0,S=0;w<f.length&&S<v.length;){var M=f[w],E=v[S];if(M<E){w++;continue}if(M>E){S++;continue}M===E&&(p=m(p,N(l[w],u[S])),w++,S++)}return p}function g(s){return Sr(s)?s.size():o(s)}}),os=ya({}),as=da({config:At}),ue=Aa({}),ss=Ea({}),yn=xa({Matrix:ue}),Vr=wo({BigNumber:as,Complex:os,DenseMatrix:yn,Fraction:ss}),_n=za({config:At,typed:Vr}),Nn=Ya({typed:Vr}),Mn=Ua({typed:Vr}),us=ka({typed:Vr}),fs=Ba({Matrix:ue,equalScalar:_n,typed:Vr}),En=Ra({DenseMatrix:yn,Matrix:ue,SparseMatrix:fs,typed:Vr}),cs=es({matrix:En,config:At,typed:Vr}),bn=is({addScalar:Mn,conj:us,multiplyScalar:Nn,size:cs,typed:Vr}),fe=Qa({addScalar:Mn,dot:bn,equalScalar:_n,matrix:En,multiplyScalar:Nn,typed:Vr});const Kt=[[[1,0,0],[0,1,0],[0,0,1]],[[1,0,0],[0,0,-1],[0,1,0]],[[0,0,1],[0,1,0],[-1,0,0]],[[0,-1,0],[1,0,0],[0,0,1]],[[1,0,0],[0,0,1],[0,-1,0]],[[0,0,-1],[0,1,0],[1,0,0]],[[0,1,0],[-1,0,0],[0,0,1]],[[1,0,0],[0,-1,0],[0,0,-1]],[[-1,0,0],[0,1,0],[0,0,-1]],[[-1,0,0],[0,-1,0],[0,0,1]]],ls=[[-1,0,0],[0,-1,0],[0,0,-1]],xe=[1,ui,fi,ci,li,hi,pi,vi,di,mi],hs=te.slice(10).map(r=>r.items).map(([r,t])=>fe(Kt[xe.indexOf(r)],Kt[xe.indexOf(t)])),Sn=Kt.concat(hs),ps=Sn.map(r=>fe(ls,r)),vs=Sn.concat(ps),An=r=>r.map(t=>"-0+"[t+1]).join(""),ce=Array(3**3).fill(null).map((r,t)=>[t%3-1,Math.floor(t/3)%3-1,Math.floor(t/9)-1]),ds=ce.map(An),Oe=ce.map(r=>vs.map(t=>ds.indexOf(An(fe(r,t))))),ms=[...Array(3**3).keys()],gs=Array(6).fill(null).map((r,t)=>ms.filter(e=>{const i=t%2>0;return ce[e][Math.floor(t/2)]===(i?1:-1)})),le=r=>({axis:r%6,rotation:Math.floor(r/2)+1}),ws=(r,t)=>r%2+(t-1)*2,ys=r=>[1,3,2].indexOf((r%4+4)%4),In=(r,t)=>r+ys(t)*6,Cn=r=>r>=12?r:r>=6?r-6:r+6,_s=r=>[...r].reverse().map(Cn),he=["L'","R","D'","U","B'","F","L","R'","D","U'","B","F'","L2","R2","D2","U2","B2","F2"],Ns=r=>r.map(t=>he[t]).join(""),Ms=r=>r.match(/\w['2]?/g).map(t=>he.indexOf(t)),Es=r=>[].concat(...r.map(t=>t>=12?[t%6,t%6]:[t])),ct=[0,2,6,8,18,20,24,26,1,3,5,7,9,11,15,17,19,21,23,25,4,10,12,14,16,22],pe=(r,t)=>r.map(e=>t[e]),vt=(r,t)=>Array.from(r).map((e,i)=>({k:e,i})).sort((e,i)=>e.k-i.k).map(({i:e})=>t[e]),Te=65;class ot{constructor({code:t,path:e}={}){pr(this,"units");this.reset(),t&&this.decode(t),e&&this.twists(e)}get positions(){return this.units.map((t,e)=>Oe[e][t])}reset(){this.units=new Uint8Array(3**3).fill(0)}clone(){const t=new ot;return t.units=new Uint8Array(this.units),t}isZero(){for(const t of this.units)if(t)return!1;return!0}faceIndicesFromAxis(t){const e=gs[t];return Array.from(this.positions).map((i,n)=>({position:i,index:n})).filter(({position:i})=>e.includes(i)).map(({index:i})=>i)}twist(t){const{axis:e,rotation:i}=le(t);return this.faceIndicesFromAxis(e).forEach(o=>this.units[o]=Ft[this.units[o]][i]),this}twists(t){return t.forEach(e=>this.twist(e)),this}multiply(t){const e=this.positions,i=new ot;return i.units=this.units.map((n,o)=>Ft[n][t.units[e[o]]]),i}divide(t){const e=new ot,i=t.units.map((n,o)=>de[n][this.units[o]]);return e.units=Uint8Array.from(vt(t.positions,i)),e}transform(t){const e=this.units.map((n,o)=>Oe[o][t]),i=t%24;return this.units=new Uint8Array(vt(e,this.units).map(n=>de[i][Ft[n][i]])),this}encode(){return ct.map(t=>this.units[t]).map(t=>String.fromCharCode(Te+t)).join("")}decode(t){console.assert(t.length===ct.length,"invalid code, length required to be",ct.length,t),t.split("").map(e=>e.charCodeAt(0)-Te).forEach((e,i)=>this.units[ct[i]]=e)}validate(){const t=this.positions;for(let e=0;e<this.units.length;++e)if(t.filter(i=>i===e).length!==1)return!1;return!0}}const bs=[[0,1,11,10,2,3,6,7,5,4,8,9],[4,5,2,3,7,6,10,11,8,9,1,0],[9,8,0,1,4,5,3,2,6,7,10,11]],Ss=[1,0,3,2,5,4,7,6,9,8,11,10],xn=Array(12).fill(null).map((r,t)=>t),As=({unit:r,exponent:t})=>{const e=bs[r];switch(t){case 1:return e;case-1:return vt(e,xn);case 2:return pe(e,e);default:console.assert(!1,"invalid exponent:",t)}},Is=r=>r.items.reduce((t,e)=>vt(As(e),t),xn),Pe=te.map(r=>Is(r)),Cs=[...Pe,...Pe.map(r=>pe(r,Ss))],Xs=Object.freeze(Object.defineProperty({__proto__:null,Cube3:ot,ENCODE_UNIT_ORDER:ct,TWIST_NAMES:he,TWIST_PERMUTATION_48:Cs,axisRotationToTwist:ws,axisTimesToTwist:In,depermutate:vt,invertPath:_s,invertTwist:Cn,parsePath:Ms,permutate:pe,quarterfyPath:Es,stringifyPath:Ns,twistToAxisRotation:le},Symbol.toStringTag,{value:"Module"}));class bt{constructor(t,e,i,n,o,c){pr(this,"a");pr(this,"b");pr(this,"c");pr(this,"normal");pr(this,"color");pr(this,"materialIndex");pr(this,"uvs");Object.assign(this,{a:t,b:e,c:i,normal:n,color:o,materialIndex:c})}}const ze=r=>[].concat(...r);class On{constructor(){pr(this,"vertices");pr(this,"faces");pr(this,"faceVertexUvs")}toBufferGeometry(){if(!this.vertices||!this.faces)return null;const t=this.faces[0];if(!t)return null;if(this.faceVertexUvs){const c=ze(this.faceVertexUvs);this.faces.forEach((h,d)=>h.uvs=c[d])}const e=Array(this.vertices.length).fill(null);this.faces.forEach(c=>{e[c.a]={normal:c.normal,color:c.color,uv:c.uvs&&c.uvs[0]},e[c.b]={normal:c.normal,color:c.color,uv:c.uvs&&c.uvs[1]},e[c.c]={normal:c.normal,color:c.color,uv:c.uvs&&c.uvs[2]}});const i=new qe;if(i.setIndex([].concat(...this.faces.map(c=>[c.a,c.b,c.c]))),i.setAttribute("position",new Kr([].concat(...this.vertices.map(c=>[c.x,c.y,c.z])),3)),t.normal){const c=[].concat(...e.map(h=>h.normal));i.setAttribute("normal",new Kr(c,3))}t.color&&i.setAttribute("color",new Kr([].concat(...e.map(c=>[c.color.r,c.color.g,c.color.b])),3)),t.uvs&&i.setAttribute("uv",new Kr([].concat(...e.map(c=>ze([c.uv.x,c.uv.y]))),2));let n=0,o=-1;for(let c=0;c<this.faces.length;++c){const h=this.faces[c];h.materialIndex!==o&&(c>n&&(i.addGroup(n*3,(c-n)*3,o),n=c),o=h.materialIndex)}return n<this.faces.length&&i.addGroup(n*3,(this.faces.length-n)*3,o),i}}const xs=[[-.5,-.5,-.5],[-.5,-.5,.5],[-.5,.5,.5],[-.5,.5,-.5],[.5,.5,-.5],[.5,.5,.5],[.5,-.5,.5],[.5,-.5,-.5],[.5,-.5,-.5],[.5,-.5,.5],[-.5,-.5,.5],[-.5,-.5,-.5],[-.5,.5,-.5],[-.5,.5,.5],[.5,.5,.5],[.5,.5,-.5],[.5,-.5,-.5],[-.5,-.5,-.5],[-.5,.5,-.5],[.5,.5,-.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,.5]].map(r=>new or(...r)),Fe=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],Tn=Array(3**3).fill().map(()=>new On);Tn.forEach((r,t)=>{const e=[t%3-1,Math.floor(t/3)%3-1,Math.floor(t/9)-1];r.vertices=xs,r.faces=[].concat(...Array(6).fill().map((i,n)=>({i4:n*4,normal:Fe[n],materialIndex:bn(Fe[n],e)>0?n:6})).map(i=>[new bt(i.i4,i.i4+1,i.i4+2,i.normal,void 0,i.materialIndex),new bt(i.i4,i.i4+2,i.i4+3,i.normal,void 0,i.materialIndex)]))});function Os(r){return console.assert(r.length===7,"invalid materials:",r),Tn.map(t=>new kt(t.toBufferGeometry(),r))}const Ts=!0,Ps=Object.freeze(Object.defineProperty({__proto__:null,createCube3Meshes:Os,needTranslation:Ts},Symbol.toStringTag,{value:"Module"})),zs=[[-.5,-.5,-.5],[-.5,-.5,.5],[-.5,.5,.5],[-.5,.5,-.5],[.5,.5,-.5],[.5,.5,.5],[.5,-.5,.5],[.5,-.5,-.5],[.5,-.5,-.5],[.5,-.5,.5],[-.5,-.5,.5],[-.5,-.5,-.5],[-.5,.5,-.5],[-.5,.5,.5],[.5,.5,.5],[.5,.5,-.5],[.5,-.5,-.5],[-.5,-.5,-.5],[-.5,.5,-.5],[.5,.5,-.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,.5]].map(r=>new or(...r)),Ut=[[0,0],[1,0],[1,1],[0,1],[1,1],[0,1],[0,0],[1,0],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[1,0],[1,1],[0,1],[0,0]].map(r=>new re(...r)),Fs=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],Pn=Array(3**3).fill().map(()=>new On);Pn.forEach(r=>{r.vertices=zs,r.faces=[].concat(...Array(6).fill().map((t,e)=>({i4:e*4,normal:Fs[e],materialIndex:0})).map(t=>[new bt(t.i4,t.i4+1,t.i4+2,t.normal,void 0,t.materialIndex),new bt(t.i4,t.i4+2,t.i4+3,t.normal,void 0,t.materialIndex)])),r.faceVertexUvs=[r.faces.map(({a:t,b:e,c:i})=>[Ut[t],Ut[e],Ut[i]])]});const Ds=new si({color:0});function Bs(r){return console.assert(r.length===26,"invalid materials:",r),Pn.map((t,e)=>{const i=e===13?Ds:e>13?r[e-1]:r[e];return new kt(t.toBufferGeometry(),i)})}const qs=!0,Rs=Object.freeze(Object.defineProperty({__proto__:null,createCube3Meshes:Bs,needTranslation:qs},Symbol.toStringTag,{value:"Module"})),et=(r,t=new or(1,0,0),e=0,i=0)=>({Pos:r,Normal:t,TCoords:new re(e,i)}),Hr=(r,t)=>{const e=r.length(),i=Math.max(Math.abs(r.x),Math.max(Math.abs(r.y),Math.abs(r.z))),n=e*t+i*(1-t);return new or(r.x*n/e,r.y*n/e,r.z*n/e)},Ls=r=>{const t=r.length(),e=Math.sqrt(r.x*r.x+r.z*r.z),i=Math.acos(-r.y/t)/Math.PI;let n=e===0?0:Math.acos(-r.x/e)/(Math.PI*2);return r.z<0&&(n=1-n),{w:t,u:n,v:i}},Ur=(r,t,e,i,n)=>{for(let o=r;o<=t;++o)for(let c=e;c<=i;++c)n(o,c)},zn=({segemnts:r=18,sphericity:t=.48,chamferRadius:e=.2}={})=>{const i=1/(r+.6666666666666666),n=(r+1)*(r+1),o=(a,f,l)=>n*a+f*(r+1)+l,c=[];for(let a=0;a<6;++a)Ur(0,r-1,0,r-1,(f,l)=>{c.push(o(a,f,l)),c.push(o(a,f+1,l+1)),c.push(o(a,f+1,l)),c.push(o(a,f,l)),c.push(o(a,f,l+1)),c.push(o(a,f+1,l+1))});const h={};let d=!1;const g=[];for(let a=-1;a<=1;++a)for(let f=-1;f<=1;++f)for(let l=-1;l<=1;++l){const v=[],u=[],[p,m]=[l*(r+1)-r/2,l*(r+1)+r/2],[N,w]=[f*(r+1)-r/2,f*(r+1)+r/2],[S,M]=[a*(r+1)-r/2,a*(r+1)+r/2];Ur(N,w,S,M,(y,b)=>{const x=new or(p,y,b).multiplyScalar(i);v.push(x),u.push(et(Hr(x,t)))}),Ur(S,M,N,w,(y,b)=>{const x=new or(m,b,y).multiplyScalar(i);v.push(x),u.push(et(Hr(x,t)))}),Ur(S,M,p,m,(y,b)=>{const x=new or(b,N,y).multiplyScalar(i);v.push(x),u.push(et(Hr(x,t)))}),Ur(p,m,S,M,(y,b)=>{const x=new or(y,w,b).multiplyScalar(i);v.push(x),u.push(et(Hr(x,t)))}),Ur(p,m,N,w,(y,b)=>{const x=new or(y,b,S).multiplyScalar(i);v.push(x),u.push(et(Hr(x,t)))}),Ur(N,w,p,m,(y,b)=>{const x=new or(b,y,M).multiplyScalar(i);v.push(x),u.push(et(Hr(x,t)))});let E=0;const A=[new or(1,0,0),new or(-1,0,0),new or(0,1,0),new or(0,-1,0),new or(0,0,1),new or(0,0,-1)];for(let y=0;y<6;++y){const b=A[y].clone().multiplyScalar(i);Ur(0,r,0,r,(x,T)=>{const F=o(y,x,T),D=u[F];if(x===0||x===r||T===0||T===r){const X=v[F].clone();X.add(b.clone().multiplyScalar(e)),x===0&&X.add(v[o(y,x+1,T)].clone().sub(v[F]).multiplyScalar(e)),x===r&&X.add(v[o(y,x-1,T)].clone().sub(v[F]).multiplyScalar(e)),T===0&&X.add(v[o(y,x,T+1)].clone().sub(v[F]).multiplyScalar(e)),T===r&&X.add(v[o(y,x,T-1)].clone().sub(v[F]).multiplyScalar(e)),D.Pos=Hr(X,t)}const L=D.Pos,B=[],z=Hr(v[F].clone().add(b),t).sub(L).normalize(),G=x>0?u[o(y,x-1,T)].Pos.clone().sub(L):z,Z=x<r?u[o(y,x+1,T)].Pos.clone().sub(L):z,V=T>0?u[o(y,x,T-1)].Pos.clone().sub(L):z,Y=T<r?u[o(y,x,T+1)].Pos.clone().sub(L):z;B.push(V.clone().cross(G)),B.push(G.clone().cross(Y)),B.push(Z.clone().cross(V)),B.push(Y.clone().cross(Z)),D.Normal=new or(0,0,0),B.forEach(X=>D.Normal.add(X.clone().normalize())),D.Normal.normalize(),D.Tangent=Z.clone().add(G.clone().multiplyScalar(-1)),D.Tangent.normalize(),D.Binormal=Y.clone().add(V.clone().multiplyScalar(-1)),D.Binormal.normalize();const k=Ls(L);if(D.TCoords.x=k.u,D.TCoords.y=k.v,L.z===0){++E,d||(h[o(y,x,T)]=u.length);let X=D;D.TCoords.x===0&&(X={Pos:D.Pos,Normal:D.Normal,Tangent:D.Tangent,Binormal:D.Binormal,TCoords:new re(1,D.TCoords.y)}),u.push(X)}})}g.push({vertices:u,indices:c,mended:E,translation:[l,f,a]}),d=d||E>0}const s=[];for(let a=0;a<6;++a)Ur(0,r-1,0,r-1,(f,l)=>{const v=o(a,f,l);let u=o(a,f+1,l),p=o(a,f,l+1),m=o(a,f+1,l+1);switch(a){case 0:case 3:p=h[p]||p,m=h[m]||m;break;case 1:case 2:u=h[u]||u,m=h[m]||m;break}s.push(v),s.push(m),s.push(u),s.push(v),s.push(p),s.push(m)});return g.forEach(a=>{a.mended&&(a.indices=s)}),g.map(a=>{const f=new qe;return f.setIndex(a.indices),f.setAttribute("position",new Kr([].concat(...a.vertices.map(l=>[l.Pos.x,l.Pos.y,l.Pos.z])),3)),f.setAttribute("normal",new Kr([].concat(...a.vertices.map(l=>[l.Normal.x,l.Normal.y,l.Normal.z])),3)),f.setAttribute("uv",new Kr([].concat(...a.vertices.map(l=>[l.TCoords.x,l.TCoords.y])),2)),f.addGroup(0,a.indices.length,0),f})},Us=r=>zn().map(t=>new kt(t,r)),$s=Object.freeze(Object.defineProperty({__proto__:null,createCube3Meshes:Us,createGeometries:zn},Symbol.toStringTag,{value:"Module"})),Zs=3**3,Vs=Array(Zs).fill(null).map((r,t)=>[t%3-1,Math.floor(t/3)%3-1,Math.floor(t/9)-1]),$t=.92,Zt=Math.PI/2,Gs=Math.PI/60,Vt=te.map(r=>r.toQuaternion()),De=[new or(-1,0,0),new or(-1,0,0),new or(0,-1,0),new or(0,-1,0),new or(0,0,-1),new or(0,0,-1)],Be={cube:Ps,cube26:Rs,spherical:$s};class Qs{constructor({materials:t,twistDuration:e=300,onChange:i=null,meshSchema:n="cube"}){pr(this,"algebra");pr(this,"graph");pr(this,"cubeMeshes");pr(this,"animation");pr(this,"twistDuration");pr(this,"onChange");pr(this,"startQuaternions");pr(this,"graphTwist");this.algebra=new ot,this.twistDuration=e,this.onChange=i,this.graph=new ve,this.cubeMeshes=Be[n].createCube3Meshes(t),this.cubeMeshes.forEach((o,c)=>{Be[n].needTranslation&&(o.position.set(...Vs[c]),o.scale.set($t,$t,$t));const h=new ve;h.add(o),this.graph.add(h)}),this.updateGraph(),this.animation=Promise.resolve()}updateGraph(){this.graph.children.forEach((t,e)=>{const i=Vt[this.algebra.units[e]];i&&t.quaternion.set(...i)}),this.onChange&&this.onChange(this.algebra)}reset(){this.algebra.reset(),this.updateGraph()}setState(t){this.algebra.decode(t),console.assert(this.algebra.validate(),"invalid cube state:",t),this.updateGraph()}twist(t,{useAnimation:e=!0}={}){if(!e){this.algebra.twist(t),this.updateGraph();return}return this.animation=this.animation.then(async()=>{this.algebra.twist(t);const i=Date.now()+this.twistDuration,{axis:n,rotation:o}=le(t),c=this.algebra.faceIndicesFromAxis(n),h=[Math.PI*-.5,Math.PI*.5,Math.PI][Math.floor((o-1)/3)],d=new ft().setFromAxisAngle(De[n],h);let g=Date.now();for(;g<i;){const s=1-(i-g)/this.twistDuration,a=3*s**2-2*s**3;c.forEach(f=>{const l=new ft(...Vt[this.algebra.units[f]]),v=l.clone();v.premultiply(d),ft.slerp(v,l,this.graph.children[f].quaternion,a)}),await Dt(),g=Date.now()}this.updateGraph(),await Dt()}),this.animation}twistGraph(t,e,{record:i=!0}={}){const n=new ft().setFromAxisAngle(De[t],e*(t%2?1:-1));this.algebra.faceIndicesFromAxis(t).forEach(c=>{const h=new ft(...Vt[this.algebra.units[c]]);this.graph.children[c].quaternion.fromArray(h.premultiply(n).toArray())}),i&&(this.graphTwist={axis:t,angle:e})}releaseGraph(){if(this.graphTwist){const t=Math.round(this.graphTwist.angle/Zt),e=In(this.graphTwist.axis,t*(this.graphTwist.axis%2?1:-1)),i=t*Zt,n=i>this.graphTwist.angle?1:-1;this.animation=this.animation.then(async()=>{e>=0&&this.algebra.twist(e);let o=this.graphTwist.angle;for(;(i-o)*n>0;)o+=Math.min(Gs,Math.abs(i-o))*n,this.twistGraph(this.graphTwist.axis,o-t*Zt,{record:!1}),await Dt();this.updateGraph()})}}}export{Qs as C,ct as E,Cs as T,Cn as a,ot as b,pe as c,Xs as d,_s as i,Ms as p,Es as q,Ns as s};
