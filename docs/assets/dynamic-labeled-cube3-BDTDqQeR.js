import{r as v}from"./vue-resize-directive-CDf_Yp3t.js";import{V as m,ac as d}from"./three.module-x1Cfo4R0.js";import{u as y}from"./url-DHKDaZKd.js";import{a as l,m as u}from"./delay-DTFr9Qec.js";import{p as b,i as z,a as x}from"./cubeObject-CTeWqh_v.js";import{G as _,O as T}from"./greek-letters-D2RlIem_.js";import{L}from"./labeled-cube3-YyADtBKr.js";import{C as S}from"./cube3-matrix-CyCVV239.js";import{_ as E,r as f,y as R,w as k,c as h,o as r,a as p,p as c,b as I,e as P,F as U,g as B,n as D,h as q}from"./router-JVv0ElFj.js";import"./_commonjsHelpers-DM6icglO.js";import"./cube-algebra-Cwll5vw1.js";import"./latin-letters-Cf9SrFGT.js";import"./label3D-Z-TrrnsP.js";const H="LrDuBflRdUbF",F=["L'","R","D'","U","B'","F","L","R'","D","U'","B","F'","L<sup>2</sup>","R<sup>2</sup>","D<sup>2</sup>","U<sup>2</sup>","B<sup>2</sup>","F<sup>2</sup>"],G={name:"dynamic-labeled-cube3",directives:{resize:v},components:{LabeledCube3:L,Cube3Matrix:S},props:{showMatrix:{type:Boolean,default:!0},showCaption:Boolean,demo:Boolean,demoPath:String},data(){return{size:void 0,cube:null,code:null,highlightCubie:null,vector:null,twistsSeq:[]}},computed:{canvasSize(){return this.size&&{width:Math.max(this.size.width*.5,this.size.height*.7),height:this.size.height}},vectorText(){return this.vector&&this.vector.map(e=>_[T[e]]).join("")}},created(){document.addEventListener("keydown",e=>{switch(e.key){case"Home":this.$refs.cube&&this.$refs.cube.reset();break;default:if(this.$refs.cube){const t=H.indexOf(e.key);t>=0&&this.$refs.cube.twist(t)}}}),window.onhashchange=()=>this.onHashChange()},methods:{onResize(){this.size={width:this.$el.clientWidth,height:this.$el.clientHeight}},onCubeCreated(e){this.cube=e.algebra,this.onHashChange()},onCubeChanged(){this.$refs.matrix&&this.$refs.matrix.updateMatrix()},async onSceneInitialized(){if(this.demo){for(;!this.$refs.cube||!this.$refs.cube.cubeGroup;)await l();this.$refs.cube.cubeGroup.quaternion.setFromEuler(new d(Math.PI*.16,0,0)),this.animate()}else this.demoPath&&this.twists(this.demoPath)},async animate(e=null){for(this.animating=!0,this.rotate();this.animating;){for(;!this.$refs.cube;)await l();let t=null;const o=e||Math.floor(Math.random()*Math.random()*9+1),n=Array(o).fill().map(()=>{let i=Math.floor(Math.random()*12);for(;Number.isInteger(t)&&i===x(t);)i=Math.floor(Math.random()*12);return t=i,i}),s=z(n);for(const i of n)await this.$refs.cube.twist(i),await u(300);await u(1200);for(const i of s)await this.$refs.cube.twist(i),await u(100);await u(1600)}},async twists(e){this.$refs.cube.cubeGroup.quaternion.setFromEuler(new d(Math.PI*.16,Math.PI*.309,0)),this.animating=!0;const t=b(e);this.twistsSeq=[];for(const o of t)this.twistsSeq.push(F[o]),await this.$refs.cube.twist(o);this.rotate(-3e-4)},async rotate(e=-1e-4){const t=Date.now();let o=t;for(;this.animating;){const n=Date.now(),s=n-o;o=n,this.$refs.cube.cubeGroup.rotateOnAxis(new m(0,1,0),s*e),this.$refs.cube.cubeGroup.rotateOnWorldAxis(new m(1,0,0),Math.cos((o-t)*1e-5)*s*4e-7),await l()}},onMouseMove(e){this.$refs.cube&&this.$refs.cube.onMouseMove(e)},onMouseUp(e){this.$refs.cube&&this.$refs.cube.onMouseUp(e)},onHashChange(){let e=location.hash.substr(1);e[0]==="/"&&!/#/.test(e)&&(e+="#"),e=e.replace(/.*#/,"");const t=y.parse(e,!0),o=t.pathname;if(o&&(this.code=o),t.query.path){const n=b(t.query.path);if(n.length){const s=n[0];s>=0&&this.$refs.cube&&this.$refs.cube.twist(s).then(()=>{const i=stringifyPath(n.slice(1));location.hash=`${this.getRouterPath()}${this.code}?path=${i}`})}}},getRouterPath(){const[e]=location.hash.match(/^#\/[^#]*/)||[];return e?e+"#":""}},watch:{code(e){this.animating||(location.hash=this.getRouterPath()+e),this.$nextTick(()=>{this.onCubeChanged()})}}},O={class:"matrix-side"},N={key:0},$={key:0,class:"twists"},A=["innerHTML"],V=["innerHTML"];function W(e,t,o,n,s,i){const w=f("LabeledCube3"),g=f("Cube3Matrix"),C=R("resize");return k((r(),h("div",{class:q(["dynamic-labeled-cube3",{captional:o.showCaption}]),onMousemove:t[3]||(t[3]=(...a)=>i.onMouseMove&&i.onMouseMove(...a)),onMouseup:t[4]||(t[4]=(...a)=>i.onMouseUp&&i.onMouseUp(...a)),style:D({"--matrix-font-size":s.size&&`${Math.min(s.size.width*.015,s.size.height*.025)}px`})},[p("main",null,[I(w,{ref:"cube",size:i.canvasSize,showRedLabels:!0,coloredUnderbox:!0,showOrientations:!0,onCubeCreated:i.onCubeCreated,code:s.code,"onUpdate:code":t[0]||(t[0]=a=>s.code=a),highlightCubie:s.highlightCubie,"onUpdate:highlightCubie":t[1]||(t[1]=a=>s.highlightCubie=a),onSceneInitialized:i.onSceneInitialized},null,8,["size","onCubeCreated","code","highlightCubie","onSceneInitialized"]),p("div",O,[o.showMatrix&&s.cube?(r(),P(g,{key:0,ref:"matrix",cube:s.cube,highlightCubie:s.highlightCubie,vector:s.vector,"onUpdate:vector":t[2]||(t[2]=a=>s.vector=a)},null,8,["cube","highlightCubie","vector"])):c("",!0)])]),o.showCaption?(r(),h("header",N,[s.twistsSeq?(r(),h("p",$,[(r(!0),h(U,null,B(s.twistsSeq,(a,M)=>(r(),h("span",{key:M,innerHTML:a},null,8,A))),128))])):c("",!0),i.vectorText?(r(),h("h1",{key:1,innerHTML:i.vectorText},null,8,V)):c("",!0)])):c("",!0)],38)),[[C,i.onResize]])}const ne=E(G,[["render",W],["__scopeId","data-v-f3330522"]]);export{ne as default};
