import{r as P}from"./vue-resize-directive-CDf_Yp3t.js";import{S as v}from"./svg-map-D4aMqU55.js";import{_ as k,r as M,y as T,w as A,c as n,o as i,a as c,b as S,i as p,p as a,F as h,g as u,h as y,B as _}from"./router-JVv0ElFj.js";const Y=""+new URL("f_2_x_12-BAoxsNNs.svg",import.meta.url).href,x=-4,d=240,w={name:"equal-temperament",props:{cartesianWidth:{type:Number,default:()=>800},clockSize:{type:Number,default:()=>600}},directives:{resize:P},components:{SvgMap:v},data(){return{size:{},curvePoints:Array(1080).fill().map((l,e)=>({x:(e-480)/10,y:x*2**((e-480)/120)})),stepPoints:Array(88).fill().map((l,e)=>({pitch:e+21,C:(e+21)%12===0,x:e-39,y:x*2**((e-39)/12)})),url12Equal:Y,CARTESIAN_Y_SCALE:x,CLOCK_RADIUS:d,cursorPoint:null,focusPoints:[],steps:[{pitch:0,name:"C"},{pitch:1},{pitch:2,name:"D"},{pitch:3},{pitch:4,name:"E"},{pitch:5,name:"F"},{pitch:6},{pitch:7,name:"G"},{pitch:8},{pitch:9,name:"A"},{pitch:10},{pitch:11,name:"B"}]}},computed:{curvePath(){return"M"+this.curvePoints.map(l=>`${l.x} ${l.y.toFixed(6)}`).join(" L")}},mounted(){},methods:{onResize(){this.size={width:this.$el.clientWidth,height:this.$el.clientHeight}},onClick(){this.focusPoints=[]},onFPadMoving(l){const e=this.$refs.cartesian.clientToView({x:l.offsetX,y:l.offsetY}),r=Math.log2(e.y/x)*12;this.focusPoints=[{x:r,y:e.y}]},onXPadMoving(l){const e=this.$refs.cartesian.clientToView({x:l.offsetX,y:l.offsetY});e.x=Math.round(e.x*10)/10;const r=x*2**(e.x/12);this.focusPoints=[{x:e.x,y:r}]},onClockMoving(l){const e={x:l.offsetX*600/this.clockSize-300,y:l.offsetY*600/this.clockSize-300},r=Math.atan(e.y/e.x)/Math.PI+(e.x<0?1:0)+.5,f=(r<0?r+2:r)*6,t=Math.round(f*10)/10;this.focusPoints=[t,t-12,t+12].map(o=>({x:o,y:x*2**(o/12)}))},pToCX(l,e=1){return Math.cos((l-3)*Math.PI*2/12)*d*e},pToCY(l,e=1){return Math.sin((l-3)*Math.PI*2/12)*d*e}}},z=["d"],X={class:"axis-points"},E=["cx"],I={class:"steps"},L=["x"],N={class:"curve-points"},R=["x1","x2","y2"],b=["y1","x2","y2"],D=["cx","cy"],F={class:"band-f"},B=["y1","y2"],V=["transform"],q={class:"band-x"},U={class:"focus-pionts"},W=["y1","x2","y2"],K=["x1","x2","y2"],O=["cx","cy"],j=["transform"],G=["transform"],H=["cx","cy"],Z=["width","height"],J=["r"],Q={class:"steps"},$=["x","y"],ss={class:"scales"},es=["d"],cs=["x1","y1","x2","y2"],ts=["cx","cy","onClick"],os={key:0,class:"focus"},ns=["x2","y2"],is=["cx","cy"],ls={class:"formations"},rs={class:"inner"},hs=["src"];function us(l,e,r,f,t,o){const C=M("SvgMap"),g=T("resize");return A((i(),n("div",{class:"equal-temperament",onClick:e[3]||(e[3]=(...s)=>o.onClick&&o.onClick(...s))},[c("article",null,[S(C,{class:"cartesian",ref:"cartesian",width:r.cartesianWidth,height:r.cartesianWidth*.7,initViewWidth:24,initViewCenter:{x:6,y:-7}},{default:p(()=>[e[4]||(e[4]=c("g",{class:"axes"},[c("line",{x1:"-100",y1:"0",x2:"100",y2:"0"}),c("line",{x1:"0",y1:"-100",x2:"0",y2:"100"})],-1)),c("path",{class:"curve",d:o.curvePath},null,8,z),c("g",X,[(i(!0),n(h,null,u(t.stepPoints,s=>(i(),n("circle",{cx:s.x,cy:0},null,8,E))),256))]),c("g",I,[(i(!0),n(h,null,u(t.steps,s=>(i(),n(h,{key:s.pitch},[s.name?(i(),n("text",{key:0,class:y(["label",{focus:t.focusPoints[0]&&t.focusPoints[0].x==s.pitch,chosen:s.chosen}]),x:s.pitch,y:.6},_(s.name),11,L)):a("",!0)],64))),128))]),c("g",N,[(i(!0),n(h,null,u(t.stepPoints,s=>(i(),n("g",{class:y({bold:s.C,chosen:t.steps[s.x]&&t.steps[s.x].chosen})},[c("line",{class:"vertical",x1:s.x,y1:0,x2:s.x,y2:s.y},null,8,R),s.C?(i(),n("line",{key:0,class:"horizontal",x1:0,y1:s.y,x2:s.x,y2:s.y},null,8,b)):a("",!0),c("circle",{cx:s.x,cy:s.y},null,8,D)],2))),256))]),c("g",F,[(i(),n(h,null,u([1,2,4,8],s=>c("g",null,[c("line",{class:"scale-line",x1:0,y1:s*t.CARTESIAN_Y_SCALE,x2:-.2,y2:s*t.CARTESIAN_Y_SCALE},null,8,B),c("text",{class:"label",transform:`translate(-0.4, ${s*t.CARTESIAN_Y_SCALE})`},_(s),9,V)])),64)),c("rect",{class:"pad",x:-1.6,y:-100,width:2.4,height:100,onMousemove:e[0]||(e[0]=(...s)=>o.onFPadMoving&&o.onFPadMoving(...s))},null,32)]),c("g",q,[c("rect",{class:"pad",x:-100,y:-.6,width:200,height:2.4,onMousemove:e[1]||(e[1]=(...s)=>o.onXPadMoving&&o.onXPadMoving(...s))},null,32)]),c("g",U,[(i(!0),n(h,null,u(t.focusPoints,(s,m)=>(i(),n("g",{key:m},[c("line",{x1:0,y1:s.y,x2:s.x,y2:s.y},null,8,W),c("line",{x1:s.x,y1:0,x2:s.x,y2:s.y},null,8,K),c("circle",{class:"dot",cx:s.x,cy:s.y},null,8,O),c("text",{class:"label",transform:`translate(-1.6, ${s.y})`},_((s.y/t.CARTESIAN_Y_SCALE).toPrecision(4)),9,j),c("text",{class:"label",transform:`translate(${s.x}, 1.2)`},_(s.x.toFixed(1)),9,G)]))),128))]),t.cursorPoint?(i(),n("circle",{key:0,class:"cursor",r:"0.2",fill:"red",cx:t.cursorPoint.x,cy:t.cursorPoint.y},null,8,H)):a("",!0)],void 0,!0),_:1},8,["width","height"]),(i(),n("svg",{class:"clock",width:r.clockSize,height:r.clockSize,viewBox:"-300 -300 600 600",onMousemove:e[2]||(e[2]=(...s)=>o.onClockMoving&&o.onClockMoving(...s))},[c("circle",{class:"frame",r:t.CLOCK_RADIUS,cx:"0",cy:"0"},null,8,J),c("g",Q,[(i(!0),n(h,null,u(t.steps,s=>(i(),n(h,{key:s.pitch},[s.name?(i(),n("text",{key:0,class:y(["label",{focus:t.focusPoints[0]&&t.focusPoints[0].x==s.pitch,chosen:s.chosen}]),x:o.pToCX(s.pitch,1.08),y:o.pToCY(s.pitch,1.08)+14},_(s.name),11,$)):a("",!0)],64))),128))]),c("g",ss,[(i(!0),n(h,null,u(t.steps,s=>(i(),n("g",{key:s.pitch,class:y({chosen:s.chosen})},[s.chosen?(i(),n("path",{key:0,class:"fan",d:`M0 0 L${o.pToCX(s.pitch-.5)} ${o.pToCY(s.pitch-.5)} A${t.CLOCK_RADIUS} ${t.CLOCK_RADIUS} 0 0 1 ${o.pToCX(s.pitch+.5)} ${o.pToCY(s.pitch+.5)} Z`},null,8,es)):a("",!0),c("line",{x1:o.pToCX(s.pitch),y1:o.pToCY(s.pitch),x2:o.pToCX(s.pitch,.98),y2:o.pToCY(s.pitch,.98)},null,8,cs),c("circle",{class:"dot",cx:o.pToCX(s.pitch),cy:o.pToCY(s.pitch),onClick:m=>s.chosen=!s.chosen},null,8,ts)],2))),128))]),t.focusPoints[0]?(i(),n("g",os,[c("line",{x1:0,y1:0,x2:o.pToCX(t.focusPoints[0].x),y2:o.pToCY(t.focusPoints[0].x)},null,8,ns),c("circle",{class:"dot",cx:o.pToCX(t.focusPoints[0].x),cy:o.pToCY(t.focusPoints[0].x)},null,8,is)])):a("",!0)],40,Z))]),c("header",null,[c("div",ls,[c("div",rs,[c("img",{src:t.url12Equal,style:{zoom:3}},null,8,hs)])])])])),[[g,o.onResize]])}const ys=k(w,[["render",us],["__scopeId","data-v-e8e4e61e"]]);export{ys as default};
