import{_ as is,a as os,b as ls,c as ps,d as _s,e as us,f as gs,g as cs,h as fs,i as ds,j as hs,k as vs,l as ms,m as bs,n as ys,o as ws,p as Ts,q as Ss,r as Ms,s as Es,t as Rs,u as Ls,v as As,w as xs,x as Is,y as Os,z as Ns,A as Fs,B as Ps,C as Cs,D as Us,E as ks,F as Gs,G as Hs,H as Bs,I as js,J as Ds,K as Ks,L as Vs,M as zs,N as Xs,O as qs,P as Ws,Q as Ys,R as Qs,S as Js,T as Zs,U as $s,V as ea,W as sa,X as aa,Y as ta,Z as na,$ as ra,a0 as ia,a1 as oa,a2 as la,a3 as pa,a4 as _a,a5 as ua,a6 as ga,a7 as ca,a8 as fa,a9 as da,aa as ha,ab as va,ac as ma,ad as ba,ae as ya,af as wa,ag as Ta,ah as Sa,ai as Ma,aj as Ea,ak as Ra,al as La,am as Aa,an as xa,ao as Ia,ap as Oa,aq as Na,ar as Fa,as as Pa,at as Ca,au as Ua,av as ka,aw as Ga,ax as Ha,ay as Ba,az as ja,aA as Da,aB as Ka,aC as Va,aD as za,aE as Xa,aF as qa,aG as Wa,aH as Ya,aI as Qa,aJ as Ja,aK as Za,aL as $a,aM as et,aN as st,aO as at,aP as tt,aQ as nt,aR as rt,aS as it,aT as ot,aU as lt,aV as pt,aW as _t,aX as ut,aY as gt,aZ as ct,a_ as ft,a$ as dt,b0 as ht,b1 as vt,b2 as mt,b3 as bt,b4 as yt,b5 as wt,b6 as Tt,b7 as St,b8 as Mt,b9 as Et,ba as Rt,bb as Lt,bc as At,bd as xt,be as It,bf as Ot,bg as Nt,bh as Ft,bi as Pt,bj as Ct,bk as Ut,bl as kt,bm as Gt,bn as Ht,bo as Bt,bp as jt,bq as Dt,br as Kt,bs as Vt,bt as zt,bu as Xt,bv as qt,bw as Wt,bx as Yt,by as Qt,bz as Jt,bA as Zt,bB as $t,bC as en,bD as sn,bE as an,bF as tn,bG as nn,bH as rn,bI as on,bJ as ln,bK as pn,bL as _n,bM as un,bN as gn,bO as cn,bP as fn,bQ as dn,bR as hn,bS as vn,bT as mn,bU as bn,bV as yn,bW as wn,bX as Tn,bY as Sn,bZ as Mn,b_ as En,b$ as Rn,c0 as Ln,c1 as An,c2 as xn,c3 as In,c4 as On,c5 as Nn,c6 as Fn,c7 as Pn,c8 as Cn,c9 as Un,ca as kn,cb as Gn,cc as Hn,cd as Bn,ce as Ae,cf as jn,cg as Dn,ch as Kn,ci as Vn}from"./mappingSource-BXFNLvg6.js";import{r as zn}from"./vue-resize-directive-CDf_Yp3t.js";import{L as xe,b as Y,F as Ie,c as Q,a as F,d as J,e as Xn,I as qn,T as Wn,f as Yn,B as Oe,R as Qn,g as Ne,N as Jn,h as Zn,i as $n,j as Fe,k as er,l as ge,m as sr,n as ar,P as tr,o as Pe,p as nr,q as rr,r as Ce,s as Ue,t as ir,u as or,v as lr,w as pr,x as _r,y as ur,z as gr,A as cr,G as ce,E as ze,H as fr,O as dr,J as hr,K as ke,U as vr,W as mr,X as Xe,Y as Ge,Z as He,_ as br,$ as Be,a0 as yr,a1 as wr,V as $,a2 as Tr,a3 as Sr,a4 as Mr,D as fe,a5 as je,a6 as Er,a7 as Rr,a8 as Lr,a9 as Ar,aa as xr,ab as Ir,ac as Or,ad as Nr,ae as Fr,af as Pr,ag as Cr}from"./three.module-x1Cfo4R0.js";import{a as Ur}from"./delay-DTFr9Qec.js";import{L as kr}from"./label3D-Z-TrrnsP.js";import{Q as Gr}from"./quit-cleaner-U9OkpSad.js";import{A as Hr}from"./accelerometer-C2noNsYo.js";import{_ as Br,y as jr,w as De,c as ae,o as te,a as Z,F as Dr,g as Kr,n as Vr,p as zr,z as Xr,B as qr,v as Wr,j as Ke}from"./router-JVv0ElFj.js";var Yr=function(){function c(e){xe.call(this,e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(s){return new E(s)}),this.register(function(s){return new A(s)}),this.register(function(s){return new K(s)}),this.register(function(s){return new D(s)}),this.register(function(s){return new S(s)}),this.register(function(s){return new de(s)})}c.prototype=Object.assign(Object.create(xe.prototype),{constructor:c,load:function(e,s,n,a){var t=this,r;this.resourcePath!==""?r=this.resourcePath:this.path!==""?r=this.path:r=Y.extractUrlBase(e),this.manager.itemStart(e);var o=function(l){a?a(l):console.error(l),t.manager.itemError(e),t.manager.itemEnd(e)},i=new Ie(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,function(l){try{t.parse(l,r,function(p){s(p),t.manager.itemEnd(e)},o)}catch(p){o(p)}},n,o)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')},setKTX2Loader:function(e){return this.ktx2Loader=e,this},setMeshoptDecoder:function(e){return this.meshoptDecoder=e,this},register:function(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this},unregister:function(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this},parse:function(e,s,n,a){var t,r={},o={};if(typeof e=="string")t=e;else{var i=Y.decodeText(new Uint8Array(e,0,4));if(i===he){try{r[d.KHR_BINARY_GLTF]=new qe(e)}catch(f){a&&a(f);return}t=r[d.KHR_BINARY_GLTF].content}else t=Y.decodeText(new Uint8Array(e))}var l=JSON.parse(t);if(l.asset===void 0||l.asset.version[0]<2){a&&a(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}var p=new y(l,{path:s||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});p.fileLoader.setRequestHeader(this.requestHeader);for(var _=0;_<this.pluginCallbacks.length;_++){var u=this.pluginCallbacks[_](p);o[u.name]=u,r[u.name]=!0}if(l.extensionsUsed)for(var _=0;_<l.extensionsUsed.length;++_){var g=l.extensionsUsed[_],v=l.extensionsRequired||[];switch(g){case d.KHR_MATERIALS_UNLIT:r[g]=new L;break;case d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:r[g]=new We;break;case d.KHR_DRACO_MESH_COMPRESSION:r[g]=new me(l,this.dracoLoader);break;case d.KHR_TEXTURE_TRANSFORM:r[g]=new be;break;case d.KHR_MESH_QUANTIZATION:r[g]=new Ye;break;default:v.indexOf(g)>=0&&o[g]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+g+'".')}}p.setExtensions(r),p.setPlugins(o),p.parse(n,a)}});function h(){var e={};return{get:function(s){return e[s]},add:function(s,n){e[s]=n},remove:function(s){delete e[s]},removeAll:function(){e={}}}}var d={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};function S(e){this.parser=e,this.name=d.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}S.prototype._markDefs=function(){for(var e=this.parser,s=this.parser.json.nodes||[],n=0,a=s.length;n<a;n++){var t=s[n];t.extensions&&t.extensions[this.name]&&t.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,t.extensions[this.name].light)}},S.prototype._loadLight=function(e){var s=this.parser,n="light:"+e,a=s.cache.get(n);if(a)return a;var t=s.json,r=t.extensions&&t.extensions[this.name]||{},o=r.lights||[],i=o[e],l,p=new F(16777215);i.color!==void 0&&p.fromArray(i.color);var _=i.range!==void 0?i.range:0;switch(i.type){case"directional":l=new fe(p),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new Mr(p),l.distance=_;break;case"spot":l=new Sr(p),l.distance=_,i.spot=i.spot||{},i.spot.innerConeAngle=i.spot.innerConeAngle!==void 0?i.spot.innerConeAngle:0,i.spot.outerConeAngle=i.spot.outerConeAngle!==void 0?i.spot.outerConeAngle:Math.PI/4,l.angle=i.spot.outerConeAngle,l.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+i.type)}return l.position.set(0,0,0),l.decay=2,i.intensity!==void 0&&(l.intensity=i.intensity),l.name=s.createUniqueName(i.name||"light_"+e),a=Promise.resolve(l),s.cache.add(n,a),a},S.prototype.createNodeAttachment=function(e){var s=this,n=this.parser,a=n.json,t=a.nodes[e],r=t.extensions&&t.extensions[this.name]||{},o=r.light;return o===void 0?null:this._loadLight(o).then(function(i){return n._getNodeRef(s.cache,o,i)})};function L(){this.name=d.KHR_MATERIALS_UNLIT}L.prototype.getMaterialType=function(){return Q},L.prototype.extendParams=function(e,s,n){var a=[];e.color=new F(1,1,1),e.opacity=1;var t=s.pbrMetallicRoughness;if(t){if(Array.isArray(t.baseColorFactor)){var r=t.baseColorFactor;e.color.fromArray(r),e.opacity=r[3]}t.baseColorTexture!==void 0&&a.push(n.assignTexture(e,"map",t.baseColorTexture))}return Promise.all(a)};function E(e){this.parser=e,this.name=d.KHR_MATERIALS_CLEARCOAT}E.prototype.getMaterialType=function(e){var s=this.parser,n=s.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:je},E.prototype.extendMaterialParams=function(e,s){var n=this.parser,a=n.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();var t=[],r=a.extensions[this.name];if(r.clearcoatFactor!==void 0&&(s.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&t.push(n.assignTexture(s,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(s.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&t.push(n.assignTexture(s,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(t.push(n.assignTexture(s,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){var o=r.clearcoatNormalTexture.scale;s.clearcoatNormalScale=new Ce(o,-o)}return Promise.all(t)};function D(e){this.parser=e,this.name=d.KHR_MATERIALS_TRANSMISSION}D.prototype.getMaterialType=function(e){var s=this.parser,n=s.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:je},D.prototype.extendMaterialParams=function(e,s){var n=this.parser,a=n.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();var t=[],r=a.extensions[this.name];return r.transmissionFactor!==void 0&&(s.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&t.push(n.assignTexture(s,"transmissionMap",r.transmissionTexture)),Promise.all(t)};function A(e){this.parser=e,this.name=d.KHR_TEXTURE_BASISU}A.prototype.loadTexture=function(e){var s=this.parser,n=s.json,a=n.textures[e];if(!a.extensions||!a.extensions[this.name])return null;var t=a.extensions[this.name],r=n.images[t.source],o=s.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return s.loadTextureImage(e,r,o)};function K(e){this.parser=e,this.name=d.EXT_TEXTURE_WEBP,this.isSupported=null}K.prototype.loadTexture=function(e){var s=this.name,n=this.parser,a=n.json,t=a.textures[e];if(!t.extensions||!t.extensions[s])return null;var r=t.extensions[s],o=a.images[r.source],i=n.textureLoader;if(o.uri){var l=n.options.manager.getHandler(o.uri);l!==null&&(i=l)}return this.detectSupport().then(function(p){if(p)return n.loadTextureImage(e,o,i);if(a.extensionsRequired&&a.extensionsRequired.indexOf(s)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})},K.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise(function(e){var s=new Image;s.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",s.onload=s.onerror=function(){e(s.height===1)}})),this.isSupported};function de(e){this.name=d.EXT_MESHOPT_COMPRESSION,this.parser=e}de.prototype.loadBufferView=function(e){var s=this.parser.json,n=s.bufferViews[e];if(n.extensions&&n.extensions[this.name]){var a=n.extensions[this.name],t=this.parser.getDependency("buffer",a.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(s.extensionsRequired&&s.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([t,r.ready]).then(function(o){var i=a.byteOffset||0,l=a.byteLength||0,p=a.count,_=a.byteStride,u=new ArrayBuffer(p*_),g=new Uint8Array(o[0],i,l);return r.decodeGltfBuffer(new Uint8Array(u),p,_,g,a.mode,a.filter),u})}else return null};var he="glTF",V=12,ve={JSON:1313821514,BIN:5130562};function qe(e){this.name=d.KHR_BINARY_GLTF,this.content=null,this.body=null;var s=new DataView(e,0,V);if(this.header={magic:Y.decodeText(new Uint8Array(e.slice(0,4))),version:s.getUint32(4,!0),length:s.getUint32(8,!0)},this.header.magic!==he)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=this.header.length-V,a=new DataView(e,V),t=0;t<n;){var r=a.getUint32(t,!0);t+=4;var o=a.getUint32(t,!0);if(t+=4,o===ve.JSON){var i=new Uint8Array(e,V+t,r);this.content=Y.decodeText(i)}else if(o===ve.BIN){var l=V+t;this.body=e.slice(l,l+r)}t+=r}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}function me(e,s){if(!s)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=d.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=s,this.dracoLoader.preload()}me.prototype.decodePrimitive=function(e,s){var n=this.json,a=this.dracoLoader,t=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,o={},i={},l={};for(var p in r){var _=re[p]||p.toLowerCase();o[_]=r[p]}for(p in e.attributes){var _=re[p]||p.toLowerCase();if(r[p]!==void 0){var u=n.accessors[e.attributes[p]],g=ne[u.componentType];l[_]=g,i[_]=u.normalized===!0}}return s.getDependency("bufferView",t).then(function(v){return new Promise(function(f){a.decodeDracoFile(v,function(b){for(var T in b.attributes){var w=b.attributes[T],m=i[T];m!==void 0&&(w.normalized=m)}f(b)},o,l)})})};function be(){this.name=d.KHR_TEXTURE_TRANSFORM}be.prototype.extendTexture=function(e,s){return e=e.clone(),s.offset!==void 0&&e.offset.fromArray(s.offset),s.rotation!==void 0&&(e.rotation=s.rotation),s.scale!==void 0&&e.repeat.fromArray(s.scale),s.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e};function k(e){J.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var s=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),n=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),a=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	texelSpecular = sRGBToLinear( texelSpecular );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),t=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),r=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),o={specular:{value:new F().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=o,this.onBeforeCompile=function(i){for(var l in o)i.uniforms[l]=o[l];i.fragmentShader=i.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",s).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",a).replace("#include <metalnessmap_fragment>",t).replace("#include <lights_physical_fragment>",r)},Object.defineProperties(this,{specular:{get:function(){return o.specular.value},set:function(i){o.specular.value=i}},specularMap:{get:function(){return o.specularMap.value},set:function(i){o.specularMap.value=i,i?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return o.glossiness.value},set:function(i){o.glossiness.value=i}},glossinessMap:{get:function(){return o.glossinessMap.value},set:function(i){o.glossinessMap.value=i,i?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}k.prototype=Object.create(J.prototype),k.prototype.constructor=k,k.prototype.copy=function(e){return J.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this};function We(){return{name:d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return k},extendParams:function(e,s,n){var a=s.extensions[this.name];e.color=new F(1,1,1),e.opacity=1;var t=[];if(Array.isArray(a.diffuseFactor)){var r=a.diffuseFactor;e.color.fromArray(r),e.opacity=r[3]}if(a.diffuseTexture!==void 0&&t.push(n.assignTexture(e,"map",a.diffuseTexture)),e.emissive=new F(0,0,0),e.glossiness=a.glossinessFactor!==void 0?a.glossinessFactor:1,e.specular=new F(1,1,1),Array.isArray(a.specularFactor)&&e.specular.fromArray(a.specularFactor),a.specularGlossinessTexture!==void 0){var o=a.specularGlossinessTexture;t.push(n.assignTexture(e,"glossinessMap",o)),t.push(n.assignTexture(e,"specularMap",o))}return Promise.all(t)},createMaterial:function(e){var s=new k(e);return s.fog=!0,s.color=e.color,s.map=e.map===void 0?null:e.map,s.lightMap=null,s.lightMapIntensity=1,s.aoMap=e.aoMap===void 0?null:e.aoMap,s.aoMapIntensity=1,s.emissive=e.emissive,s.emissiveIntensity=1,s.emissiveMap=e.emissiveMap===void 0?null:e.emissiveMap,s.bumpMap=e.bumpMap===void 0?null:e.bumpMap,s.bumpScale=1,s.normalMap=e.normalMap===void 0?null:e.normalMap,s.normalMapType=Xn,e.normalScale&&(s.normalScale=e.normalScale),s.displacementMap=null,s.displacementScale=1,s.displacementBias=0,s.specularMap=e.specularMap===void 0?null:e.specularMap,s.specular=e.specular,s.glossinessMap=e.glossinessMap===void 0?null:e.glossinessMap,s.glossiness=e.glossiness,s.alphaMap=null,s.envMap=e.envMap===void 0?null:e.envMap,s.envMapIntensity=1,s.refractionRatio=.98,s}}}function Ye(){this.name=d.KHR_MESH_QUANTIZATION}function I(e,s,n,a){He.call(this,e,s,n,a)}I.prototype=Object.create(He.prototype),I.prototype.constructor=I,I.prototype.copySampleValue_=function(e){for(var s=this.resultBuffer,n=this.sampleValues,a=this.valueSize,t=e*a*3+a,r=0;r!==a;r++)s[r]=n[t+r];return s},I.prototype.beforeStart_=I.prototype.copySampleValue_,I.prototype.afterEnd_=I.prototype.copySampleValue_,I.prototype.interpolate_=function(e,s,n,a){for(var t=this.resultBuffer,r=this.sampleValues,o=this.valueSize,i=o*2,l=o*3,p=a-s,_=(n-s)/p,u=_*_,g=u*_,v=e*l,f=v-l,b=-2*g+3*u,T=g-u,w=1-b,m=T-u+_,M=0;M!==o;M++){var C=r[f+M+o],X=r[f+M+i]*p,B=r[v+M+o],x=r[v+M]*p;t[M]=w*C+m*X+b*B+T*x}return t};var O={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},ne={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ye={9728:er,9729:Fe,9984:$n,9985:Zn,9986:Jn,9987:Ne},we={33071:ar,33648:sr,10497:ge},Te={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},re={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},P={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Qe={CUBICSPLINE:void 0,LINEAR:ke,STEP:hr},ie={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Se(e,s){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(s)&&/^\//.test(e)&&(s=s.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:s+e)}function Je(e){return e.DefaultMaterial===void 0&&(e.DefaultMaterial=new J({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:br})),e.DefaultMaterial}function z(e,s,n){for(var a in n.extensions)e[a]===void 0&&(s.userData.gltfExtensions=s.userData.gltfExtensions||{},s.userData.gltfExtensions[a]=n.extensions[a])}function G(e,s){s.extras!==void 0&&(typeof s.extras=="object"?Object.assign(e.userData,s.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+s.extras))}function Ze(e,s,n){for(var a=!1,t=!1,r=0,o=s.length;r<o;r++){var i=s[r];if(i.POSITION!==void 0&&(a=!0),i.NORMAL!==void 0&&(t=!0),a&&t)break}if(!a&&!t)return Promise.resolve(e);for(var l=[],p=[],r=0,o=s.length;r<o;r++){var i=s[r];if(a){var _=i.POSITION!==void 0?n.getDependency("accessor",i.POSITION):e.attributes.position;l.push(_)}if(t){var _=i.NORMAL!==void 0?n.getDependency("accessor",i.NORMAL):e.attributes.normal;p.push(_)}}return Promise.all([Promise.all(l),Promise.all(p)]).then(function(u){var g=u[0],v=u[1];return a&&(e.morphAttributes.position=g),t&&(e.morphAttributes.normal=v),e.morphTargetsRelative=!0,e})}function $e(e,s){if(e.updateMorphTargets(),s.weights!==void 0)for(var n=0,a=s.weights.length;n<a;n++)e.morphTargetInfluences[n]=s.weights[n];if(s.extras&&Array.isArray(s.extras.targetNames)){var t=s.extras.targetNames;if(e.morphTargetInfluences.length===t.length){e.morphTargetDictionary={};for(var n=0,a=t.length;n<a;n++)e.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function es(e){var s=e.extensions&&e.extensions[d.KHR_DRACO_MESH_COMPRESSION],n;return s?n="draco:"+s.bufferView+":"+s.indices+":"+Me(s.attributes):n=e.indices+":"+Me(e.attributes)+":"+e.mode,n}function Me(e){for(var s="",n=Object.keys(e).sort(),a=0,t=n.length;a<t;a++)s+=n[a]+":"+e[n[a]]+";";return s}function y(e,s){this.json=e||{},this.extensions={},this.plugins={},this.options=s||{},this.cache=new h,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},typeof createImageBitmap<"u"&&/Firefox/.test(navigator.userAgent)===!1?this.textureLoader=new qn(this.options.manager):this.textureLoader=new Wn(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Ie(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}y.prototype.setExtensions=function(e){this.extensions=e},y.prototype.setPlugins=function(e){this.plugins=e},y.prototype.parse=function(e,s){var n=this,a=this.json,t=this.extensions;this.cache.removeAll(),this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(r){var o={scene:r[0][a.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:a.asset,parser:n,userData:{}};z(t,o,a),G(o,a),Promise.all(n._invokeAll(function(i){return i.afterRoot&&i.afterRoot(o)})).then(function(){e(o)})}).catch(s)},y.prototype._markDefs=function(){for(var e=this.json.nodes||[],s=this.json.skins||[],n=this.json.meshes||[],a=0,t=s.length;a<t;a++)for(var r=s[a].joints,o=0,i=r.length;o<i;o++)e[r[o]].isBone=!0;for(var l=0,p=e.length;l<p;l++){var _=e[l];_.mesh!==void 0&&(this._addNodeRef(this.meshCache,_.mesh),_.skin!==void 0&&(n[_.mesh].isSkinnedMesh=!0)),_.camera!==void 0&&this._addNodeRef(this.cameraCache,_.camera)}},y.prototype._addNodeRef=function(e,s){s!==void 0&&(e.refs[s]===void 0&&(e.refs[s]=e.uses[s]=0),e.refs[s]++)},y.prototype._getNodeRef=function(e,s,n){if(e.refs[s]<=1)return n;var a=n.clone();return a.name+="_instance_"+e.uses[s]++,a},y.prototype._invokeOne=function(e){var s=Object.values(this.plugins);s.push(this);for(var n=0;n<s.length;n++){var a=e(s[n]);if(a)return a}},y.prototype._invokeAll=function(e){var s=Object.values(this.plugins);s.unshift(this);for(var n=[],a=0;a<s.length;a++){var t=e(s[a]);t&&n.push(t)}return n},y.prototype.getDependency=function(e,s){var n=e+":"+s,a=this.cache.get(n);if(!a){switch(e){case"scene":a=this.loadScene(s);break;case"node":a=this.loadNode(s);break;case"mesh":a=this._invokeOne(function(t){return t.loadMesh&&t.loadMesh(s)});break;case"accessor":a=this.loadAccessor(s);break;case"bufferView":a=this._invokeOne(function(t){return t.loadBufferView&&t.loadBufferView(s)});break;case"buffer":a=this.loadBuffer(s);break;case"material":a=this._invokeOne(function(t){return t.loadMaterial&&t.loadMaterial(s)});break;case"texture":a=this._invokeOne(function(t){return t.loadTexture&&t.loadTexture(s)});break;case"skin":a=this.loadSkin(s);break;case"animation":a=this.loadAnimation(s);break;case"camera":a=this.loadCamera(s);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,a)}return a},y.prototype.getDependencies=function(e){var s=this.cache.get(e);if(!s){var n=this,a=this.json[e+(e==="mesh"?"es":"s")]||[];s=Promise.all(a.map(function(t,r){return n.getDependency(e,r)})),this.cache.add(e,s)}return s},y.prototype.loadBuffer=function(e){var s=this.json.buffers[e],n=this.fileLoader;if(s.type&&s.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+s.type+" buffer type is not supported.");if(s.uri===void 0&&e===0)return Promise.resolve(this.extensions[d.KHR_BINARY_GLTF].body);var a=this.options;return new Promise(function(t,r){n.load(Se(s.uri,a.path),t,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+s.uri+'".'))})})},y.prototype.loadBufferView=function(e){var s=this.json.bufferViews[e];return this.getDependency("buffer",s.buffer).then(function(n){var a=s.byteLength||0,t=s.byteOffset||0;return n.slice(t,t+a)})},y.prototype.loadAccessor=function(e){var s=this,n=this.json,a=this.json.accessors[e];if(a.bufferView===void 0&&a.sparse===void 0)return Promise.resolve(null);var t=[];return a.bufferView!==void 0?t.push(this.getDependency("bufferView",a.bufferView)):t.push(null),a.sparse!==void 0&&(t.push(this.getDependency("bufferView",a.sparse.indices.bufferView)),t.push(this.getDependency("bufferView",a.sparse.values.bufferView))),Promise.all(t).then(function(r){var o=r[0],i=Te[a.type],l=ne[a.componentType],p=l.BYTES_PER_ELEMENT,_=p*i,u=a.byteOffset||0,g=a.bufferView!==void 0?n.bufferViews[a.bufferView].byteStride:void 0,v=a.normalized===!0,f,b;if(g&&g!==_){var T=Math.floor(u/g),w="InterleavedBuffer:"+a.bufferView+":"+a.componentType+":"+T+":"+a.count,m=s.cache.get(w);m||(f=new l(o,T*g,a.count*g/p),m=new Yn(f,g/p),s.cache.add(w,m)),b=new Er(m,i,u%g/p,v)}else o===null?f=new l(a.count*i):f=new l(o,u,a.count*i),b=new Oe(f,i,v);if(a.sparse!==void 0){var M=Te.SCALAR,C=ne[a.sparse.indices.componentType],X=a.sparse.indices.byteOffset||0,B=a.sparse.values.byteOffset||0,x=new C(r[1],X,a.sparse.count*M),j=new l(r[2],B,a.sparse.count*i);o!==null&&(b=new Oe(b.array.slice(),b.itemSize,b.normalized));for(var R=0,oe=x.length;R<oe;R++){var H=x[R];if(b.setX(H,j[R*i]),i>=2&&b.setY(H,j[R*i+1]),i>=3&&b.setZ(H,j[R*i+2]),i>=4&&b.setW(H,j[R*i+3]),i>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return b})},y.prototype.loadTexture=function(e){var s=this.json,n=this.options,a=s.textures[e],t=s.images[a.source],r=this.textureLoader;if(t.uri){var o=n.manager.getHandler(t.uri);o!==null&&(r=o)}return this.loadTextureImage(e,t,r)},y.prototype.loadTextureImage=function(e,s,n){var a=this,t=this.json,r=this.options,o=t.textures[e],i=self.URL||self.webkitURL,l=s.uri,p=!1,_=!0;if(s.mimeType==="image/jpeg"&&(_=!1),s.bufferView!==void 0)l=a.getDependency("bufferView",s.bufferView).then(function(u){if(s.mimeType==="image/png"){var g=new DataView(u,25,1).getUint8(0,!1);_=g===6||g===4||g===3}p=!0;var v=new Blob([u],{type:s.mimeType});return l=i.createObjectURL(v),l});else if(s.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");return Promise.resolve(l).then(function(u){return new Promise(function(g,v){var f=g;n.isImageBitmapLoader===!0&&(f=function(b){g(new Rr(b))}),n.load(Se(u,r.path),f,void 0,v)})}).then(function(u){p===!0&&i.revokeObjectURL(l),u.flipY=!1,o.name&&(u.name=o.name),_||(u.format=Qn);var g=t.samplers||{},v=g[o.sampler]||{};return u.magFilter=ye[v.magFilter]||Fe,u.minFilter=ye[v.minFilter]||Ne,u.wrapS=we[v.wrapS]||ge,u.wrapT=we[v.wrapT]||ge,a.associations.set(u,{type:"textures",index:e}),u})},y.prototype.assignTexture=function(e,s,n){var a=this;return this.getDependency("texture",n.index).then(function(t){if(n.texCoord!==void 0&&n.texCoord!=0&&!(s==="aoMap"&&n.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+s+" not yet supported."),a.extensions[d.KHR_TEXTURE_TRANSFORM]){var r=n.extensions!==void 0?n.extensions[d.KHR_TEXTURE_TRANSFORM]:void 0;if(r){var o=a.associations.get(t);t=a.extensions[d.KHR_TEXTURE_TRANSFORM].extendTexture(t,r),a.associations.set(t,o)}}e[s]=t})},y.prototype.assignFinalMaterial=function(e){var s=e.geometry,n=e.material,a=s.attributes.tangent!==void 0,t=s.attributes.color!==void 0,r=s.attributes.normal===void 0,o=e.isSkinnedMesh===!0,i=Object.keys(s.morphAttributes).length>0,l=i&&s.morphAttributes.normal!==void 0;if(e.isPoints){var p="PointsMaterial:"+n.uuid,_=this.cache.get(p);_||(_=new tr,Pe.prototype.copy.call(_,n),_.color.copy(n.color),_.map=n.map,_.sizeAttenuation=!1,this.cache.add(p,_)),n=_}else if(e.isLine){var p="LineBasicMaterial:"+n.uuid,u=this.cache.get(p);u||(u=new nr,Pe.prototype.copy.call(u,n),u.color.copy(n.color),this.cache.add(p,u)),n=u}if(a||t||r||o||i){var p="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(p+="specular-glossiness:"),o&&(p+="skinning:"),a&&(p+="vertex-tangents:"),t&&(p+="vertex-colors:"),r&&(p+="flat-shading:"),i&&(p+="morph-targets:"),l&&(p+="morph-normals:");var g=this.cache.get(p);g||(g=n.clone(),o&&(g.skinning=!0),t&&(g.vertexColors=!0),r&&(g.flatShading=!0),i&&(g.morphTargets=!0),l&&(g.morphNormals=!0),a&&(g.vertexTangents=!0,g.normalScale&&(g.normalScale.y*=-1),g.clearcoatNormalScale&&(g.clearcoatNormalScale.y*=-1)),this.cache.add(p,g),this.associations.set(g,this.associations.get(n))),n=g}n.aoMap&&s.attributes.uv2===void 0&&s.attributes.uv!==void 0&&s.setAttribute("uv2",s.attributes.uv),e.material=n},y.prototype.getMaterialType=function(){return J},y.prototype.loadMaterial=function(e){var s=this,n=this.json,a=this.extensions,t=n.materials[e],r,o={},i=t.extensions||{},l=[];if(i[d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var p=a[d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];r=p.getMaterialType(),l.push(p.extendParams(o,t,s))}else if(i[d.KHR_MATERIALS_UNLIT]){var _=a[d.KHR_MATERIALS_UNLIT];r=_.getMaterialType(),l.push(_.extendParams(o,t,s))}else{var u=t.pbrMetallicRoughness||{};if(o.color=new F(1,1,1),o.opacity=1,Array.isArray(u.baseColorFactor)){var g=u.baseColorFactor;o.color.fromArray(g),o.opacity=g[3]}u.baseColorTexture!==void 0&&l.push(s.assignTexture(o,"map",u.baseColorTexture)),o.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,o.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(l.push(s.assignTexture(o,"metalnessMap",u.metallicRoughnessTexture)),l.push(s.assignTexture(o,"roughnessMap",u.metallicRoughnessTexture))),r=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,o)})))}t.doubleSided===!0&&(o.side=rr);var v=t.alphaMode||ie.OPAQUE;return v===ie.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,v===ie.MASK&&(o.alphaTest=t.alphaCutoff!==void 0?t.alphaCutoff:.5)),t.normalTexture!==void 0&&r!==Q&&(l.push(s.assignTexture(o,"normalMap",t.normalTexture)),o.normalScale=new Ce(1,-1),t.normalTexture.scale!==void 0&&o.normalScale.set(t.normalTexture.scale,-t.normalTexture.scale)),t.occlusionTexture!==void 0&&r!==Q&&(l.push(s.assignTexture(o,"aoMap",t.occlusionTexture)),t.occlusionTexture.strength!==void 0&&(o.aoMapIntensity=t.occlusionTexture.strength)),t.emissiveFactor!==void 0&&r!==Q&&(o.emissive=new F().fromArray(t.emissiveFactor)),t.emissiveTexture!==void 0&&r!==Q&&l.push(s.assignTexture(o,"emissiveMap",t.emissiveTexture)),Promise.all(l).then(function(){var f;return r===k?f=a[d.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):f=new r(o),t.name&&(f.name=t.name),f.map&&(f.map.encoding=Ue),f.emissiveMap&&(f.emissiveMap.encoding=Ue),G(f,t),s.associations.set(f,{type:"materials",index:e}),t.extensions&&z(a,f,t),f})},y.prototype.createUniqueName=function(e){for(var s=ir.sanitizeNodeName(e||""),n=s,a=1;this.nodeNamesUsed[n];++a)n=s+"_"+a;return this.nodeNamesUsed[n]=!0,n};function ss(e,s,n){var a=s.attributes,t=new wr;if(a.POSITION!==void 0){var r=n.json.accessors[a.POSITION],o=r.min,i=r.max;if(o!==void 0&&i!==void 0)t.set(new $(o[0],o[1],o[2]),new $(i[0],i[1],i[2]));else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;var l=s.targets;if(l!==void 0){for(var p=new $,_=new $,u=0,g=l.length;u<g;u++){var v=l[u];if(v.POSITION!==void 0){var r=n.json.accessors[v.POSITION],o=r.min,i=r.max;o!==void 0&&i!==void 0?(_.setX(Math.max(Math.abs(o[0]),Math.abs(i[0]))),_.setY(Math.max(Math.abs(o[1]),Math.abs(i[1]))),_.setZ(Math.max(Math.abs(o[2]),Math.abs(i[2]))),p.max(_)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}t.expandByVector(p)}e.boundingBox=t;var f=new Tr;t.getCenter(f.center),f.radius=t.min.distanceTo(t.max)/2,e.boundingSphere=f}function Ee(e,s,n){var a=s.attributes,t=[];function r(p,_){return n.getDependency("accessor",p).then(function(u){e.setAttribute(_,u)})}for(var o in a){var i=re[o]||o.toLowerCase();i in e.attributes||t.push(r(a[o],i))}if(s.indices!==void 0&&!e.index){var l=n.getDependency("accessor",s.indices).then(function(p){e.setIndex(p)});t.push(l)}return G(e,s),ss(e,s,n),Promise.all(t).then(function(){return s.targets!==void 0?Ze(e,s.targets,n):e})}function Re(e,s){var n=e.getIndex();if(n===null){var a=[],t=e.getAttribute("position");if(t!==void 0){for(var r=0;r<t.count;r++)a.push(r);e.setIndex(a),n=e.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e}var o=n.count-2,i=[];if(s===Be)for(var r=1;r<=o;r++)i.push(n.getX(0)),i.push(n.getX(r)),i.push(n.getX(r+1));else for(var r=0;r<o;r++)r%2===0?(i.push(n.getX(r)),i.push(n.getX(r+1)),i.push(n.getX(r+2))):(i.push(n.getX(r+2)),i.push(n.getX(r+1)),i.push(n.getX(r)));i.length/3!==o&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var l=e.clone();return l.setIndex(i),l}return y.prototype.loadGeometries=function(e){var s=this,n=this.extensions,a=this.primitiveCache;function t(g){return n[d.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(g,s).then(function(v){return Ee(v,g,s)})}for(var r=[],o=0,i=e.length;o<i;o++){var l=e[o],p=es(l),_=a[p];if(_)r.push(_.promise);else{var u;l.extensions&&l.extensions[d.KHR_DRACO_MESH_COMPRESSION]?u=t(l):u=Ee(new or,l,s),a[p]={primitive:l,promise:u},r.push(u)}}return Promise.all(r)},y.prototype.loadMesh=function(e){for(var s=this,n=this.json,a=this.extensions,t=n.meshes[e],r=t.primitives,o=[],i=0,l=r.length;i<l;i++){var p=r[i].material===void 0?Je(this.cache):this.getDependency("material",r[i].material);o.push(p)}return o.push(s.loadGeometries(r)),Promise.all(o).then(function(_){for(var u=_.slice(0,_.length-1),g=_[_.length-1],v=[],f=0,b=g.length;f<b;f++){var T=g[f],w=r[f],m,M=u[f];if(w.mode===O.TRIANGLES||w.mode===O.TRIANGLE_STRIP||w.mode===O.TRIANGLE_FAN||w.mode===void 0)m=t.isSkinnedMesh===!0?new lr(T,M):new pr(T,M),m.isSkinnedMesh===!0&&!m.geometry.attributes.skinWeight.normalized&&m.normalizeSkinWeights(),w.mode===O.TRIANGLE_STRIP?m.geometry=Re(m.geometry,Lr):w.mode===O.TRIANGLE_FAN&&(m.geometry=Re(m.geometry,Be));else if(w.mode===O.LINES)m=new _r(T,M);else if(w.mode===O.LINE_STRIP)m=new ur(T,M);else if(w.mode===O.LINE_LOOP)m=new gr(T,M);else if(w.mode===O.POINTS)m=new cr(T,M);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+w.mode);Object.keys(m.geometry.morphAttributes).length>0&&$e(m,t),m.name=s.createUniqueName(t.name||"mesh_"+e),G(m,t),w.extensions&&z(a,m,w),s.assignFinalMaterial(m),v.push(m)}if(v.length===1)return v[0];for(var C=new ce,f=0,b=v.length;f<b;f++)C.add(v[f]);return C})},y.prototype.loadCamera=function(e){var s,n=this.json.cameras[e],a=n[n.type];if(!a){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?s=new ze(fr.radToDeg(a.yfov),a.aspectRatio||1,a.znear||1,a.zfar||2e6):n.type==="orthographic"&&(s=new dr(-a.xmag,a.xmag,a.ymag,-a.ymag,a.znear,a.zfar)),n.name&&(s.name=this.createUniqueName(n.name)),G(s,n),Promise.resolve(s)},y.prototype.loadSkin=function(e){var s=this.json.skins[e],n={joints:s.joints};return s.inverseBindMatrices===void 0?Promise.resolve(n):this.getDependency("accessor",s.inverseBindMatrices).then(function(a){return n.inverseBindMatrices=a,n})},y.prototype.loadAnimation=function(e){for(var s=this.json,n=s.animations[e],a=[],t=[],r=[],o=[],i=[],l=0,p=n.channels.length;l<p;l++){var _=n.channels[l],u=n.samplers[_.sampler],g=_.target,v=g.node!==void 0?g.node:g.id,f=n.parameters!==void 0?n.parameters[u.input]:u.input,b=n.parameters!==void 0?n.parameters[u.output]:u.output;a.push(this.getDependency("node",v)),t.push(this.getDependency("accessor",f)),r.push(this.getDependency("accessor",b)),o.push(u),i.push(g)}return Promise.all([Promise.all(a),Promise.all(t),Promise.all(r),Promise.all(o),Promise.all(i)]).then(function(T){for(var w=T[0],m=T[1],M=T[2],C=T[3],X=T[4],B=[],x=0,j=w.length;x<j;x++){var R=w[x],oe=m[x],H=M[x],le=C[x],pe=X[x];if(R!==void 0){R.updateMatrix(),R.matrixAutoUpdate=!0;var ee;switch(P[pe.path]){case P.weights:ee=Ir;break;case P.rotation:ee=xr;break;case P.position:case P.scale:default:ee=Ar;break}var as=R.name?R.name:R.uuid,ts=le.interpolation!==void 0?Qe[le.interpolation]:ke,se=[];P[pe.path]===P.weights?R.traverse(function(W){W.isMesh===!0&&W.morphTargetInfluences&&se.push(W.name?W.name:W.uuid)}):se.push(as);var N=H.array;if(H.normalized){var q;if(N.constructor===Int8Array)q=1/127;else if(N.constructor===Uint8Array)q=1/255;else if(N.constructor==Int16Array)q=1/32767;else if(N.constructor===Uint16Array)q=1/65535;else throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");for(var Le=new Float32Array(N.length),U=0,_e=N.length;U<_e;U++)Le[U]=N[U]*q;N=Le}for(var U=0,_e=se.length;U<_e;U++){var ue=new ee(se[U]+"."+P[pe.path],oe.array,N,ts);le.interpolation==="CUBICSPLINE"&&(ue.createInterpolant=function(rs){return new I(this.times,this.values,this.getValueSize()/3,rs)},ue.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),B.push(ue)}}}var ns=n.name?n.name:"animation_"+e;return new vr(ns,void 0,B)})},y.prototype.loadNode=function(e){var s=this.json,n=this.extensions,a=this,t=s.nodes[e],r=t.name?a.createUniqueName(t.name):"";return function(){var o=[];return t.mesh!==void 0&&o.push(a.getDependency("mesh",t.mesh).then(function(i){var l=a._getNodeRef(a.meshCache,t.mesh,i);return t.weights!==void 0&&l.traverse(function(p){if(p.isMesh)for(var _=0,u=t.weights.length;_<u;_++)p.morphTargetInfluences[_]=t.weights[_]}),l})),t.camera!==void 0&&o.push(a.getDependency("camera",t.camera).then(function(i){return a._getNodeRef(a.cameraCache,t.camera,i)})),a._invokeAll(function(i){return i.createNodeAttachment&&i.createNodeAttachment(e)}).forEach(function(i){o.push(i)}),Promise.all(o)}().then(function(o){var i;if(t.isBone===!0?i=new mr:o.length>1?i=new ce:o.length===1?i=o[0]:i=new Xe,i!==o[0])for(var l=0,p=o.length;l<p;l++)i.add(o[l]);if(t.name&&(i.userData.name=t.name,i.name=r),G(i,t),t.extensions&&z(n,i,t),t.matrix!==void 0){var _=new Ge;_.fromArray(t.matrix),i.applyMatrix4(_)}else t.translation!==void 0&&i.position.fromArray(t.translation),t.rotation!==void 0&&i.quaternion.fromArray(t.rotation),t.scale!==void 0&&i.scale.fromArray(t.scale);return a.associations.set(i,{type:"nodes",index:e}),i})},y.prototype.loadScene=function(){function e(s,n,a,t){var r=a.nodes[s];return t.getDependency("node",s).then(function(o){if(r.skin===void 0)return o;var i;return t.getDependency("skin",r.skin).then(function(l){i=l;for(var p=[],_=0,u=i.joints.length;_<u;_++)p.push(t.getDependency("node",i.joints[_]));return Promise.all(p)}).then(function(l){return o.traverse(function(p){if(p.isMesh){for(var _=[],u=[],g=0,v=l.length;g<v;g++){var f=l[g];if(f){_.push(f);var b=new Ge;i.inverseBindMatrices!==void 0&&b.fromArray(i.inverseBindMatrices.array,g*16),u.push(b)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',i.joints[g])}p.bind(new yr(_,u),p.matrixWorld)}}),o})}).then(function(o){n.add(o);var i=[];if(r.children)for(var l=r.children,p=0,_=l.length;p<_;p++){var u=l[p];i.push(e(u,o,a,t))}return Promise.all(i)})}return function(n){var a=this.json,t=this.extensions,r=this.json.scenes[n],o=this,i=new ce;r.name&&(i.name=o.createUniqueName(r.name)),G(i,r),r.extensions&&z(t,i,r);for(var l=r.nodes||[],p=[],_=0,u=l.length;_<u;_++)p.push(e(l[_],i,a,o));return Promise.all(p).then(function(){return i})}}(),c}();const Qr=(c,h,d)=>new $(c*Math.sin(h)*Math.cos(d),c*Math.cos(h),c*Math.sin(h)*Math.sin(d)),Ve=4e-4,Jr=new Yr,Zr={name:"mesh-viewer",directives:{resize:zn},mixins:[Gr,Hr],props:{light:{default:"white"},entities:Array,showStatus:{default:!1},cameraInit:{type:Object,default:()=>({radius:6,theta:0,phi:0})}},data(){return{size:{width:800,height:800},fps:0,labels:[]}},mounted(){this.initializeRenderer(),this.createScene(),this.render()},beforeDestroy(){this.rendererActive=!1},methods:{onResize(){this.size={width:this.$el.clientWidth,height:this.$el.clientHeight}},initializeRenderer(){this.renderer=new Fr({antialias:!0,canvas:this.$refs.canvas,alpha:!0}),this.renderer.setClearColor(new F("lightblue"),1),this.renderer.setSize(this.size.width,this.size.height,!1),this.camera=new ze(60,this.size.width/this.size.height,.1,100),this.viewTheta=this.cameraInit.theta+Math.PI*.5,this.viewPhi=this.cameraInit.phi+Math.PI*.5,this.viewRadius=this.cameraInit.radius,this.scene=new Pr;const c=new fe(this.light,1);c.position.set(-30,100,60),c.target=this.scene,this.scene.add(c);const h=new fe("lightblue",.4);h.position.set(0,1e3,0),h.target=this.scene,this.scene.add(h),this.scene.add(new Cr("#525f63")),this.rendererActive=!0},async render(){let c=performance.now(),h=Math.floor(c/1e3),d=0;for(;this.rendererActive;){this.sensorVelocity&&(this.viewTheta+=this.sensorVelocity[1]*Ve,this.viewPhi+=this.sensorVelocity[0]*Ve*.1,this.viewTheta=Math.max(Math.min(this.viewTheta,Math.PI-.01),.01)),this.camera.position.copy(Qr(this.viewRadius,this.viewTheta,this.viewPhi)),this.camera.lookAt(0,0,0),this.renderer.render(this.scene,this.camera),this.updateLabels(),++d;const S=performance.now(),L=Math.floor(S/1e3);L>h&&(this.fps=d/(L-h),d=0,h=L),c=S,await Ur()}},async loadByObjectLoader({default:c}){return await new Promise(h=>new Nr().parse(c,h))},async loadByGltfLoader({default:c}){return new Promise((h,d)=>{Jr.load(c,function(S){h(S.scene)},void 0,S=>d(S))})},async createScene(){if(this.entities)for(const c of this.entities){const h=new Xe;this.scene.add(h);let d=null;if(/\.(glb|gltf)$/.test(c.prototype)){const S=new URL(Object.assign({"../assets/app-covers/SpiralPiano.png":Vn,"../assets/app-covers/chess-lab.png":Kn,"../assets/app-covers/cube-matrix.png":Dn,"../assets/app-covers/stylegan-mapping.png":jn,"../assets/chess-knight.json":Ae,"../assets/chess/bP.svg":Bn,"../assets/chess/concrete-ta.mp3":Hn,"../assets/chess/crown-black.svg":Gn,"../assets/chess/crown-white.svg":kn,"../assets/chess/unsheathed.mp3":Un,"../assets/chess/wP.svg":Cn,"../assets/chess/wood-ta.mp3":Pn,"../assets/coordinate-frame.gltf":Fn,"../assets/cube-algebra/1.png":Nn,"../assets/cube-algebra/2i-.png":On,"../assets/cube-algebra/2i.png":In,"../assets/cube-algebra/2j-.png":xn,"../assets/cube-algebra/2j.png":An,"../assets/cube-algebra/2k-.png":Ln,"../assets/cube-algebra/2k.png":Rn,"../assets/cube-algebra/i-.png":En,"../assets/cube-algebra/i-j-k.png":Mn,"../assets/cube-algebra/i-jk-.png":Sn,"../assets/cube-algebra/i.png":Tn,"../assets/cube-algebra/i2.png":wn,"../assets/cube-algebra/ij-k-.png":yn,"../assets/cube-algebra/ijk.png":bn,"../assets/cube-algebra/j-.png":mn,"../assets/cube-algebra/j.png":vn,"../assets/cube-algebra/j2.png":hn,"../assets/cube-algebra/k-.png":dn,"../assets/cube-algebra/k-j-i-.png":fn,"../assets/cube-algebra/k-ji.png":cn,"../assets/cube-algebra/k.png":gn,"../assets/cube-algebra/k2.png":un,"../assets/cube-algebra/kj-i.png":_n,"../assets/cube-algebra/kji-.png":pn,"../assets/cube-placeholder.drawio.svg":ln,"../assets/cube.gltf":on,"../assets/earth/earth_normal.jpg":rn,"../assets/earth/earth_specular.jpg":nn,"../assets/f=2^x_12.svg":tn,"../assets/fonts/free-fa-solid-900.woff2":an,"../assets/fonts/icon-fas.css":sn,"../assets/loading-5d.gif":en,"../assets/skybox-space/nx.jpg":$t,"../assets/skybox-space/ny.jpg":Zt,"../assets/skybox-space/nz.jpg":Jt,"../assets/skybox-space/px.jpg":Qt,"../assets/skybox-space/py.jpg":Yt,"../assets/skybox-space/pz.jpg":Wt,"../assets/stylegan-mapping/plane0,1/0.webp":qt,"../assets/stylegan-mapping/plane0,1/12.webp":Xt,"../assets/stylegan-mapping/plane0,1/16.webp":zt,"../assets/stylegan-mapping/plane0,1/20.webp":Vt,"../assets/stylegan-mapping/plane0,1/24.webp":Kt,"../assets/stylegan-mapping/plane0,1/28.webp":Dt,"../assets/stylegan-mapping/plane0,1/32.webp":jt,"../assets/stylegan-mapping/plane0,1/36.webp":Bt,"../assets/stylegan-mapping/plane0,1/4.webp":Ht,"../assets/stylegan-mapping/plane0,1/40.webp":Gt,"../assets/stylegan-mapping/plane0,1/44.webp":kt,"../assets/stylegan-mapping/plane0,1/48.webp":Ut,"../assets/stylegan-mapping/plane0,1/52.webp":Ct,"../assets/stylegan-mapping/plane0,1/56.webp":Pt,"../assets/stylegan-mapping/plane0,1/60.webp":Ft,"../assets/stylegan-mapping/plane0,1/64.webp":Nt,"../assets/stylegan-mapping/plane0,1/68.webp":Ot,"../assets/stylegan-mapping/plane0,1/72.webp":It,"../assets/stylegan-mapping/plane0,1/76.webp":xt,"../assets/stylegan-mapping/plane0,1/8.webp":At,"../assets/stylegan-mapping/plane0,1/80.webp":Lt,"../assets/stylegan-mapping/plane0,1/84.webp":Rt,"../assets/stylegan-mapping/plane0,1/88.webp":Et,"../assets/stylegan-mapping/plane0,1/92.webp":Mt,"../assets/stylegan-mapping/plane0,1/mappingSource.dat":St,"../assets/stylegan-mapping/random-1/0.webp":Tt,"../assets/stylegan-mapping/random-1/12.webp":wt,"../assets/stylegan-mapping/random-1/16.webp":yt,"../assets/stylegan-mapping/random-1/20.webp":bt,"../assets/stylegan-mapping/random-1/24.webp":mt,"../assets/stylegan-mapping/random-1/28.webp":vt,"../assets/stylegan-mapping/random-1/32.webp":ht,"../assets/stylegan-mapping/random-1/36.webp":dt,"../assets/stylegan-mapping/random-1/4.webp":ft,"../assets/stylegan-mapping/random-1/40.webp":ct,"../assets/stylegan-mapping/random-1/44.webp":gt,"../assets/stylegan-mapping/random-1/48.webp":ut,"../assets/stylegan-mapping/random-1/52.webp":_t,"../assets/stylegan-mapping/random-1/56.webp":pt,"../assets/stylegan-mapping/random-1/60.webp":lt,"../assets/stylegan-mapping/random-1/64.webp":ot,"../assets/stylegan-mapping/random-1/68.webp":it,"../assets/stylegan-mapping/random-1/72.webp":rt,"../assets/stylegan-mapping/random-1/76.webp":nt,"../assets/stylegan-mapping/random-1/8.webp":tt,"../assets/stylegan-mapping/random-1/80.webp":at,"../assets/stylegan-mapping/random-1/84.webp":st,"../assets/stylegan-mapping/random-1/88.webp":et,"../assets/stylegan-mapping/random-1/92.webp":$a,"../assets/stylegan-mapping/random-1/mappingSource.dat":Za,"../assets/stylegan-mapping/random-2/0.webp":Ja,"../assets/stylegan-mapping/random-2/12.webp":Qa,"../assets/stylegan-mapping/random-2/16.webp":Ya,"../assets/stylegan-mapping/random-2/20.webp":Wa,"../assets/stylegan-mapping/random-2/24.webp":qa,"../assets/stylegan-mapping/random-2/28.webp":Xa,"../assets/stylegan-mapping/random-2/32.webp":za,"../assets/stylegan-mapping/random-2/36.webp":Va,"../assets/stylegan-mapping/random-2/4.webp":Ka,"../assets/stylegan-mapping/random-2/40.webp":Da,"../assets/stylegan-mapping/random-2/44.webp":ja,"../assets/stylegan-mapping/random-2/48.webp":Ba,"../assets/stylegan-mapping/random-2/52.webp":Ha,"../assets/stylegan-mapping/random-2/56.webp":Ga,"../assets/stylegan-mapping/random-2/60.webp":ka,"../assets/stylegan-mapping/random-2/64.webp":Ua,"../assets/stylegan-mapping/random-2/68.webp":Ca,"../assets/stylegan-mapping/random-2/72.webp":Pa,"../assets/stylegan-mapping/random-2/76.webp":Fa,"../assets/stylegan-mapping/random-2/8.webp":Na,"../assets/stylegan-mapping/random-2/80.webp":Oa,"../assets/stylegan-mapping/random-2/84.webp":Ia,"../assets/stylegan-mapping/random-2/88.webp":xa,"../assets/stylegan-mapping/random-2/92.webp":Aa,"../assets/stylegan-mapping/random-2/mappingSource.dat":La,"../assets/stylegan-mapping/random-3/0.webp":Ra,"../assets/stylegan-mapping/random-3/12.webp":Ea,"../assets/stylegan-mapping/random-3/16.webp":Ma,"../assets/stylegan-mapping/random-3/20.webp":Sa,"../assets/stylegan-mapping/random-3/24.webp":Ta,"../assets/stylegan-mapping/random-3/28.webp":wa,"../assets/stylegan-mapping/random-3/32.webp":ya,"../assets/stylegan-mapping/random-3/36.webp":ba,"../assets/stylegan-mapping/random-3/4.webp":ma,"../assets/stylegan-mapping/random-3/40.webp":va,"../assets/stylegan-mapping/random-3/44.webp":ha,"../assets/stylegan-mapping/random-3/48.webp":da,"../assets/stylegan-mapping/random-3/52.webp":fa,"../assets/stylegan-mapping/random-3/56.webp":ca,"../assets/stylegan-mapping/random-3/60.webp":ga,"../assets/stylegan-mapping/random-3/64.webp":ua,"../assets/stylegan-mapping/random-3/68.webp":_a,"../assets/stylegan-mapping/random-3/72.webp":pa,"../assets/stylegan-mapping/random-3/76.webp":la,"../assets/stylegan-mapping/random-3/8.webp":oa,"../assets/stylegan-mapping/random-3/80.webp":ia,"../assets/stylegan-mapping/random-3/84.webp":ra,"../assets/stylegan-mapping/random-3/88.webp":na,"../assets/stylegan-mapping/random-3/92.webp":ta,"../assets/stylegan-mapping/random-3/mappingSource.dat":aa,"../assets/stylegan-mapping/random-4/0.webp":sa,"../assets/stylegan-mapping/random-4/12.webp":ea,"../assets/stylegan-mapping/random-4/16.webp":$s,"../assets/stylegan-mapping/random-4/20.webp":Zs,"../assets/stylegan-mapping/random-4/24.webp":Js,"../assets/stylegan-mapping/random-4/28.webp":Qs,"../assets/stylegan-mapping/random-4/32.webp":Ys,"../assets/stylegan-mapping/random-4/36.webp":Ws,"../assets/stylegan-mapping/random-4/4.webp":qs,"../assets/stylegan-mapping/random-4/40.webp":Xs,"../assets/stylegan-mapping/random-4/44.webp":zs,"../assets/stylegan-mapping/random-4/48.webp":Vs,"../assets/stylegan-mapping/random-4/52.webp":Ks,"../assets/stylegan-mapping/random-4/56.webp":Ds,"../assets/stylegan-mapping/random-4/60.webp":js,"../assets/stylegan-mapping/random-4/64.webp":Bs,"../assets/stylegan-mapping/random-4/68.webp":Hs,"../assets/stylegan-mapping/random-4/72.webp":Gs,"../assets/stylegan-mapping/random-4/76.webp":ks,"../assets/stylegan-mapping/random-4/8.webp":Us,"../assets/stylegan-mapping/random-4/80.webp":Cs,"../assets/stylegan-mapping/random-4/84.webp":Ps,"../assets/stylegan-mapping/random-4/88.webp":Fs,"../assets/stylegan-mapping/random-4/92.webp":Ns,"../assets/stylegan-mapping/random-4/mappingSource.dat":Os,"../assets/stylegan-mapping/random-5/0.webp":Is,"../assets/stylegan-mapping/random-5/12.webp":xs,"../assets/stylegan-mapping/random-5/16.webp":As,"../assets/stylegan-mapping/random-5/20.webp":Ls,"../assets/stylegan-mapping/random-5/24.webp":Rs,"../assets/stylegan-mapping/random-5/28.webp":Es,"../assets/stylegan-mapping/random-5/32.webp":Ms,"../assets/stylegan-mapping/random-5/36.webp":Ss,"../assets/stylegan-mapping/random-5/4.webp":Ts,"../assets/stylegan-mapping/random-5/40.webp":ws,"../assets/stylegan-mapping/random-5/44.webp":ys,"../assets/stylegan-mapping/random-5/48.webp":bs,"../assets/stylegan-mapping/random-5/52.webp":ms,"../assets/stylegan-mapping/random-5/56.webp":vs,"../assets/stylegan-mapping/random-5/60.webp":hs,"../assets/stylegan-mapping/random-5/64.webp":ds,"../assets/stylegan-mapping/random-5/68.webp":fs,"../assets/stylegan-mapping/random-5/72.webp":cs,"../assets/stylegan-mapping/random-5/76.webp":gs,"../assets/stylegan-mapping/random-5/8.webp":us,"../assets/stylegan-mapping/random-5/80.webp":_s,"../assets/stylegan-mapping/random-5/84.webp":ps,"../assets/stylegan-mapping/random-5/88.webp":ls,"../assets/stylegan-mapping/random-5/92.webp":os,"../assets/stylegan-mapping/random-5/mappingSource.dat":is})[`../assets/${c.prototype}`],import.meta.url).href;d=await this.loadByGltfLoader({default:S})}else{const S=new URL(Object.assign({"../assets/chess-knight.json":Ae})[`../assets/${c.prototype}.json`],import.meta.url).href,E=await(await fetch(S)).json();d=await this.loadByObjectLoader({default:E})}if(h.add(d),c.name&&(h.name=c.name),c.position&&h.position.set(...c.position),c.quaternion?d.quaternion.set(...c.quaternion):c.euler&&d.quaternion.setFromEuler(new Or(...c.euler,"XZY")),c.scale&&d.scale.set(...c.scale),c.label){const S=new kr(h,this.camera,typeof c.label=="object"?c.label:{content:c.label,offset:c.labelOffset});this.labels.push(S)}}this.$emit("sceneReady")},updateLabels(){for(const c of this.labels)c.updatePosition();this.labels.length&&this.$forceUpdate()},onMouseMove(c){c.buttons===1&&(this.viewPhi+=c.movementX*.01,this.viewTheta-=c.movementY*.01,this.viewTheta=Math.max(Math.min(this.viewTheta,Math.PI-.01),.01))},onTouchMove(c){const h=c.touches[0];if(this.lastTouchPoint){const d=h.pageX-this.lastTouchPoint.pageX,S=h.pageY-this.lastTouchPoint.pageY;this.viewPhi+=d*.01,this.viewTheta-=S*.01,this.viewTheta=Math.max(Math.min(this.viewTheta,Math.PI-.01),.01)}this.lastTouchPoint={pageX:h.pageX,pageY:h.pageY}},onTouchEnd(){this.lastTouchPoint=null},onMouseWheel(c){this.viewRadius*=Math.exp(c.deltaY*.001)}},watch:{size(c){this.camera.aspect=c.width/c.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(c.width,c.height,!1)}}},$r={class:"mesh-viewer"},ei=["width","height"],si=["innerHTML"],ai={class:"status"},ti={key:0,class:"fps"};function ni(c,h,d,S,L,E){const D=jr("resize");return De((te(),ae("div",$r,[Z("article",{onMousemove:h[0]||(h[0]=(...A)=>E.onMouseMove&&E.onMouseMove(...A)),onMousewheel:h[1]||(h[1]=Ke((...A)=>E.onMouseWheel&&E.onMouseWheel(...A),["prevent"])),onTouchmove:h[2]||(h[2]=Ke((...A)=>E.onTouchMove&&E.onTouchMove(...A),["prevent"])),onTouchend:h[3]||(h[3]=(...A)=>E.onTouchEnd&&E.onTouchEnd(...A))},[Z("canvas",{ref:"canvas",width:L.size.width,height:L.size.height},null,8,ei),Z("div",null,[(te(!0),ae(Dr,null,Kr(L.labels,(A,K)=>(te(),ae("span",{class:"label",key:K,innerHTML:A.content,style:Vr({left:`${A.position.x*100}%`,top:`${A.position.y*100}%`})},null,12,si))),128))]),De(Z("span",ai,[L.fps?(te(),ae("span",ti,[h[4]||(h[4]=Xr("fps ",-1)),Z("em",null,qr(L.fps),1)])):zr("",!0)],512),[[Wr,d.showStatus]])],32)])),[[D,E.onResize]])}const fi=Br(Zr,[["render",ni],["__scopeId","data-v-80aa5cfc"]]);export{fi as default};
