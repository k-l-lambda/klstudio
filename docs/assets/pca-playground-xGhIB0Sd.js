import{r as se}from"./vue-resize-directive-CDf_Yp3t.js";import{g as ie}from"./_commonjsHelpers-DM6icglO.js";import{_ as ue,y as ce,w as fe,c as S,o as I,a as N,p as ee,F as re,g as te}from"./router-JVv0ElFj.js";var ne={exports:{}};(function(z){var w=function(){function P(n){var a=Q(n.length);return K(n,O(R(a,n),1/n.length))}function b(n){var a=R(T(n),n);return a}function V(n,a){var o;return a?o=O(n,1/(n.length-1)):o=O(n,1/n.length),o}function _(n){var a=ae(n);console.log(a);var o=a.U,i=a.S,u=i.map(function(c,e){var r={};return r.eigenvalue=c,r.vector=o.map(function(t,v){return-1*t[e]}),r});return u}function H(n,...a){var o=a.map(function(t){return t.vector}),i=P(n),u=R(o,T(i)),c=Q(n.length),e=O(R(c,n),-1/n.length),r=G(u,2);return{adjustedData:u,formattedAdjustedData:r,avgData:e,selectedVectors:o}}function A(n,a,o){var i=T(R(T(a),n)),u=K(i,o),c=G(u,2);return{originalData:u,formattedOriginalData:c}}function F(n,...a){var o=n.map(function(u){return u.eigenvalue}).reduce(function(u,c){return u+c}),i=a.map(function(u){return u.eigenvalue}).reduce(function(u,c){return u+c});return i/o}function Y(n){return _(V(b(P(n)),!1))}function oe(n){var a=Y(n),o=a.sort(function(u,c){return c.eigenvalue-u.eigenvalue});console.log("Sorted Vectors",o);var i=o[0].vector;return H(n,i)}function G(n,a){var o=Math.pow(10,a);return n.map(function(i,u){return i.map(function(c){return Math.round(c*o)/o})})}function R(n,a){if(!n[0]||!a[0]||!n.length||!a.length)throw new Error("Both A and B should be matrices");if(a.length!==n[0].length)throw new Error("Columns in A should be the same as the number of rows in B");for(var o=[],i=0;i<n.length;i++){o[i]=[];for(var u=0;u<a[0].length;u++)for(var c=0;c<n[0].length;c++)o[i][u]=o[i][u]?o[i][u]+n[i][c]*a[c][u]:n[i][c]*a[c][u]}return o}function K(n,a){if(!(n.length===a.length&&n[0].length===a[0].length))throw new Error("Both A and B should have the same dimensions");for(var o=[],i=0;i<n.length;i++){o[i]=[];for(var u=0;u<a[0].length;u++)o[i][u]=n[i][u]-a[i][u]}return o}function O(n,a){for(var o=[],i=0;i<n.length;i++){o[i]=[];for(var u=0;u<n[0].length;u++)o[i][u]=n[i][u]*a}return o}function Q(n){for(var a=[],o=0;o<n;o++){a[o]=[];for(var i=0;i<n;i++)a[o][i]=1}return a}function T(n){var a=L(n);return a[0].map(function(o,i){return n.map(function(u){return u[i]})})}function L(n){var a=JSON.stringify(n),o=JSON.parse(a);return o}function ae(n){var a,o=Math.pow(2,-52),i=1e-64/o,u=50,c=0,e=0,r=0,t=0,v=0,s=L(n),k=s.length,d=s[0].length;if(k<d)throw"Need more rows than columns";var x=new Array(d),m=new Array(d);for(e=0;e<d;e++)x[e]=m[e]=0;var M=Z([d,d],0);function J(E,C){return E=Math.abs(E),C=Math.abs(C),E>C?E*Math.sqrt(1+C*C/E/E):C==0?E:C*Math.sqrt(1+E*E/C/C)}function Z(E,C,W){typeof W>"u"&&(W=0);var X=E[W],q=Array(X),B;if(W===E.length-1){for(B=X-2;B>=0;B-=2)q[B+1]=C,q[B]=C;return B===-1&&(q[0]=C),q}for(B=X-1;B>=0;B--)q[B]=Z(E,C,W+1);return q}var h=0,l=0,g=0,D=0,y=0,p=0,f=0;for(e=0;e<d;e++){for(x[e]=l,f=0,v=e+1,r=e;r<k;r++)f+=s[r][e]*s[r][e];if(f<=i)l=0;else for(h=s[e][e],l=Math.sqrt(f),h>=0&&(l=-l),g=h*l-f,s[e][e]=h-l,r=v;r<d;r++){for(f=0,t=e;t<k;t++)f+=s[t][e]*s[t][r];for(h=f/g,t=e;t<k;t++)s[t][r]+=h*s[t][e]}for(m[e]=l,f=0,r=v;r<d;r++)f=f+s[e][r]*s[e][r];if(f<=i)l=0;else{for(h=s[e][e+1],l=Math.sqrt(f),h>=0&&(l=-l),g=h*l-f,s[e][e+1]=h-l,r=v;r<d;r++)x[r]=s[e][r]/g;for(r=v;r<k;r++){for(f=0,t=v;t<d;t++)f+=s[r][t]*s[e][t];for(t=v;t<d;t++)s[r][t]+=f*x[t]}}y=Math.abs(m[e])+Math.abs(x[e]),y>D&&(D=y)}for(e=d-1;e!=-1;e+=-1){if(l!=0){for(g=l*s[e][e+1],r=v;r<d;r++)M[r][e]=s[e][r]/g;for(r=v;r<d;r++){for(f=0,t=v;t<d;t++)f+=s[e][t]*M[t][r];for(t=v;t<d;t++)M[t][r]+=f*M[t][e]}}for(r=v;r<d;r++)M[e][r]=0,M[r][e]=0;M[e][e]=1,l=x[e],v=e}for(e=d-1;e!=-1;e+=-1){for(v=e+1,l=m[e],r=v;r<d;r++)s[e][r]=0;if(l!=0){for(g=s[e][e]*l,r=v;r<d;r++){for(f=0,t=v;t<k;t++)f+=s[t][e]*s[t][r];for(h=f/g,t=e;t<k;t++)s[t][r]+=h*s[t][e]}for(r=e;r<k;r++)s[r][e]=s[r][e]/l}else for(r=e;r<k;r++)s[r][e]=0;s[e][e]+=1}for(o=o*D,t=d-1;t!=-1;t+=-1)for(var U=0;U<u;U++){var $=!1;for(v=t;v!=-1;v+=-1){if(Math.abs(x[v])<=o){$=!0;break}if(Math.abs(m[v-1])<=o)break}if(!$){c=0,f=1;var j=v-1;for(e=v;e<t+1&&(h=f*x[e],x[e]=c*x[e],!(Math.abs(h)<=o));e++)for(l=m[e],g=J(h,l),m[e]=g,c=l/g,f=-h/g,r=0;r<k;r++)y=s[r][j],p=s[r][e],s[r][j]=y*c+p*f,s[r][e]=-y*f+p*c}if(p=m[t],v==t){if(p<0)for(m[t]=-p,r=0;r<d;r++)M[r][t]=-M[r][t];break}if(U>=u-1)throw"Error: no convergence.";for(D=m[v],y=m[t-1],l=x[t-1],g=x[t],h=((y-p)*(y+p)+(l-g)*(l+g))/(2*g*y),l=J(h,1),h<0?h=((D-p)*(D+p)+g*(y/(h-l)-g))/D:h=((D-p)*(D+p)+g*(y/(h+l)-g))/D,c=1,f=1,e=v+1;e<t+1;e++){for(l=x[e],y=m[e],g=f*l,l=c*l,p=J(h,g),x[e-1]=p,c=h/p,f=g/p,h=D*c+l*f,l=-D*f+l*c,g=y*f,y=y*c,r=0;r<d;r++)D=M[r][e-1],p=M[r][e],M[r][e-1]=D*c+p*f,M[r][e]=-D*f+p*c;for(p=J(h,g),m[e-1]=p,c=h/p,f=g/p,h=c*l+f*y,D=-f*l+c*y,r=0;r<k;r++)y=s[r][e-1],p=s[r][e],s[r][e-1]=y*c+p*f,s[r][e]=-y*f+p*c}x[v]=0,x[t]=h,m[t]=D}for(e=0;e<m.length;e++)m[e]<o&&(m[e]=0);for(e=0;e<d;e++)for(r=e-1;r>=0;r--)if(m[r]<m[e]){for(c=m[r],m[r]=m[e],m[e]=c,t=0;t<s.length;t++)a=s[t][e],s[t][e]=s[t][r],s[t][r]=a;for(t=0;t<M.length;t++)a=M[t][e],M[t][e]=M[t][r],M[t][r]=a;e=r}return{U:s,S:m,V:M}}return{computeDeviationScores:b,computeDeviationMatrix:P,computeSVD:_,computePercentageExplained:F,computeOriginalData:A,computeVarianceCovariance:V,computeAdjustedData:H,getEigenVectors:Y,analyseTopResult:oe,transpose:T,multiply:R,clone:L,scale:O}}();z.exports=w})(ne);var le=ne.exports;const he=ie(le),ve={name:"pca-playground",directives:{resize:se},data(){return{size:{width:1e3,height:1e3},points:[]}},computed:{center(){if(!this.points.length)return null;const z=this.points.reduce(([w,P],[b,V])=>[w+b,P+V],[0,0]);return[z[0]/this.points.length,z[1]/this.points.length]},eigens(){if(!this.points.length)return null;const z=he.getEigenVectors(this.points);return z.forEach(w=>{if(w.angle=w.vector[1]>0?Math.PI/2:-Math.PI/2,w.vector[0]){const P=Math.atan(w.vector[1]/w.vector[0]);w.angle=w.vector[0]>0?P:P+Math.PI}}),z}},created(){document.addEventListener("keydown",z=>{switch(z.key){case"Home":this.reset();break}})},methods:{onResize(){this.size.width=this.$el.clientWidth,this.size.height=this.$el.clientHeight},onClickCanvas(z){this.points.push([z.offsetX,this.size.height-z.offsetY])},reset(){this.points=[]}}},ge={class:"pca-playground"},pe=["viewBox","width","height"],de={class:"points"},me=["cx","cy"],ye={key:0,class:"eigen"},we=["transform"],Me=["transform"],De={class:"controls"};function xe(z,w,P,b,V,_){const H=ce("resize");return fe((I(),S("div",ge,[(I(),S("svg",{class:"canvas",viewBox:`0 ${-V.size.height} ${V.size.width} ${V.size.height}`,width:V.size.width,height:V.size.height,onClick:w[0]||(w[0]=(...A)=>_.onClickCanvas&&_.onClickCanvas(...A))},[w[3]||(w[3]=N("defs",null,[N("g",{id:"arrow"},[N("line",{class:"trunk",x1:"0",y1:"0",x2:"0.7",y2:"0"}),N("polygon",{class:"tip",points:"1 0 0.7 -0.3 0.7 0.3"})])],-1)),N("g",de,[(I(!0),S(re,null,te(V.points,(A,F)=>(I(),S("circle",{key:F,cx:A[0],cy:-A[1]},null,8,me))),128))]),_.eigens?(I(),S("g",ye,[(I(!0),S(re,null,te(_.eigens,(A,F)=>(I(),S("use",{key:F,href:"#arrow",transform:`translate(${_.center[0]}, ${-_.center[1]}) rotate(${180-A.angle*180/Math.PI}) scale(${(A.eigenvalue/V.points.length)**.5} 20)`},null,8,we))),128))])):ee("",!0),_.center?(I(),S("g",{key:1,class:"center",transform:`translate(${_.center[0]}, ${-_.center[1]})`},[...w[2]||(w[2]=[N("line",{x1:"-12",x2:"12",y1:"0",y2:"0"},null,-1),N("line",{y1:"-12",y2:"12",x1:"0",x2:"0"},null,-1)])],8,Me)):ee("",!0)],8,pe)),N("header",De,[N("button",{onClick:w[1]||(w[1]=(...A)=>_.reset&&_.reset(...A))},"Reset")])])),[[H,_.onResize]])}const Ee=ue(ve,[["render",xe],["__scopeId","data-v-564f15b4"]]);export{Ee as default};
