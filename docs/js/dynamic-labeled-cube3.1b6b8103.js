(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dynamic-labeled-cube3"],{"07cc":function(e,t,s){"use strict";var i=s("77bd"),a=s.n(i);a.a},"12a8":function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return o}));const i=["&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"],a=i,o=[0,4,5,6,7,8,9,1,2,3,10,14,20,11,15,21,12,16,22,13,17,23,18,19]},"1d85":function(e,t,s){},"2fec":function(e,t,s){"use strict";var i=s("8497"),a=s.n(i);a.a},"36a0":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var i=s("5a89");class a{constructor(e,t,{content:s,offset:a=[0,1.3,0]}={}){this.visible=!0,this.camera=t,this.content=s||null,this.graphNode=new i["fb"],this.graphNode.position.set(...a),e.add(this.graphNode),this._pos=null}get position(){return this._pos||this.updatePosition(),this._pos}updatePosition(){const e=this.graphNode.getWorldPosition(new i["Rb"]).project(this.camera);this._pos=this._pos||{x:null,y:null},this._pos.x=(e.x+1)/2,this._pos.y=(1-e.y)/2}}},"38f8":function(e,t,s){"use strict";var i=s("69fe"),a=s.n(i);a.a},5027:function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"a",(function(){return a})),s.d(t,"c",(function(){return n}));const i=e=>new Promise(t=>setTimeout(t,e));function a(){return new Promise(e=>requestAnimationFrame(e))}const o={};function n(e,t){const s={};return o[e]=s,new Promise(i=>setTimeout(()=>i(o[e]===s),t))}},54284:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("table",{staticClass:"cube3-matrix",class:{"hide-corners":!e.showCorners,"hide-edges":!e.showEdges,"hide-axes":!e.showAxes},on:{mouseleave:function(t){e.focusColumn=e.focusRow=null}}},[s("thead",[s("tr",[s("th",{staticClass:"corner-cell"}),e._l(26,(function(t){return s("th",{key:t,class:{corner:t<=8,edge:t>8&&t<=20,axis:t>20,focus:t===e.focusColumn}},[e._v(e._s(e.labels[t-1]))])}))],2)]),e.matrix?s("tbody",e._l(26,(function(t){return s("tr",{key:t,class:{corner:t<=8,edge:t>8&&t<=20,axis:t>20,focus:t===e.focusRow,activated:e.activatedRows[t-1],highlight:Number.isInteger(e.highlightRow)&&t===e.highlightRow+1}},[s("th",{staticClass:"column"},[e._v(e._s(e.labels[t-1]))]),e._l(26,(function(i){return s("td",{key:i,class:{corner:i<=8,edge:i>8&&i<=20,axis:i>20,focus:i===e.focusColumn},domProps:{innerHTML:e._s(e.matrix[t-1][i-1])},on:{mouseenter:function(s){e.focusColumn=i,e.focusRow=t}}})}))],2)})),0):e._e()])},a=[],o=s("e831"),n=s("12a8"),h=s("5027");const r="A".charCodeAt(0),c=o["a"].split("").map(e=>e.charCodeAt(0)-r),u=Array(26).fill().map((e,t)=>c.indexOf(t)).map(e=>e>12?e+1:e);var l={name:"cube3-matrix",props:{cube:Object,showCorners:{type:Boolean,default:!0},showEdges:{type:Boolean,default:!0},showAxes:{type:Boolean,default:!0},highlightCubie:Number},data(){return{labels:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",vector:null,matrix:null,focusColumn:null,focusRow:null,activatedRows:Array(26).fill(!1)}},computed:{highlightRow(){if(!Number.isInteger(this.highlightCubie))return null;const e=this.highlightCubie>13?this.highlightCubie-1:this.highlightCubie;return c[e]}},created(){this.updateMatrix()},methods:{updateMatrix(){if(!this.cube)return null;const e=Array.from(this.cube.positions),t=u.map(t=>u.indexOf(e[t]));this.vector=t.map((e,t)=>this.cube.units[u[t]]),this.matrix=t.map((e,t)=>Array(26).fill().map((s,i)=>i===e?n["a"][n["b"][this.vector[t]]]:""))}},watch:{async vector(e,t){e&&t&&(this.activatedRows=e.map((e,s)=>e!==t[s])),this.$emit("update:vector",e),await Object(h["b"])(100),this.activatedRows=Array(26).fill(!1)}}},b=l,d=(s("ebc8"),s("0c7c")),f=Object(d["a"])(b,i,a,!1,null,"34b0734f",null);t["a"]=f.exports},"69fe":function(e,t,s){},"6af1":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"labeled-cube3"},[s("canvas",{ref:"canvas",attrs:{width:e.size.width,height:e.size.height},on:{mousemove:function(t){return t.stopPropagation(),e.onMouseMove(t)},mousedown:function(t){return t.preventDefault(),e.onMouseDown(t)},mouseup:e.onMouseUp,touchstart:e.onTouchStart,touchmove:e.onTouchMove,touchend:e.onTouchEnd}}),s("canvas",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"textureCanvas",staticClass:"texture-canvas",attrs:{width:256,height:256}}),e.showOrientations?s("div",e._l(e.labels,(function(t,i){return s("span",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"label.visible"}],key:i,staticClass:"label",class:{highlight:i===e.highlightCubie},style:{left:100*t.position.x+"%",top:100*t.position.y+"%"},domProps:{innerHTML:e._s(t.content)}})})),0):e._e(),e.loading?s("Loading"):e._e()],1)},a=[],o=s("5a89"),n=s("5027"),h=s("1761"),r=s("e831"),c=s("36a0"),u=s("12a8"),l=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},b=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"loading-dots"},[s("div",{staticClass:"ellipsis"},[s("div"),s("div"),s("div"),s("div")])])}],d={name:"loading-dots"},f=d,p=(s("07cc"),s("0c7c")),m=Object(p["a"])(f,l,b,!1,null,"5f9e4cb3",null),w=m.exports;const g=e=>{const t=[Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)],s=Math.max(...t);return t[0]===s?e.x>0?1:0:t[1]===s?e.y>0?3:2:e.z>0?5:4},v=1.5,x=[new o["Rb"](-v,0,0),new o["Rb"](+v,0,0),new o["Rb"](0,-v,0),new o["Rb"](0,+v,0),new o["Rb"](0,0,-v),new o["Rb"](0,0,+v)],C=[...Array(6).fill("white"),"black"].map(e=>new o["V"]({color:new o["j"](e)})),M=["#fd6","#faa","#efb","#fff","#aaf","#8f8","black"].map(e=>new o["V"]({color:new o["j"](e)})),y=["#fea","#fcc","#ff8","#ddd","#ddf","#cfc","#222"].map(e=>new o["V"]({color:new o["j"](e)})),R=700;var z={name:"labeled-cube3",components:{Loading:w},props:{size:{type:Object,default:()=>({width:800,height:800})},code:String,enabledTwist:{type:Boolean,default:!0},showRedLabels:Boolean,coloredUnderbox:Boolean,showOrientations:Boolean},data(){return{labels:[],loading:!1,highlightCubie:null}},async mounted(){this.rendererActive=!0,this.loading=!0,this.initializeRenderer(),this.cubeGroup=new o["fb"],this.scene.add(this.cubeGroup),this.cube=new h["a"]({materials:this.coloredUnderbox?M:C,onChange:e=>this.onChange(e),meshSchema:"cube",twistDuration:R}),this.cubeGroup.add(this.cube.graph),this.code&&this.cube.setState(this.code),this.labels=this.cube.graph.children.map(e=>{const t=e.children[0],s=new c["a"](t,this.camera,{offset:[0,0,0]}),i=s.graphNode.parent.position;return s.graphNode.position.set(.5*i.x,.5*i.y,.5*i.z),s}),this.$emit("cubeCreated",this.cube);const e=await this.createLabelMaterials();if(this.cubeLB=new h["a"]({materials:e,meshSchema:"cube26"}),this.cubeLB.graph.scale.set(1.01,1.01,1.01),this.cubeGroup.add(this.cubeLB.graph),this.showRedLabels){const e=await this.createLabelMaterials("red");this.cubeLR=new h["a"]({materials:e,meshSchema:"cube26",twistDuration:R}),this.cubeLR.graph.scale.set(1.005,1.005,1.005),this.cubeGroup.add(this.cubeLR.graph),this.code&&this.cubeLR.setState(this.code)}this.raycaster=new o["wb"],this.holdingAxis=null,this.$emit("sceneInitialized",this),this.render(),this.loading=!1},beforeDestroy(){this.rendererActive=!1},methods:{initializeRenderer(){this.renderer=new o["Vb"]({antialias:!0,canvas:this.$refs.canvas,alpha:!0}),this.renderer.setClearColor(new o["j"]("black"),0),this.renderer.setSize(this.size.width,this.size.height,!1),this.camera=new o["nb"](60,this.size.width/this.size.height,3,12),this.camera.position.set(0,0,6.4),this.camera.lookAt(0,0,0),this.scene=new o["zb"]},async createLabelMaterials(e="black"){const t=this.$refs.textureCanvas.getContext("2d"),s=[];for(let i=0;i<26;++i){const a=r["a"][i];switch(t.clearRect(0,0,256,256),e){case"black":t.font="240px monospace",t.fillStyle="black",t.fillText(a,60,200);break;case"red":t.font="160px monospace",t.fillStyle="red",t.fillText(a,160,240);break}const n=await new Promise(e=>this.$refs.textureCanvas.toBlob(e,"image/png")),h=new Image;h.src=URL.createObjectURL(n),await new Promise(e=>h.onload=e);const c=new o["Lb"](h);c.needsUpdate=!0,s.push(c)}return s.map(e=>new o["V"]({map:e,transparent:!0,depthWrite:!1}))},async render(){let e=performance.now(),t=Math.floor(e/1e3),s=0,i=0;while(this.rendererActive){this.$emit("beforeRender",this),this.renderer.render(this.scene,this.camera),this.$emit("afterRender",this),this.showOrientations&&this.updateLabels(),++s;const a=performance.now();i=Math.max(i,a-e);const o=Math.floor(a/1e3);if(o>t){const e=s/(o-t);this.$emit("fps",{fps:e,stuck:i}),s=0,i=0,t=o}e=a,await Object(n["a"])()}},updateLabels(){const e=this.cube.graph.worldToLocal(this.camera.position.clone());for(let t=0;t<this.labels.length;t++){const s=this.labels[t];s.updatePosition();const i=this.cube.algebra.units[t];s.content=u["a"][u["b"][i]];const a=s.graphNode.parent.position.clone();a.applyQuaternion(s.graphNode.parent.parent.quaternion);const o=Math.round(a.x)*e.x>0&&Math.abs(e.x)>1.5,n=Math.round(a.y)*e.y>0&&Math.abs(e.y)>1.5,h=Math.round(a.z)*e.z>0&&Math.abs(e.z)>1.5;s.visible=o||n||h}},normalizeScreenPoint(e){return new o["Rb"](e.offsetX/this.$refs.canvas.clientWidth*2-1,1-e.offsetY/this.$refs.canvas.clientHeight*2,0)},raycastAxis(e){if(this.raycaster){const t=this.normalizeScreenPoint(e);this.raycaster.setFromCamera(t,this.camera);const s=this.raycaster.intersectObject(this.cube.graph,!0);if(s[0]){const e=this.cube.graph.worldToLocal(s[0].point);return g(e)}}return null},raycastCubie(){if(this.raycaster){const e=this.normalizeScreenPoint(event);this.raycaster.setFromCamera(e,this.camera);const t=this.raycaster.intersectObject(this.cube.graph,!0);if(t[0]){const e=this.cube.graph.worldToLocal(t[0].point),s=[e.x,e.y,e.z].map(e=>Math.round(e)+1);return s[0]+3*s[1]+9*s[2]}}return null},reset(){this.cube.reset(),this.cubeLR.reset()},twist(e){return Promise.all([this.cube.twist(e),this.cubeLR&&this.cubeLR.twist(e)])},onMouseMove(e){if(this.cube)if(Number.isInteger(this.holdingAxis)&&4!==e.buttons){const t=this.normalizeScreenPoint(e),s=t.clone().sub(this.holdPosition.start),i=this.holdPosition.start.clone().sub(this.holdPosition.pivot).normalize(),a=3*-i.clone().cross(s).z;this.cube.twistGraph(this.holdingAxis,a),this.cubeLR&&this.cubeLR.twistGraph(this.holdingAxis,a)}else switch(e.buttons){case 1:case 4:this.cubeGroup.rotateOnWorldAxis(new o["Rb"](0,1,0),.01*e.movementX),this.cubeGroup.rotateOnWorldAxis(new o["Rb"](1,0,0),.01*e.movementY);break;case 0:const t=this.raycastCubie(e);this.highlightCubie=this.cube.algebra.positions.indexOf(t),this.coloredUnderbox&&(this.cube.cubeMeshes.forEach(e=>e.material=M),Number.isInteger(this.highlightCubie)&&this.cube.cubeMeshes[this.highlightCubie]&&(this.cube.cubeMeshes[this.highlightCubie].material=y));break}},onMouseDown(e){switch(e.buttons){case 1:if(this.enabledTwist){const t=this.raycastAxis(e);if(Number.isInteger(t)){const s=this.cube.graph.localToWorld(x[t].clone());s.project(this.camera),s.z=0,this.holdingAxis=t,this.holdPosition={pivot:s,start:this.normalizeScreenPoint(e)}}}break}},onMouseUp(){Number.isInteger(this.holdingAxis)&&(this.cube.releaseGraph(),this.cubeLR&&this.cubeLR.releaseGraph(),this.holdingAxis=null)},touchToOffsetPoint(e,t={buttons:0}){const s=this.$el.getBoundingClientRect();return{offsetX:e.pageX-s.x,offsetY:e.pageY-s.y,...t}},onTouchStart(e){this.rendererActive&&1===e.touches.length&&(this.onMouseDown(this.touchToOffsetPoint(e.touches[0],{buttons:1})),e.preventDefault())},onTouchMove(e){switch(e.touches.length){case 1:const t=this.touchToOffsetPoint(e.touches[0]);this.onMouseMove(t),this.lastTouchPoint={offsetX:t.offsetX,offsetY:t.offsetY},e.preventDefault();break;case 2:{const t=this.touchToOffsetPoint(e.touches[0],{buttons:1});this.lastTouchPoint&&(t.movementX=t.offsetX-this.lastTouchPoint.offsetX,t.movementY=t.offsetY-this.lastTouchPoint.offsetY,this.holdingAxis=null,this.onMouseMove(t)),this.lastTouchPoint={offsetX:t.offsetX,offsetY:t.offsetY}}e.preventDefault();break}},onTouchEnd(){this.onMouseUp(),this.lastTouchPoint=null},onChange(e){this.innerCode=e.encode(),this.$emit("update:code",this.innerCode)}},watch:{size(e){this.camera.aspect=e.width/e.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.width,e.height,!1)},code(e){e&&this.innerCode!==e&&(this.cube&&this.cube.setState(e),this.cubeLR&&this.cubeLR.setState(e))},highlightCubie(e){this.$emit("update:highlightCubie",e)}}},P=z,$=(s("7018"),s("38f8"),Object(p["a"])(P,i,a,!1,null,"ece489f6",null));t["a"]=$.exports},7018:function(e,t,s){"use strict";var i=s("c652"),a=s.n(i);a.a},"77bd":function(e,t,s){},"82be":function(e,t,s){"use strict";var i=s("972d"),a=s.n(i);a.a},8497:function(e,t,s){},"972d":function(e,t,s){},c652:function(e,t,s){},e831:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));const i="EJFTVSGNHKXLYZOWPAIBQURCMD"},ebc8:function(e,t,s){"use strict";var i=s("1d85"),a=s.n(i);a.a},fafa:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],staticClass:"dynamic-labeled-cube3",class:{captional:e.showCaption},style:{"--matrix-font-size":e.size&&Math.min(.015*e.size.width,.025*e.size.height)+"px"},on:{mousemove:e.onMouseMove,mouseup:e.onMouseUp}},[s("main",[s("LabeledCube3",{ref:"cube",attrs:{size:e.canvasSize,showRedLabels:!0,coloredUnderbox:!0,showOrientations:!0,code:e.code,highlightCubie:e.highlightCubie},on:{cubeCreated:e.onCubeCreated,"update:code":function(t){e.code=t},"update:highlightCubie":function(t){e.highlightCubie=t},"update:highlight-cubie":function(t){e.highlightCubie=t},sceneInitialized:e.onSceneInitialized}}),s("div",{staticClass:"matrix-side"},[e.showMatrix&&e.cube?s("Cube3Matrix",{ref:"matrix",attrs:{cube:e.cube,highlightCubie:e.highlightCubie,vector:e.vector},on:{"update:vector":function(t){e.vector=t}}}):e._e()],1)],1),e.showCaption?s("header",[e.twistsSeq?s("p",{staticClass:"twists"},e._l(e.twistsSeq,(function(t,i){return s("span",{key:i,domProps:{innerHTML:e._s(t)}})})),0):e._e(),e.vectorText?s("h1",{domProps:{innerHTML:e._s(e.vectorText)}}):e._e()]):e._e()])},a=[],o=s("428d"),n=s.n(o),h=s("5a89"),r=s("0b16"),c=s.n(r),u=s("5027"),l=s("cbb5"),b=s("12a8"),d=s("6af1"),f=s("54284");const p="LrDuBflRdUbF",m=["L'","R","D'","U","B'","F","L","R'","D","U'","B","F'","L<sup>2</sup>","R<sup>2</sup>","D<sup>2</sup>","U<sup>2</sup>","B<sup>2</sup>","F<sup>2</sup>"];var w={name:"dynamic-labeled-cube3",directives:{resize:n.a},components:{LabeledCube3:d["a"],Cube3Matrix:f["a"]},props:{showMatrix:{type:Boolean,default:!0},showCaption:Boolean,demo:Boolean,demoPath:String},data(){return{size:void 0,cube:null,code:null,highlightCubie:null,vector:null,twistsSeq:[]}},computed:{canvasSize(){return this.size&&{width:Math.max(.5*this.size.width,.7*this.size.height),height:this.size.height}},vectorText(){return this.vector&&this.vector.map(e=>b["a"][b["b"][e]]).join("")}},created(){document.addEventListener("keydown",e=>{switch(e.key){case"Home":this.$refs.cube&&this.$refs.cube.reset();break;default:if(this.$refs.cube){const t=p.indexOf(e.key);t>=0&&this.$refs.cube.twist(t)}}}),window.onhashchange=()=>this.onHashChange()},methods:{onResize(){this.size={width:this.$el.clientWidth,height:this.$el.clientHeight}},onCubeCreated(e){this.cube=e.algebra,this.onHashChange()},onCubeChanged(){this.$refs.matrix&&this.$refs.matrix.updateMatrix()},async onSceneInitialized(){if(this.demo){while(!this.$refs.cube||!this.$refs.cube.cubeGroup)await Object(u["a"])();this.$refs.cube.cubeGroup.quaternion.setFromEuler(new h["s"](.16*Math.PI,0,0)),this.animate()}else this.demoPath&&this.twists(this.demoPath)},async animate(e=null){this.animating=!0,this.rotate();while(this.animating){while(!this.$refs.cube)await Object(u["a"])();let t=null;const s=e||Math.floor(Math.random()*Math.random()*9+1),i=Array(s).fill().map(()=>{let e=Math.floor(12*Math.random());while(Number.isInteger(t)&&e===Object(l["invertTwist"])(t))e=Math.floor(12*Math.random());return t=e,e}),a=Object(l["invertPath"])(i);for(const e of i)await this.$refs.cube.twist(e),await Object(u["b"])(300);await Object(u["b"])(1200);for(const e of a)await this.$refs.cube.twist(e),await Object(u["b"])(100);await Object(u["b"])(1600)}},async twists(e){this.$refs.cube.cubeGroup.quaternion.setFromEuler(new h["s"](.16*Math.PI,.309*Math.PI,0)),this.animating=!0;const t=Object(l["parsePath"])(e);this.twistsSeq=[];for(const s of t)this.twistsSeq.push(m[s]),await this.$refs.cube.twist(s);this.rotate(-3e-4)},async rotate(e=-1e-4){const t=Date.now();let s=t;while(this.animating){const i=Date.now(),a=i-s;s=i,this.$refs.cube.cubeGroup.rotateOnAxis(new h["Rb"](0,1,0),a*e),this.$refs.cube.cubeGroup.rotateOnWorldAxis(new h["Rb"](1,0,0),Math.cos(1e-5*(s-t))*a*4e-7),await Object(u["a"])()}},onMouseMove(e){this.$refs.cube&&this.$refs.cube.onMouseMove(e)},onMouseUp(e){this.$refs.cube&&this.$refs.cube.onMouseUp(e)},onHashChange(){let e=location.hash.substr(1);"/"!==e[0]||/#/.test(e)||(e+="#"),e=e.replace(/.*#/,"");const t=c.a.parse(e,!0),s=t.pathname;if(s&&(this.code=s),t.query.path){const e=Object(l["parsePath"])(t.query.path);if(e.length){const t=e[0];t>=0&&this.$refs.cube&&this.$refs.cube.twist(t).then(()=>{const t=stringifyPath(e.slice(1));location.hash=`${this.getRouterPath()}${this.code}?path=${t}`})}}},getRouterPath(){const[e]=location.hash.match(/^#\/[^#]*/)||[];return e?e+"#":""}},watch:{code(e){this.animating||(location.hash=this.getRouterPath()+e),this.$nextTick(()=>{this.onCubeChanged()})}}},g=w,v=(s("2fec"),s("82be"),s("0c7c")),x=Object(v["a"])(g,i,a,!1,null,"47ea413c",null);t["default"]=x.exports}}]);
//# sourceMappingURL=dynamic-labeled-cube3.1b6b8103.js.map