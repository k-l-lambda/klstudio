(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["mesh-viewer"],{"29c5":function(e,t,s){},"3e72":function(e,t,s){var i={"./chess-knight.json":["ad0d","chunk-2d21368d"]};function n(e){if(!s.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],n=t[0];return s.e(t[1]).then((function(){return s.t(n,3)}))}n.keys=function(){return Object.keys(i)},n.id="3e72",e.exports=n},5027:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));function i(){return new Promise(e=>requestAnimationFrame(e))}},ac2e:function(e,t,s){"use strict";var i=s("29c5"),n=s.n(i);n.a},dc0d:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],staticClass:"mesh-viewer"},[s("article",{on:{mousemove:e.onMouseMove,mousewheel:e.onMouseWheel}},[s("canvas",{ref:"canvas",attrs:{width:e.size.width,height:e.size.height}}),s("div",e._l(e.labels,(function(t,i){return s("span",{key:i,staticClass:"label",style:{left:100*t.position.x+"%",top:100*t.position.y+"%"},domProps:{innerHTML:e._s(t.content)}})})),0),s("span",{directives:[{name:"show",rawName:"v-show",value:e.showStatus,expression:"showStatus"}],staticClass:"status"},[e.fps?s("span",{staticClass:"fps"},[e._v("fps "),s("em",[e._v(e._s(e.fps))])]):e._e()])])])},n=[],o=s("428d"),a=s.n(o),h=s("5a89"),r=s("5027"),c=s("819c");const l=(e,t,s)=>new h["x"](e*Math.sin(t)*Math.cos(s),e*Math.cos(t),e*Math.sin(t)*Math.sin(s));class d{constructor(e,t,{content:s,offset:i=[0,1.2,0]}={}){this.camera=t,this.content=s,this.graphNode=new h["n"],this.graphNode.position.set(...i),e.add(this.graphNode),this._pos=null}get position(){return this._pos||this.updatePosition(),this._pos}updatePosition(){const e=this.graphNode.getWorldPosition(new h["x"]).project(this.camera);this._pos=this._pos||{},this._pos.x=(e.x+1)/2,this._pos.y=(1-e.y)/2}}var u={name:"mesh-viewer",directives:{resize:a.a},props:{light:{default:"white"},entities:Array,showStatus:!1},data(){return{size:{width:800,height:800},fps:0,labels:[]}},created(){0},mounted(){this.initializeRenderer(),this.createScene(),this.render()},beforeDestroy(){this.rendererActive=!1},methods:{onResize(){this.size={width:this.$el.clientWidth,height:this.$el.clientHeight}},initializeRenderer(){this.renderer=new h["y"]({antialias:!0,canvas:this.$refs.canvas,alpha:!0}),this.renderer.setClearColor(new h["c"]("lightblue"),1),this.renderer.setSize(this.size.width,this.size.height,!1),this.camera=new h["p"](60,this.size.width/this.size.height,.1,100),this.viewTheta=.3*Math.PI,this.viewPhi=.5*Math.PI,this.viewRadius=6,this.scene=new h["s"];const e=new h["f"](this.light,1);e.position.set(-30,100,60),e.target=this.scene,this.scene.add(e);const t=new h["f"]("lightblue",.4);t.position.set(0,1e3,0),t.target=this.scene,this.scene.add(t),this.scene.add(new h["a"]("#323f43")),this.rendererActive=!0},async render(){let e=performance.now(),t=Math.floor(e/1e3),s=0,i=0;while(this.rendererActive){this.camera.position.copy(l(this.viewRadius,this.viewTheta,this.viewPhi)),this.camera.lookAt(0,0,0),this.renderer.render(this.scene,this.camera),this.updateLabels(),++s;const n=performance.now();i=Math.max(i,n-e);const o=Math.floor(n/1e3);o>t&&(this.fps=s/(o-t),s=0,i=0,t=o),e=n,await Object(r["a"])()}},async createScene(){if(this.entities)for(const e of this.entities){const t=new h["n"];this.scene.add(t);const{default:i}=await s("3e72")(`./${e.prototype}.json`),n=await new Promise(e=>(new h["o"]).parse(i,e));if(t.add(n),e.position&&t.position.set(...e.position),e.quaternion?n.quaternion.set(...e.quaternion):e.euler&&n.quaternion.setFromEuler(new h["g"](...e.euler,"XZY")),e.label){const s=new d(t,this.camera,"object"===typeof e.label?e.label:{content:e.label});this.labels.push(s)}}},updateLabels(){for(const e of this.labels)e.updatePosition();this.labels.length&&this.$forceUpdate()},onMouseMove(e){1===e.buttons&&(this.viewPhi+=.01*e.movementX,this.viewTheta-=.01*e.movementY,this.viewTheta=Math.max(Math.min(this.viewTheta,Math.PI-.01),.01))},onMouseWheel(e){this.viewRadius*=Math.exp(.001*e.deltaY)},permute(e){this.elements.forEach((t,s)=>{const i=c["k"][elementsSchema[s].index][e];t.position.copy(this.elementPositions[i])}),this.elementPositions=this.elements.reduce((e,t,s)=>(e[elementsSchema[s].index]=t.position.clone(),e),[]),this.rotationIndex=0,this.rotationT=0}},watch:{size(e){this.camera.aspect=e.width/e.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.width,e.height,!1)}}},p=u,w=(s("ac2e"),s("0c7c")),m=Object(w["a"])(p,i,n,!1,null,"bcd0221a",null);t["default"]=m.exports}}]);
//# sourceMappingURL=mesh-viewer.a90b52bf.js.map