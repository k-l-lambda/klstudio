(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["static-labeled-cube3"],{"12a8":function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return n}));const i=["&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"],n=[0,4,5,6,7,8,9,1,2,3,10,14,20,11,15,21,12,16,22,13,17,23,18,19]},"36a0":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var i=s("5a89");class n{constructor(e,t,{content:s,offset:n=[0,1.3,0]}={}){this.visible=!0,this.camera=t,this.content=s||null,this.graphNode=new i["fb"],this.graphNode.position.set(...n),e.add(this.graphNode),this._pos=null}get position(){return this._pos||this.updatePosition(),this._pos}updatePosition(){const e=this.graphNode.getWorldPosition(new i["Rb"]).project(this.camera);this._pos=this._pos||{x:null,y:null},this._pos.x=(e.x+1)/2,this._pos.y=(1-e.y)/2}}},5027:function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"a",(function(){return n}));const i=e=>new Promise(t=>setTimeout(t,e));function n(){return new Promise(e=>requestAnimationFrame(e))}},"6af1":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"labeled-cube3"},[s("canvas",{ref:"canvas",attrs:{width:e.size.width,height:e.size.height},on:{mousemove:function(t){return t.stopPropagation(),e.onMouseMove(t)},mousedown:function(t){return t.preventDefault(),e.onMouseDown(t)},mouseup:e.onMouseUp,touchstart:e.onTouchStart,touchmove:e.onTouchMove,touchend:e.onTouchEnd}}),s("canvas",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"textureCanvas",staticClass:"texture-canvas",attrs:{width:256,height:256}}),e.showOrientations?s("div",e._l(e.labels,(function(t,i){return s("span",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"label.visible"}],key:i,staticClass:"label",style:{left:100*t.position.x+"%",top:100*t.position.y+"%"},domProps:{innerHTML:e._s(t.content)}})})),0):e._e()])},n=[],a=s("5a89"),o=s("5027"),r=s("1761"),h=s("e831"),c=s("36a0"),u=s("12a8");const l=e=>{const t=[Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)],s=Math.max(...t);return t[0]===s?e.x>0?1:0:t[1]===s?e.y>0?3:2:e.z>0?5:4},b=1.5,d=[new a["Rb"](-b,0,0),new a["Rb"](+b,0,0),new a["Rb"](0,-b,0),new a["Rb"](0,+b,0),new a["Rb"](0,0,-b),new a["Rb"](0,0,+b)],f=[...Array(6).fill("white"),"black"].map(e=>new a["V"]({color:new a["j"](e)})),p=["#fd6","#faa","#efb","#fff","#aaf","#8f8","black"].map(e=>new a["V"]({color:new a["j"](e)})),m=700;var w={name:"labeled-cube3",props:{size:{type:Object,default:()=>({width:800,height:800})},code:String,enabledTwist:{type:Boolean,default:!0},showRedLabels:Boolean,coloredUnderbox:Boolean,showOrientations:Boolean},data(){return{labels:[]}},async mounted(){this.rendererActive=!0,this.initializeRenderer(),this.cubeGroup=new a["fb"],this.scene.add(this.cubeGroup),this.cube=new r["a"]({materials:this.coloredUnderbox?p:f,onChange:e=>this.onChange(e),meshSchema:"cube",twistDuration:m}),this.cubeGroup.add(this.cube.graph),this.labels=this.cube.graph.children.map(e=>{const t=e.children[0],s=new c["a"](t,this.camera,{offset:[0,0,0]}),i=s.graphNode.parent.position;return s.graphNode.position.set(.5*i.x,.5*i.y,.5*i.z),s}),this.$emit("cubeCreated",this.cube);const e=await this.createLabelMaterials();if(this.cubeLB=new r["a"]({materials:e,meshSchema:"cube26"}),this.cubeLB.graph.scale.set(1.01,1.01,1.01),this.cubeGroup.add(this.cubeLB.graph),this.showRedLabels){const e=await this.createLabelMaterials("red");this.cubeLR=new r["a"]({materials:e,meshSchema:"cube26",twistDuration:m}),this.cubeLR.graph.scale.set(1.005,1.005,1.005),this.cubeGroup.add(this.cubeLR.graph)}this.raycaster=new a["wb"],this.holdingAxis=null,this.$emit("sceneInitialized",this),this.render()},beforeDestroy(){this.rendererActive=!1},methods:{initializeRenderer(){this.renderer=new a["Vb"]({antialias:!0,canvas:this.$refs.canvas,alpha:!0}),this.renderer.setClearColor(new a["j"]("black"),0),this.renderer.setSize(this.size.width,this.size.height,!1),this.camera=new a["nb"](60,this.size.width/this.size.height,3,12),this.camera.position.set(0,0,6.4),this.camera.lookAt(0,0,0),this.scene=new a["zb"]},async createLabelMaterials(e="black"){const t=this.$refs.textureCanvas.getContext("2d"),s=[];for(let i=0;i<26;++i){const n=h["a"][i];switch(t.clearRect(0,0,256,256),e){case"black":t.font="240px monospace",t.fillStyle="black",t.fillText(n,60,200);break;case"red":t.font="160px monospace",t.fillStyle="red",t.fillText(n,160,240);break}const o=await new Promise(e=>this.$refs.textureCanvas.toBlob(e,"image/png")),r=new Image;r.src=URL.createObjectURL(o),await new Promise(e=>r.onload=e);const c=new a["Lb"](r);c.needsUpdate=!0,s.push(c)}return s.map(e=>new a["V"]({map:e,transparent:!0}))},async render(){let e=performance.now(),t=Math.floor(e/1e3),s=0,i=0;while(this.rendererActive){this.$emit("beforeRender",this),this.renderer.render(this.scene,this.camera),this.$emit("afterRender",this),this.showOrientations&&this.updateLabels(),++s;const n=performance.now();i=Math.max(i,n-e);const a=Math.floor(n/1e3);if(a>t){const e=s/(a-t);this.$emit("fps",{fps:e,stuck:i}),s=0,i=0,t=a}e=n,await Object(o["a"])()}},updateLabels(){const e=this.cube.graph.worldToLocal(this.camera.position.clone());for(let t=0;t<this.labels.length;t++){const s=this.labels[t];s.updatePosition();const i=this.cube.algebra.units[t];s.content=u["a"][u["b"][i]];const n=s.graphNode.parent.position.clone();n.applyQuaternion(s.graphNode.parent.parent.quaternion);const a=Math.round(n.x)*e.x>0&&Math.abs(e.x)>1.5,o=Math.round(n.y)*e.y>0&&Math.abs(e.y)>1.5,r=Math.round(n.z)*e.z>0&&Math.abs(e.z)>1.5;s.visible=a||o||r}},normalizeScreenPoint(e){return new a["Rb"](e.offsetX/this.$refs.canvas.clientWidth*2-1,1-e.offsetY/this.$refs.canvas.clientHeight*2,0)},raycastAxis(e){if(this.raycaster){const t=this.normalizeScreenPoint(e);this.raycaster.setFromCamera(t,this.camera);const s=this.raycaster.intersectObject(this.cube.graph,!0);if(s[0]){const e=this.cube.graph.worldToLocal(s[0].point);return l(e)}}return null},reset(){this.cube.reset(),this.cubeLR.reset()},twist(e){return Promise.all([this.cube.twist(e),this.cubeLR&&this.cubeLR.twist(e)])},onMouseMove(e){if(this.cube)if(Number.isInteger(this.holdingAxis)&&4!==e.buttons){const t=this.normalizeScreenPoint(e),s=t.clone().sub(this.holdPosition.start),i=this.holdPosition.start.clone().sub(this.holdPosition.pivot).normalize(),n=3*-i.clone().cross(s).z;this.cube.twistGraph(this.holdingAxis,n),this.cubeLR&&this.cubeLR.twistGraph(this.holdingAxis,n)}else switch(e.buttons){case 1:case 4:this.cubeGroup.rotateOnWorldAxis(new a["Rb"](0,1,0),.01*e.movementX),this.cubeGroup.rotateOnWorldAxis(new a["Rb"](1,0,0),.01*e.movementY);break}},onMouseDown(e){switch(e.buttons){case 1:if(this.enabledTwist){const t=this.raycastAxis(e);if(Number.isInteger(t)){const s=this.cube.graph.localToWorld(d[t].clone());s.project(this.camera),s.z=0,this.holdingAxis=t,this.holdPosition={pivot:s,start:this.normalizeScreenPoint(e)}}}break}},onMouseUp(){Number.isInteger(this.holdingAxis)&&(this.cube.releaseGraph(),this.cubeLR&&this.cubeLR.releaseGraph(),this.holdingAxis=null)},touchToOffsetPoint(e,t={buttons:0}){const s=this.$el.getBoundingClientRect();return{offsetX:e.pageX-s.x,offsetY:e.pageY-s.y,...t}},onTouchStart(e){this.rendererActive&&1===e.touches.length&&(this.onMouseDown(this.touchToOffsetPoint(e.touches[0],{buttons:1})),e.preventDefault())},onTouchMove(e){switch(e.touches.length){case 1:const t=this.touchToOffsetPoint(e.touches[0]);this.onMouseMove(t),this.lastTouchPoint={offsetX:t.offsetX,offsetY:t.offsetY},e.preventDefault();break;case 2:{const t=this.touchToOffsetPoint(e.touches[0],{buttons:1});this.lastTouchPoint&&(t.movementX=t.offsetX-this.lastTouchPoint.offsetX,t.movementY=t.offsetY-this.lastTouchPoint.offsetY,this.holdingAxis=null,this.onMouseMove(t)),this.lastTouchPoint={offsetX:t.offsetX,offsetY:t.offsetY}}e.preventDefault();break}},onTouchEnd(){this.onMouseUp(),this.lastTouchPoint=null},onChange(e){this.innerCode=e.encode(),this.$emit("update:code",this.innerCode)}},watch:{size(e){this.camera.aspect=e.width/e.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.width,e.height,!1)},code(e){this.innerCode!==e&&this.cube.setState(e)}}},g=w,v=(s("9b71"),s("0c7c")),x=Object(v["a"])(g,i,n,!1,null,"4ee3b9b9",null);t["a"]=x.exports},"7ee2":function(e,t,s){},"94b9":function(e,t,s){},"9b71":function(e,t,s){"use strict";var i=s("94b9"),n=s.n(i);n.a},c7ee:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],staticClass:"static-labeled-cube3"},[s("LabeledCube3",{ref:"cube",attrs:{size:e.size,enabledTwist:!1}})],1)},n=[],a=s("428d"),o=s.n(a),r=s("5a89"),h=s("5027"),c=s("6af1"),u={name:"static-labeled-cube3",directives:{resize:o.a},components:{LabeledCube3:c["a"]},data(){return{size:void 0}},methods:{onResize(){this.size={width:this.$el.clientWidth,height:this.$el.clientHeight}},async animate(){this.animating=!0;const e=1200;while(this.animating){if(this.$refs.cube){const t=this.$refs.cube.cubeGroup.quaternion.clone(),s=(new r["sb"]).setFromEuler(new r["s"](2.4*(Math.random()-.5),2*Math.random()*Math.PI,.2*(Math.random()-.5),"YXZ")),i=Date.now();let n=i;while(n-i<e){const a=(n-i)/e,o=3*a**2-2*a**3;r["sb"].slerp(t,s,this.$refs.cube.cubeGroup.quaternion,o),await Object(h["a"])(),n=Date.now()}await Object(h["b"])(400)}await Object(h["a"])()}}}},l=u,b=(s("d4ef"),s("0c7c")),d=Object(b["a"])(l,i,n,!1,null,"153c4fec",null);t["default"]=d.exports},d4ef:function(e,t,s){"use strict";var i=s("7ee2"),n=s.n(i);n.a},e831:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));const i="EJFTVSGNHKXLYZOWPAIBQURCMD"}}]);
//# sourceMappingURL=static-labeled-cube3.4cc80bf9.js.map